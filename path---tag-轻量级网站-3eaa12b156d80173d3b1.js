webpackJsonp([0xf583c2f20517],{1414:function(n,s){n.exports={data:{site:{siteMetadata:{title:"女王控的博客",description:'前端工程师，黑猫女王控，欢迎勾搭，技术相关<a href="https://github.com/towavephone" target="_blank">@towavephone</a>，QQ闲聊<a href="tencent://AddContact/?fromId=45&fromSubId=1&subcmd=all&uin=634407147&website=www.oicqzone.com">@towave</a>，bili关注<a href="https://space.bilibili.com/11507708#/" target="_blank">@towave</a>',siteUrl:"https://blog.towavephone.com"}}},pathContext:{posts:[{excerpt:"需求背景 最近在做表单分享的需求，类似于问卷调查，需要在三端（桌面端、移动端、微信端）同时兼容 技术方案 我出的方案：采用原生语法新框架写，考虑到首屏渲染的问题未采用 主管出的方案：采用后端渲染模板的方式，最大化首屏加载速度，但有以下问题： 后端渲染对服务器 CPU 的要求较高 本来打算用 oss 来减少后端渲染，但考虑到表单经常变化，且分享的链接要尽可能的保持不变，这就限制了 oss…",html:'<h1 id="需求背景"><a href="#%E9%9C%80%E6%B1%82%E8%83%8C%E6%99%AF" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>需求背景</h1>\n<p>最近在做表单分享的需求，类似于问卷调查，需要在三端（桌面端、移动端、微信端）同时兼容</p>\n<h1 id="技术方案"><a href="#%E6%8A%80%E6%9C%AF%E6%96%B9%E6%A1%88" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>技术方案</h1>\n<ol>\n<li>我出的方案：采用原生语法新框架写，考虑到首屏渲染的问题未采用</li>\n<li>\n<p>主管出的方案：采用后端渲染模板的方式，最大化首屏加载速度，但有以下问题：</p>\n<ol>\n<li>后端渲染对服务器 CPU 的要求较高</li>\n<li>本来打算用 oss 来减少后端渲染，但考虑到表单经常变化，且分享的链接要尽可能的保持不变，这就限制了 oss 的使用</li>\n<li>同样由于分享的链接要尽可能的保持不变，在新的表单分享模板加入后需要后端刷数据，容错性较低</li>\n</ol>\n</li>\n<li>最终讨论结果：采用前后端分离的方式，用原生语法新框架写，需要考虑到版本兼容（新的模板数据和旧的模板数据要同时兼容，在接口里面加一个版本号）、模板枚举 wiki 的命名（减少沟通成本同时缩短分享链接的长度）、loading 页（首屏加载时间可能较长）</li>\n</ol>\n<h1 id="方案调研"><a href="#%E6%96%B9%E6%A1%88%E8%B0%83%E7%A0%94" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>方案调研</h1>\n<p>刚开始考虑到用官网的框架，但是由于官网的框架构建过程有太多冗余的东西、以及只能在 node v9.11.2 里面使用的原因，决定自己在 <a href="https://github.com/yeoman/generator-webapp" target="_blank" rel="nofollow noreferrer noopener">generator-webapp</a> 生成的框架上做一下改造，以下是改造的要点：</p>\n<ol>\n<li>资源文件 hash</li>\n<li>接口代理</li>\n<li>模板功能</li>\n</ol>\n<h1 id="具体实施"><a href="#%E5%85%B7%E4%BD%93%E5%AE%9E%E6%96%BD" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>具体实施</h1>\n<h2 id="构建框架搭建"><a href="#%E6%9E%84%E5%BB%BA%E6%A1%86%E6%9E%B6%E6%90%AD%E5%BB%BA" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>构建框架搭建</h2>\n<h3 id="gulp-打包优化"><a href="#gulp-%E6%89%93%E5%8C%85%E4%BC%98%E5%8C%96" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>gulp 打包优化</h3>\n<p>gulpfile.js</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="58596241468913115000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// generated on 2019-11-07 using generator-webapp 4.0.0-6\nconst { src, dest, watch, series, parallel, lastRun } = require(\'gulp\');\nconst gulpLoadPlugins = require(\'gulp-load-plugins\');\nconst browserSync = require(\'browser-sync\');\nconst del = require(\'del\');\n// const autoprefixer = require(\'autoprefixer\');\nconst cssnano = require(\'cssnano\');\nconst { argv } = require(\'yargs\');\nconst proxy = require(\'http-proxy-middleware\');\nconst postcssPresetEnv = require(\'postcss-preset-env\');\n\nconst config = require(\'./proxy.json\');\nconst globalJSON = require(\'./global.json\');\n\nconst \\$ = gulpLoadPlugins();\nconst server = browserSync.create();\n\nconst port = argv.port || config.port || 9000;\nconst buildPath = argv.buildPath || \'build\';\nconst varsEnv = argv.server || \'master\';\nconst globalVars = globalJSON.runtime[varsEnv];\nconst publicPath = argv.publicPath || \'/form\';\n\nconst isProd = process.env.NODE_ENV === \'production\';\nconst isTest = process.env.NODE_ENV === \'test\';\nconst isDev = !isProd && !isTest;\n\n// 配置反向代理\nconst middleware = config.proxies.map((item) =>\n  proxy(item.match, {\n    target: item.host,\n    changeOrigin: true\n  })\n);\n\nfunction styles() {\n  return src(\'app/styles/*.css\')\n    .pipe(\\$.if(!isProd, \\$.sourcemaps.init()))\n    .pipe(\n      \\$.postcss([\n        // autoprefixer(),\n        // 采用 postcss 最新语法\n        postcssPresetEnv({\n          stage: 0\n        })\n      ])\n    )\n    .pipe(\\$.if(!isProd, \\$.sourcemaps.write()))\n    .pipe(dest(\'.tmp/styles\'))\n    .pipe(server.reload({ stream: true }));\n}\n\nfunction scripts() {\n  return (\n    src(\'app/scripts/**/*.js\')\n      // plumber 插件防止 gulp 报错崩溃\n      .pipe(\\$.plumber())\n      .pipe(\\$.if(!isProd, \\$.sourcemaps.init()))\n      .pipe(\\$.babel())\n      .pipe(\\$.if(!isProd, \\$.sourcemaps.write(\'.\')))\n      .pipe(dest(\'.tmp/scripts\'))\n      .pipe(server.reload({ stream: true }))\n  );\n}\n\nconst lintBase = (files) => {\n  return src(files)\n    .pipe(\\$.eslint({ fix: true }))\n    .pipe(server.reload({ stream: true, once: true }))\n    .pipe(\\$.eslint.format())\n    .pipe(\\$.if(!server.active, \\$.eslint.failAfterError()));\n};\n\nfunction lint() {\n  return lintBase(\'app/scripts/**/*.js\').pipe(dest(\'app/scripts\'));\n}\n\nfunction lintTest() {\n  return lintBase(\'test/spec/**/*.js\').pipe(dest(\'test/spec\'));\n}\n\nfunction html() {\n  // 合成 js、css 过程中，要过滤掉模板编译文件夹的代码\n  // 注意这里的 useref 插件合成 js、css 有一个问题文件行尾必须为 crlf，否则此文件不能正常合成\n  // 可用 .editorconfig 来限制文件行尾符\n  return src([\'app/**/*.html\', \'.tmp/**/*.html\', \'!app/common/**/*.html\', \'!.tmp/common/**/*.html\'])\n    .pipe(\\$.useref({ searchPath: [\'.tmp\', \'app\', \'.\'] }))\n    .pipe(\\$.if(/\\.js\\$/, \\$.uglify({ compress: { drop_console: true } })))\n    .pipe(\\$.if(/\\.css\\$/, \\$.postcss([cssnano({ safe: true, autoprefixer: false })])))\n    .pipe(\n      \\$.if(\n        /\\.html\\$/,\n        \\$.htmlmin({\n          collapseWhitespace: true,\n          minifyCSS: true,\n          minifyJS: { compress: { drop_console: true } },\n          processConditionalComments: true,\n          removeComments: true,\n          removeEmptyAttributes: true,\n          removeScriptTypeAttributes: true,\n          removeStyleLinkTypeAttributes: true\n        })\n      )\n    )\n    .pipe(dest(buildPath));\n}\n\nfunction images() {\n  return src(\'app/images/**/*\', { since: lastRun(images) }).pipe(dest(\\`\\${buildPath}/images\\`));\n}\n\nfunction fonts() {\n  return src(\'app/fonts/**/*.{eot,svg,ttf,woff,woff2}\').pipe(\n    \\$.if(!isProd, dest(\'.tmp/fonts\'), dest(\\`\\${buildPath}/fonts\\`))\n  );\n}\n\nfunction extras() {\n  // 过滤掉模板编译文件夹的代码与 html 代码\n  return src([\'app/*\', \'!app/**/*.html\', \'!app/common\'], {\n    dot: true\n  }).pipe(dest(buildPath));\n}\n\nfunction clean() {\n  return del([\'.tmp\', \\`\\${buildPath}/*\\`]);\n}\n\nfunction measureSize() {\n  return src(\\`\\${buildPath}/**/*\\`).pipe(\\$.size({ title: \'build\', gzip: true }));\n}\n\nconst build = series(\n  clean,\n  parallel(lint, series(parallel(styles, scripts, fileVarInclude), html), images, fonts, extras),\n  revAll,\n  measureSize\n);\n\nfunction startAppServer() {\n  server.init({\n    notify: false,\n    port,\n    server: {\n      baseDir: [\'.tmp\', \'app\'],\n      routes: {\n        \'/node_modules\': \'node_modules\'\n      },\n      middleware\n    }\n  });\n\n  watch([\'app/**/*.html\', \'app/images/**/*\', \'.tmp/fonts/**/*\']).on(\'change\', server.reload);\n\n  watch(\'app/styles/*.css\', styles);\n  watch(\'app/scripts/**/*.js\', scripts);\n  watch(\'app/fonts/**/*\', fonts);\n  // 监控 html 编译模板改动\n  watch(\'app/**/*.html\', fileVarInclude);\n}\n\nfunction startTestServer() {\n  server.init({\n    notify: false,\n    port,\n    ui: false,\n    server: {\n      baseDir: \'test\',\n      routes: {\n        \'/scripts\': \'.tmp/scripts\',\n        \'/node_modules\': \'node_modules\'\n      }\n    }\n  });\n\n  watch(\'app/scripts/**/*.js\', scripts);\n  watch([\'test/spec/**/*.js\', \'test/index.html\']).on(\'change\', server.reload);\n  watch(\'test/spec/**/*.js\', lintTest);\n}\n\nfunction startDistServer() {\n  server.init({\n    notify: false,\n    port,\n    server: {\n      baseDir: buildPath,\n      routes: {\n        \'/node_modules\': \'node_modules\',\n        // 注意这里的别名也要配置，否则资源访问不到\n        [publicPath]: buildPath\n      },\n      middleware\n    }\n  });\n}\n\n// 资源 hash，注意要在最后一步，同时配置路径别名，注意所有的资源引用必须以 &quot;/&quot; 开头，否则别名替换不成功\nfunction revAll() {\n  return src(\\`\\${buildPath}/**\\`)\n    .pipe(\n      \\$.revAll.revision({\n        prefix: publicPath,\n        dontRenameFile: [/^\\/favicon.ico\\$/g, \'.html\', \'robots.txt\']\n      })\n    )\n    .pipe(\\$.revDeleteOriginal())\n    .pipe(dest(buildPath));\n}\n\nfunction fileVarInclude() {\n  return src(\'app/**/*.html\')\n    .pipe(\\$.plumber())\n    .pipe(\n      \\$.fileInclude({\n        prefix: \'@@\',\n        basepath: \'@root\',\n        // 环境变量注入\n        // 需要在公共的模板文件中注入此变量\n        // <script>\n        //   window.GLOBAL_VARS = @@GLOBAL_VARS;\n        // </script>\n        context: {\n          GLOBAL_VARS: JSON.stringify(globalVars)\n        }\n      })\n    )\n    .pipe(dest(\'.tmp\'))\n    .pipe(server.reload({ stream: true }));\n}\n\nlet serve;\nif (isDev) {\n  serve = series(clean, parallel(styles, scripts, fonts, fileVarInclude), startAppServer);\n} else if (isTest) {\n  serve = series(clean, scripts, startTestServer);\n} else if (isProd) {\n  serve = series(build, startDistServer);\n}\n\nexports.serve = serve;\nexports.build = build;\nexports.default = build;`, `58596241468913115000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="js"><pre style="counter-reset: linenumber NaN" class="language-js line-numbers"><code class="language-js"><span class="token comment">// generated on 2019-11-07 using generator-webapp 4.0.0-6</span>\n<span class="token keyword">const</span> <span class="token punctuation">{</span> src<span class="token punctuation">,</span> dest<span class="token punctuation">,</span> watch<span class="token punctuation">,</span> series<span class="token punctuation">,</span> parallel<span class="token punctuation">,</span> lastRun <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'gulp\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> gulpLoadPlugins <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'gulp-load-plugins\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> browserSync <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'browser-sync\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> del <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'del\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// const autoprefixer = require(\'autoprefixer\');</span>\n<span class="token keyword">const</span> cssnano <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'cssnano\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> <span class="token punctuation">{</span> argv <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'yargs\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> proxy <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'http-proxy-middleware\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> postcssPresetEnv <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'postcss-preset-env\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'./proxy.json\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> globalJSON <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'./global.json\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> $ <span class="token operator">=</span> <span class="token function">gulpLoadPlugins</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> server <span class="token operator">=</span> browserSync<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> port <span class="token operator">=</span> argv<span class="token punctuation">.</span>port <span class="token operator">||</span> config<span class="token punctuation">.</span>port <span class="token operator">||</span> <span class="token number">9000</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> buildPath <span class="token operator">=</span> argv<span class="token punctuation">.</span>buildPath <span class="token operator">||</span> <span class="token string">\'build\'</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> varsEnv <span class="token operator">=</span> argv<span class="token punctuation">.</span>server <span class="token operator">||</span> <span class="token string">\'master\'</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> globalVars <span class="token operator">=</span> globalJSON<span class="token punctuation">.</span>runtime<span class="token punctuation">[</span>varsEnv<span class="token punctuation">]</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> publicPath <span class="token operator">=</span> argv<span class="token punctuation">.</span>publicPath <span class="token operator">||</span> <span class="token string">\'/form\'</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> isProd <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">===</span> <span class="token string">\'production\'</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> isTest <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">===</span> <span class="token string">\'test\'</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> isDev <span class="token operator">=</span> <span class="token operator">!</span>isProd <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>isTest<span class="token punctuation">;</span>\n\n<span class="token comment">// 配置反向代理</span>\n<span class="token keyword">const</span> middleware <span class="token operator">=</span> config<span class="token punctuation">.</span>proxies<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=></span>\n  <span class="token function">proxy</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>match<span class="token punctuation">,</span> <span class="token punctuation">{</span>\n    target<span class="token punctuation">:</span> item<span class="token punctuation">.</span>host<span class="token punctuation">,</span>\n    changeOrigin<span class="token punctuation">:</span> <span class="token boolean">true</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span>\n<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">function</span> <span class="token function">styles</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">return</span> <span class="token function">src</span><span class="token punctuation">(</span><span class="token string">\'app/styles/*.css\'</span><span class="token punctuation">)</span>\n    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>$<span class="token punctuation">.</span><span class="token function">if</span><span class="token punctuation">(</span><span class="token operator">!</span>isProd<span class="token punctuation">,</span> $<span class="token punctuation">.</span>sourcemaps<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>\n      $<span class="token punctuation">.</span><span class="token function">postcss</span><span class="token punctuation">(</span><span class="token punctuation">[</span>\n        <span class="token comment">// autoprefixer(),</span>\n        <span class="token operator">/</span><span class="token operator">/</span> 采用 postcss 最新语法\n        <span class="token function">postcssPresetEnv</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n          stage<span class="token punctuation">:</span> <span class="token number">0</span>\n        <span class="token punctuation">}</span><span class="token punctuation">)</span>\n      <span class="token punctuation">]</span><span class="token punctuation">)</span>\n    <span class="token punctuation">)</span>\n    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>$<span class="token punctuation">.</span><span class="token function">if</span><span class="token punctuation">(</span><span class="token operator">!</span>isProd<span class="token punctuation">,</span> $<span class="token punctuation">.</span>sourcemaps<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">dest</span><span class="token punctuation">(</span><span class="token string">\'.tmp/styles\'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>server<span class="token punctuation">.</span><span class="token function">reload</span><span class="token punctuation">(</span><span class="token punctuation">{</span> stream<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">function</span> <span class="token function">scripts</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">return</span> <span class="token punctuation">(</span>\n    <span class="token function">src</span><span class="token punctuation">(</span><span class="token string">\'app/scripts/**/*.js\'</span><span class="token punctuation">)</span>\n      <span class="token comment">// plumber 插件防止 gulp 报错崩溃</span>\n      <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>$<span class="token punctuation">.</span><span class="token function">plumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n      <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>$<span class="token punctuation">.</span><span class="token function">if</span><span class="token punctuation">(</span><span class="token operator">!</span>isProd<span class="token punctuation">,</span> $<span class="token punctuation">.</span>sourcemaps<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n      <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>$<span class="token punctuation">.</span><span class="token function">babel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n      <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>$<span class="token punctuation">.</span><span class="token function">if</span><span class="token punctuation">(</span><span class="token operator">!</span>isProd<span class="token punctuation">,</span> $<span class="token punctuation">.</span>sourcemaps<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">\'.\'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n      <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">dest</span><span class="token punctuation">(</span><span class="token string">\'.tmp/scripts\'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n      <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>server<span class="token punctuation">.</span><span class="token function">reload</span><span class="token punctuation">(</span><span class="token punctuation">{</span> stream<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n  <span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">const</span> <span class="token function-variable function">lintBase</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">files</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">return</span> <span class="token function">src</span><span class="token punctuation">(</span>files<span class="token punctuation">)</span>\n    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>$<span class="token punctuation">.</span><span class="token function">eslint</span><span class="token punctuation">(</span><span class="token punctuation">{</span> fix<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>server<span class="token punctuation">.</span><span class="token function">reload</span><span class="token punctuation">(</span><span class="token punctuation">{</span> stream<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> once<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>$<span class="token punctuation">.</span>eslint<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>$<span class="token punctuation">.</span><span class="token function">if</span><span class="token punctuation">(</span><span class="token operator">!</span>server<span class="token punctuation">.</span>active<span class="token punctuation">,</span> $<span class="token punctuation">.</span>eslint<span class="token punctuation">.</span><span class="token function">failAfterError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n<span class="token keyword">function</span> <span class="token function">lint</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">return</span> <span class="token function">lintBase</span><span class="token punctuation">(</span><span class="token string">\'app/scripts/**/*.js\'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">dest</span><span class="token punctuation">(</span><span class="token string">\'app/scripts\'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">function</span> <span class="token function">lintTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">return</span> <span class="token function">lintBase</span><span class="token punctuation">(</span><span class="token string">\'test/spec/**/*.js\'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">dest</span><span class="token punctuation">(</span><span class="token string">\'test/spec\'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">function</span> <span class="token function">html</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token comment">// 合成 js、css 过程中，要过滤掉模板编译文件夹的代码</span>\n  <span class="token comment">// 注意这里的 useref 插件合成 js、css 有一个问题文件行尾必须为 crlf，否则此文件不能正常合成</span>\n  <span class="token comment">// 可用 .editorconfig 来限制文件行尾符</span>\n  <span class="token keyword">return</span> <span class="token function">src</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">\'app/**/*.html\'</span><span class="token punctuation">,</span> <span class="token string">\'.tmp/**/*.html\'</span><span class="token punctuation">,</span> <span class="token string">\'!app/common/**/*.html\'</span><span class="token punctuation">,</span> <span class="token string">\'!.tmp/common/**/*.html\'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>\n    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>$<span class="token punctuation">.</span><span class="token function">useref</span><span class="token punctuation">(</span><span class="token punctuation">{</span> searchPath<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">\'.tmp\'</span><span class="token punctuation">,</span> <span class="token string">\'app\'</span><span class="token punctuation">,</span> <span class="token string">\'.\'</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>$<span class="token punctuation">.</span><span class="token function">if</span><span class="token punctuation">(</span><span class="token regex">/\\.js$/</span><span class="token punctuation">,</span> $<span class="token punctuation">.</span><span class="token function">uglify</span><span class="token punctuation">(</span><span class="token punctuation">{</span> compress<span class="token punctuation">:</span> <span class="token punctuation">{</span> drop_console<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>$<span class="token punctuation">.</span><span class="token function">if</span><span class="token punctuation">(</span><span class="token regex">/\\.css$/</span><span class="token punctuation">,</span> $<span class="token punctuation">.</span><span class="token function">postcss</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token function">cssnano</span><span class="token punctuation">(</span><span class="token punctuation">{</span> safe<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> autoprefixer<span class="token punctuation">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>\n      $<span class="token punctuation">.</span><span class="token function">if</span><span class="token punctuation">(</span>\n        <span class="token regex">/\\.html$/</span><span class="token punctuation">,</span>\n        $<span class="token punctuation">.</span><span class="token function">htmlmin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n          collapseWhitespace<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>\n          minifyCSS<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>\n          minifyJS<span class="token punctuation">:</span> <span class="token punctuation">{</span> compress<span class="token punctuation">:</span> <span class="token punctuation">{</span> drop_console<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>\n          processConditionalComments<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>\n          removeComments<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>\n          removeEmptyAttributes<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>\n          removeScriptTypeAttributes<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>\n          removeStyleLinkTypeAttributes<span class="token punctuation">:</span> <span class="token boolean">true</span>\n        <span class="token punctuation">}</span><span class="token punctuation">)</span>\n      <span class="token punctuation">)</span>\n    <span class="token punctuation">)</span>\n    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">dest</span><span class="token punctuation">(</span>buildPath<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">function</span> <span class="token function">images</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">return</span> <span class="token function">src</span><span class="token punctuation">(</span><span class="token string">\'app/images/**/*\'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> since<span class="token punctuation">:</span> <span class="token function">lastRun</span><span class="token punctuation">(</span>images<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">dest</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>buildPath<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/images</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">function</span> <span class="token function">fonts</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">return</span> <span class="token function">src</span><span class="token punctuation">(</span><span class="token string">\'app/fonts/**/*.{eot,svg,ttf,woff,woff2}\'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>\n    $<span class="token punctuation">.</span><span class="token function">if</span><span class="token punctuation">(</span><span class="token operator">!</span>isProd<span class="token punctuation">,</span> <span class="token function">dest</span><span class="token punctuation">(</span><span class="token string">\'.tmp/fonts\'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">dest</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>buildPath<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/fonts</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n  <span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">function</span> <span class="token function">extras</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token comment">// 过滤掉模板编译文件夹的代码与 html 代码</span>\n  <span class="token keyword">return</span> <span class="token function">src</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">\'app/*\'</span><span class="token punctuation">,</span> <span class="token string">\'!app/**/*.html\'</span><span class="token punctuation">,</span> <span class="token string">\'!app/common\'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>\n    dot<span class="token punctuation">:</span> <span class="token boolean">true</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">dest</span><span class="token punctuation">(</span>buildPath<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">function</span> <span class="token function">clean</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">return</span> <span class="token function">del</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">\'.tmp\'</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>buildPath<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/*</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">function</span> <span class="token function">measureSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">return</span> <span class="token function">src</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>buildPath<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/**/*</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>$<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">{</span> title<span class="token punctuation">:</span> <span class="token string">\'build\'</span><span class="token punctuation">,</span> gzip<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">const</span> build <span class="token operator">=</span> <span class="token function">series</span><span class="token punctuation">(</span>\n  clean<span class="token punctuation">,</span>\n  <span class="token function">parallel</span><span class="token punctuation">(</span>lint<span class="token punctuation">,</span> <span class="token function">series</span><span class="token punctuation">(</span><span class="token function">parallel</span><span class="token punctuation">(</span>styles<span class="token punctuation">,</span> scripts<span class="token punctuation">,</span> fileVarInclude<span class="token punctuation">)</span><span class="token punctuation">,</span> html<span class="token punctuation">)</span><span class="token punctuation">,</span> images<span class="token punctuation">,</span> fonts<span class="token punctuation">,</span> extras<span class="token punctuation">)</span><span class="token punctuation">,</span>\n  revAll<span class="token punctuation">,</span>\n  measureSize\n<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">function</span> <span class="token function">startAppServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  server<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n    notify<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>\n    port<span class="token punctuation">,</span>\n    server<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n      baseDir<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">\'.tmp\'</span><span class="token punctuation">,</span> <span class="token string">\'app\'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n      routes<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n        <span class="token string">\'/node_modules\'</span><span class="token punctuation">:</span> <span class="token string">\'node_modules\'</span>\n      <span class="token punctuation">}</span><span class="token punctuation">,</span>\n      middleware\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n  <span class="token function">watch</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">\'app/**/*.html\'</span><span class="token punctuation">,</span> <span class="token string">\'app/images/**/*\'</span><span class="token punctuation">,</span> <span class="token string">\'.tmp/fonts/**/*\'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">\'change\'</span><span class="token punctuation">,</span> server<span class="token punctuation">.</span>reload<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n  <span class="token function">watch</span><span class="token punctuation">(</span><span class="token string">\'app/styles/*.css\'</span><span class="token punctuation">,</span> styles<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token function">watch</span><span class="token punctuation">(</span><span class="token string">\'app/scripts/**/*.js\'</span><span class="token punctuation">,</span> scripts<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token function">watch</span><span class="token punctuation">(</span><span class="token string">\'app/fonts/**/*\'</span><span class="token punctuation">,</span> fonts<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token comment">// 监控 html 编译模板改动</span>\n  <span class="token function">watch</span><span class="token punctuation">(</span><span class="token string">\'app/**/*.html\'</span><span class="token punctuation">,</span> fileVarInclude<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">function</span> <span class="token function">startTestServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  server<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n    notify<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>\n    port<span class="token punctuation">,</span>\n    ui<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>\n    server<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n      baseDir<span class="token punctuation">:</span> <span class="token string">\'test\'</span><span class="token punctuation">,</span>\n      routes<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n        <span class="token string">\'/scripts\'</span><span class="token punctuation">:</span> <span class="token string">\'.tmp/scripts\'</span><span class="token punctuation">,</span>\n        <span class="token string">\'/node_modules\'</span><span class="token punctuation">:</span> <span class="token string">\'node_modules\'</span>\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n  <span class="token function">watch</span><span class="token punctuation">(</span><span class="token string">\'app/scripts/**/*.js\'</span><span class="token punctuation">,</span> scripts<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token function">watch</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">\'test/spec/**/*.js\'</span><span class="token punctuation">,</span> <span class="token string">\'test/index.html\'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">\'change\'</span><span class="token punctuation">,</span> server<span class="token punctuation">.</span>reload<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token function">watch</span><span class="token punctuation">(</span><span class="token string">\'test/spec/**/*.js\'</span><span class="token punctuation">,</span> lintTest<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">function</span> <span class="token function">startDistServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  server<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n    notify<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>\n    port<span class="token punctuation">,</span>\n    server<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n      baseDir<span class="token punctuation">:</span> buildPath<span class="token punctuation">,</span>\n      routes<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n        <span class="token string">\'/node_modules\'</span><span class="token punctuation">:</span> <span class="token string">\'node_modules\'</span><span class="token punctuation">,</span>\n        <span class="token comment">// 注意这里的别名也要配置，否则资源访问不到</span>\n        <span class="token punctuation">[</span>publicPath<span class="token punctuation">]</span><span class="token punctuation">:</span> buildPath\n      <span class="token punctuation">}</span><span class="token punctuation">,</span>\n      middleware\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// 资源 hash，注意要在最后一步，同时配置路径别名，注意所有的资源引用必须以 "/" 开头，否则别名替换不成功</span>\n<span class="token keyword">function</span> <span class="token function">revAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">return</span> <span class="token function">src</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>buildPath<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/**</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>\n    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>\n      $<span class="token punctuation">.</span>revAll<span class="token punctuation">.</span><span class="token function">revision</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n        prefix<span class="token punctuation">:</span> publicPath<span class="token punctuation">,</span>\n        dontRenameFile<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token regex">/^\\/favicon.ico$/g</span><span class="token punctuation">,</span> <span class="token string">\'.html\'</span><span class="token punctuation">,</span> <span class="token string">\'robots.txt\'</span><span class="token punctuation">]</span>\n      <span class="token punctuation">}</span><span class="token punctuation">)</span>\n    <span class="token punctuation">)</span>\n    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>$<span class="token punctuation">.</span><span class="token function">revDeleteOriginal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">dest</span><span class="token punctuation">(</span>buildPath<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">function</span> <span class="token function">fileVarInclude</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">return</span> <span class="token function">src</span><span class="token punctuation">(</span><span class="token string">\'app/**/*.html\'</span><span class="token punctuation">)</span>\n    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>$<span class="token punctuation">.</span><span class="token function">plumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>\n      $<span class="token punctuation">.</span><span class="token function">fileInclude</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n        prefix<span class="token punctuation">:</span> <span class="token string">\'@@\'</span><span class="token punctuation">,</span>\n        basepath<span class="token punctuation">:</span> <span class="token string">\'@root\'</span><span class="token punctuation">,</span>\n        <span class="token comment">// 环境变量注入</span>\n        <span class="token comment">// 需要在公共的模板文件中注入此变量</span>\n        <span class="token comment">// &lt;script></span>\n        <span class="token comment">//   window.GLOBAL_VARS = @@GLOBAL_VARS;</span>\n        <span class="token comment">// &lt;/script></span>\n        context<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n          <span class="token constant">GLOBAL_VARS</span><span class="token punctuation">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>globalVars<span class="token punctuation">)</span>\n        <span class="token punctuation">}</span>\n      <span class="token punctuation">}</span><span class="token punctuation">)</span>\n    <span class="token punctuation">)</span>\n    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">dest</span><span class="token punctuation">(</span><span class="token string">\'.tmp\'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>server<span class="token punctuation">.</span><span class="token function">reload</span><span class="token punctuation">(</span><span class="token punctuation">{</span> stream<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">let</span> serve<span class="token punctuation">;</span>\n<span class="token keyword">if</span> <span class="token punctuation">(</span>isDev<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  serve <span class="token operator">=</span> <span class="token function">series</span><span class="token punctuation">(</span>clean<span class="token punctuation">,</span> <span class="token function">parallel</span><span class="token punctuation">(</span>styles<span class="token punctuation">,</span> scripts<span class="token punctuation">,</span> fonts<span class="token punctuation">,</span> fileVarInclude<span class="token punctuation">)</span><span class="token punctuation">,</span> startAppServer<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>isTest<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  serve <span class="token operator">=</span> <span class="token function">series</span><span class="token punctuation">(</span>clean<span class="token punctuation">,</span> scripts<span class="token punctuation">,</span> startTestServer<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>isProd<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  serve <span class="token operator">=</span> <span class="token function">series</span><span class="token punctuation">(</span>build<span class="token punctuation">,</span> startDistServer<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\nexports<span class="token punctuation">.</span>serve <span class="token operator">=</span> serve<span class="token punctuation">;</span>\nexports<span class="token punctuation">.</span>build <span class="token operator">=</span> build<span class="token punctuation">;</span>\nexports<span class="token punctuation">.</span>default <span class="token operator">=</span> build<span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="文件目录结构"><a href="#%E6%96%87%E4%BB%B6%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>文件目录结构</h3>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/2019-11-15-15-48-13-26481053e92ef2ababdfbeb52c0758f8-0f2f0.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 455px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 154.2857142857143%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAfCAIAAABoLHqZAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACVklEQVQ4y5WVSW7cMBBFdRH3pJmUOFOkRM1St9pT2okRIIvkALn/BVINeB3TQC318ate/aKCKMwP55fj+kwKHiN2jLF/BblofvTrr8trv90wNYgazKxnBWFOlXLb45sbL7ado4zeK/eq4BghxE338k6EqeoeE3WIkGcFhxgTom7jZtzYDqvQzSkpfGc+JgUl8nfbgy2V9e6YfgFYGBcRVdH3d2W6cbkiovZh7u0c45Kb7fWnaYZx3rhuYBhfMUyYl9L0i6raupsTxL4gDhOcs1q//TXNCMyg5684xzjBont67sbV9WvBqiSn/jMXSYYvKlbGVc3o+gVTYIZ8gcU5dbypbAd7tu3kDxzEKMEyW/+oeoDO63byZxY8xPhbN7+NS0pknJGHY7q/R89v5v0Jz9d6e13SXFBhSl4xVUcZ8TEPohNKnq7sdtOyDrMSzBNEPeMdHEOc1lpOTWV6sAXOD97xDnYhYoxJKdvhAnsqWZVi7g3slBnjrO3qdoZV9dPFuslXvIsLlSQNxlW7wFVaNxJuvJ0jXGV5S8hwhoSemW5g8wDMh1mwDzGjSEmq7AAJgcPcnTIon5DdxZQgrbltF+sGUw+67qGosJ82D7QxZ6gy8ArM0na6GbhqICdwHv8XQwqDfYQLhGVJtTCNNJTKXfh52/BsxmkR7GOcp4Ut6MD1KLQo2MGDM3yTpmVwgIRRLBxc5DqcH4flCi8hNPwp7Y+2AZippHFT004QsmHe7juTtQ+wgpNMiRIRTXiVlwI0YVp6heQQZrFwedVRrsGNSQt/HM+r+gcaZzZfDs4qsgAAAABJRU5ErkJggg==\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;"\n        alt="2019 11 15 15 48 13"\n        title=""\n        src="/static/2019-11-15-15-48-13-26481053e92ef2ababdfbeb52c0758f8-0f2f0.png"\n        srcset="/static/2019-11-15-15-48-13-26481053e92ef2ababdfbeb52c0758f8-f5c73.png 200w,\n/static/2019-11-15-15-48-13-26481053e92ef2ababdfbeb52c0758f8-799a4.png 400w,\n/static/2019-11-15-15-48-13-26481053e92ef2ababdfbeb52c0758f8-0f2f0.png 455w"\n        sizes="(max-width: 455px) 100vw, 455px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<h2 id="代码优化"><a href="#%E4%BB%A3%E7%A0%81%E4%BC%98%E5%8C%96" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>代码优化</h2>\n<ol>\n<li>除了在使用大量原生语法外，利用 gulp-file-include 插件大量复用了模板代码，确保多次使用的 html 代码在模板代码文件夹下。</li>\n<li>\n<p>同时为了首屏加载速度，图片需要压缩，这里用了阿里云的 oss 图片压缩服务，代码如下：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="31613023069971000000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`// 参数的功能分别是调整宽度、质量、是否是渐进式、格式转换为 jpg\nfunction compressImg(oss, width = window.innerWidth) {\n return \\`\\${oss}?x-oss-process=image/resize,w_\\${width}/quality,q_50/interlace,1/format,jpg\\`;\n}`, `31613023069971000000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="js"><pre style="counter-reset: linenumber NaN" class="language-js line-numbers"><code class="language-js"><span class="token comment">// 参数的功能分别是调整宽度、质量、是否是渐进式、格式转换为 jpg</span>\n<span class="token keyword">function</span> <span class="token function">compressImg</span><span class="token punctuation">(</span><span class="token parameter">oss<span class="token punctuation">,</span> width <span class="token operator">=</span> window<span class="token punctuation">.</span>innerWidth</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>oss<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">?x-oss-process=image/resize,w_</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>width<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/quality,q_50/interlace,1/format,jpg</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>\n</li>\n<li>尽量在各自对应的平台加载相应的代码，比如微信分享脚本只在微信端加载，背景图只在桌面端加载，图片压缩的宽度尽可能的小</li>\n</ol>\n<h1 id="加载效果"><a href="#%E5%8A%A0%E8%BD%BD%E6%95%88%E6%9E%9C" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>加载效果</h1>\n<p>加载大小非自定义图片部分 28.4kb，自定义图片部分 57.5kb。</p>\n<p>加载速度（不限速）264ms，3g low（限速 120 kb/s）1.01s。</p>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/2019-11-15-16-27-42-46c87a87681f16c070037c0124d46f06-c26ee.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 38.22505800464037%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAA7DAAAOwwHHb6hkAAABp0lEQVQY002Nj0vicBjG919fgdNCzQvKHwcHB0Ed1JVkRdN2rZmpc9bMzFrmlGbrh0xvszWnc23f9e2+GkUfXh6eF97nebGV5ZXE5laW2mfT9Nrv5WDAHwoGv4fmgn5/KBDw4bgP9/hmZn3+QCIeZ9PpzN+9PJViqFSOJDCOImunXDa5wzOZxMafb1PTHo8Hx3GkXq8XGaTvntiMn5C7VyUWTY1jrwp5jCFT60u/WHK7miFocndhMRyNRmOxWCQSCYfDSKMTkKWJbTa50SwzzYuyWCk1uCJ2nD38Oe8tFw5a9aqhdQFwHccBAFiWpaqqMwGttm2fc0fCZUmWBEngqyfF2jGLlXK5ev2sXi1IfNHsKxC+ffLFjrm/vRbK2ae2IN/fHFE0sZPE8vR+q8UPtEdDFZ0Xw3Vf4QcoDj8qkJqG2lfFF0PWtQ5N7a0ltjDm+lxRJMeQbf3BtY3x3eS7BSDXfq+YhOEbMDVHf7AHcrf3yEsNoX2H/VhdP6xU5KHWVDrKyER/wSsEEFrA/TcEQ9McDMdjjkbdwbPY64ha71Z/Fvv9hm78B0R1gs7qLKXOAAAAAElFTkSuQmCC\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;"\n        alt="2019 11 15 16 27 42"\n        title=""\n        src="/static/2019-11-15-16-27-42-46c87a87681f16c070037c0124d46f06-fee1c.png"\n        srcset="/static/2019-11-15-16-27-42-46c87a87681f16c070037c0124d46f06-a67b7.png 200w,\n/static/2019-11-15-16-27-42-46c87a87681f16c070037c0124d46f06-0b187.png 400w,\n/static/2019-11-15-16-27-42-46c87a87681f16c070037c0124d46f06-fee1c.png 800w,\n/static/2019-11-15-16-27-42-46c87a87681f16c070037c0124d46f06-b1a91.png 1200w,\n/static/2019-11-15-16-27-42-46c87a87681f16c070037c0124d46f06-95179.png 1600w,\n/static/2019-11-15-16-27-42-46c87a87681f16c070037c0124d46f06-c26ee.png 1724w"\n        sizes="(max-width: 800px) 100vw, 800px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/2019-11-15-16-28-14-4f975f8c28183d9577aadf2c3c6b4d5e-5fe3e.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 24.685314685314683%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAvElEQVQY021P2Y7EIAzr//9lpUIp5SyQhGOk9Y5m92ksZEUJjuPNO5dStPZOKd23U0qZU+f8jD7mnOMb/vsbCfU5ZQ6awkMaU2USrpmewsQivXd586cQ+TDzprS21p7G6BNkzHXhXcaEGBpRTKm1VkrBJOfMRBV4nuJcuOymldr3HTPvfQwhRhAQa22vtWopMGTm4ziwE8Lfo3sv3mfnNtghJwLPP6y1cBTcUIOhJCL8gd45h6h9DCzNKf0ArA0cKACop4UAAAAASUVORK5CYII=\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;"\n        alt="2019 11 15 16 28 14"\n        title=""\n        src="/static/2019-11-15-16-28-14-4f975f8c28183d9577aadf2c3c6b4d5e-fee1c.png"\n        srcset="/static/2019-11-15-16-28-14-4f975f8c28183d9577aadf2c3c6b4d5e-a67b7.png 200w,\n/static/2019-11-15-16-28-14-4f975f8c28183d9577aadf2c3c6b4d5e-0b187.png 400w,\n/static/2019-11-15-16-28-14-4f975f8c28183d9577aadf2c3c6b4d5e-fee1c.png 800w,\n/static/2019-11-15-16-28-14-4f975f8c28183d9577aadf2c3c6b4d5e-b1a91.png 1200w,\n/static/2019-11-15-16-28-14-4f975f8c28183d9577aadf2c3c6b4d5e-5fe3e.png 1430w"\n        sizes="(max-width: 800px) 100vw, 800px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/2019-11-15-16-30-09-4b6fd09d0de380a0692b6b9f19a6ccf0-4cbd1.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 41.47582697201018%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAA7DAAAOwwHHb6hkAAABFUlEQVQY01WRi26EIBBF/f9PbLJZH7AgCCqowG676RHbpL2AmbnzuAM2s1drWEKMgbVF752drPEWt5SUnjmVXMqzcP4Dpsk5HQf72FkXUkq5pGP3i5m2NRx73I8Ml/O2bcRzBVmN1mqaJpzyFznTO4SI6uv1ijHu+47hnLMVy7KQ0IihGwZB8VfF5y+w17DS5ypGEFJr3XVd3/fowTft/Y4vpcQ3xrgK7MvIPyMEhiSbhLZtkcU+7yyF6CrGcaQxZUxlKii+3oaZ6YIyISEEIWY5lfU4KnVem+d7v9/n6Hzr5nnIgCAVZaLeeyqRQRy++bjd7m0rldLQ/CXnjHyYQVrxYCRrJ+fnh9KjsW6eByF6jjwJ3G+x1cS1cLEYUwAAAABJRU5ErkJggg==\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;"\n        alt="2019 11 15 16 30 09"\n        title=""\n        src="/static/2019-11-15-16-30-09-4b6fd09d0de380a0692b6b9f19a6ccf0-fee1c.png"\n        srcset="/static/2019-11-15-16-30-09-4b6fd09d0de380a0692b6b9f19a6ccf0-a67b7.png 200w,\n/static/2019-11-15-16-30-09-4b6fd09d0de380a0692b6b9f19a6ccf0-0b187.png 400w,\n/static/2019-11-15-16-30-09-4b6fd09d0de380a0692b6b9f19a6ccf0-fee1c.png 800w,\n/static/2019-11-15-16-30-09-4b6fd09d0de380a0692b6b9f19a6ccf0-4cbd1.png 1179w"\n        sizes="(max-width: 800px) 100vw, 800px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/2019-11-15-16-32-29-fce276c77308f4105fbcf2e23ccfa98e-28530.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 54.91559086395233%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABiklEQVQoz11S25ajIBDk/39wzz6sSYwakQACzV3NFPqwM1OnT1M2tH1lqxAUklbqNU3DOM5dJ7tOCCGl0lpLKY0x/hvI0yXg7Ph8jhP7th17Ayxb3XZ846jQW7uF/dS11pxLBlJiec8heJvdGp0vZfXO52KCo1w1BZfpHY2KaaGkYhWUZIzCWxUzt4EJbY1P0nppSbmoCZK0b1pBrOfaKIqrz2Kltw3aJ+XCAq9Q2Z/b+PfBu0mN0gu3SX9Iv7+paXBuSs+tCh9wPOi5AV/s9m+Q3aTZOD7RKjTirLF8l32rOUVydm/Fl+BB7WWcpnHhMxufj6HvrbHoRPkJWEIIqzG1/bZYBxBojPFxv/e3G5PPp+26ME2JqPzyR2Nj9PNcnAPHA/S2GUNwfe9fL/YcRvwGgpH+D35OA2eLrBSGgyvkDEEWiHy/NTC+zHzm2AciOie74d3WxoqBHwnZXvZaryUBTynxZUEwxjlf19XaVhGW6ayLzCzE4yWHxQ6jFQL7gKW4nJEOnJERyBdhznPZL6HixAAAAABJRU5ErkJggg==\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;"\n        alt="2019 11 15 16 32 29"\n        title=""\n        src="/static/2019-11-15-16-32-29-fce276c77308f4105fbcf2e23ccfa98e-fee1c.png"\n        srcset="/static/2019-11-15-16-32-29-fce276c77308f4105fbcf2e23ccfa98e-a67b7.png 200w,\n/static/2019-11-15-16-32-29-fce276c77308f4105fbcf2e23ccfa98e-0b187.png 400w,\n/static/2019-11-15-16-32-29-fce276c77308f4105fbcf2e23ccfa98e-fee1c.png 800w,\n/static/2019-11-15-16-32-29-fce276c77308f4105fbcf2e23ccfa98e-28530.png 1007w"\n        sizes="(max-width: 800px) 100vw, 800px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>',
id:"/github/workspace/blog/轻量级网站构建实践/index.md absPath of file >>> MarkdownRemark",timeToRead:5,frontmatter:{date:"2019-11-15 15:04:04",path:"/lightweight-website-construction/",tags:"前端, 轻量级网站, 预研",title:"轻量级网站构建实践",draft:null}}],length:1,tag:"轻量级网站",pagesSum:1,page:1}}}});