webpackJsonp([6126622387049],{1409:function(n,s){n.exports={data:{site:{siteMetadata:{title:"女王控的博客",description:'前端工程师，黑猫女王控，欢迎勾搭，技术相关<a href="https://github.com/towavephone" target="_blank">@towavephone</a>，QQ闲聊<a href="tencent://AddContact/?fromId=45&fromSubId=1&subcmd=all&uin=634407147&website=www.oicqzone.com">@towave</a>，bili关注<a href="https://space.bilibili.com/11507708#/" target="_blank">@towave</a>',siteUrl:"https://blog.towavephone.com"}}},pathContext:{posts:[{excerpt:"组件实践 组件接口设计三原则 保持接口小，props 数量要少 根据数据边界来划分组件，利用组合（composition） 把 state 尽量往上层组件提取 同时，我们也接触了这样一些最佳实践： 避免 renderXXXX 函数，直接使用独立的纯函数组件 给回调函数类型的 props 加统一前缀，比如 on 或者 handle 使用 propTypes 来定义组件的 props 组件内部实现 尽量每个组件都有自己专属的源代码文件； 用解构赋值（destructuring assignment…",html:'<h1 id="组件实践"><a href="#%E7%BB%84%E4%BB%B6%E5%AE%9E%E8%B7%B5" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>组件实践</h1>\n<h2 id="组件接口设计三原则"><a href="#%E7%BB%84%E4%BB%B6%E6%8E%A5%E5%8F%A3%E8%AE%BE%E8%AE%A1%E4%B8%89%E5%8E%9F%E5%88%99" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>组件接口设计三原则</h2>\n<ol>\n<li>保持接口小，props 数量要少</li>\n<li>根据数据边界来划分组件，利用组合（composition）</li>\n<li>把 state 尽量往上层组件提取</li>\n</ol>\n<p>同时，我们也接触了这样一些最佳实践：</p>\n<ol>\n<li>避免 renderXXXX 函数，直接使用独立的纯函数组件</li>\n<li>给回调函数类型的 props 加统一前缀，比如 on 或者 handle</li>\n<li>使用 propTypes 来定义组件的 props</li>\n</ol>\n<h2 id="组件内部实现"><a href="#%E7%BB%84%E4%BB%B6%E5%86%85%E9%83%A8%E5%AE%9E%E7%8E%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>组件内部实现</h2>\n<ol>\n<li>尽量每个组件都有自己专属的源代码文件；</li>\n<li>用解构赋值（destructuring assignment）的方法获取参数 props 的每个属性值；</li>\n<li>利用属性初始化（property initializer）来定义 state 和成员函数。</li>\n</ol>\n<h2 id="组件化样式"><a href="#%E7%BB%84%E4%BB%B6%E5%8C%96%E6%A0%B7%E5%BC%8F" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>组件化样式</h2>\n<ol>\n<li>React 将内容、样式和动态功能聚集在一个模块中，是高聚合的表现；</li>\n<li>React 原生 style 属性的用法；</li>\n<li>组件化样式 styled jsx 的用法。</li>\n</ol>\n<h1 id="组件设计模式"><a href="#%E7%BB%84%E4%BB%B6%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>组件设计模式</h1>\n<h2 id="聪明组件与傻瓜组件"><a href="#%E8%81%AA%E6%98%8E%E7%BB%84%E4%BB%B6%E4%B8%8E%E5%82%BB%E7%93%9C%E7%BB%84%E4%BB%B6" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>聪明组件与傻瓜组件</h2>\n<h3 id="傻瓜组件（展示组件、无状态组件）"><a href="#%E5%82%BB%E7%93%9C%E7%BB%84%E4%BB%B6%EF%BC%88%E5%B1%95%E7%A4%BA%E7%BB%84%E4%BB%B6%E3%80%81%E6%97%A0%E7%8A%B6%E6%80%81%E7%BB%84%E4%BB%B6%EF%BC%89" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>傻瓜组件（展示组件、无状态组件）</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="18983168810433405000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`import SmileFace from \'./yaoming_simile.png\';\n\nconst Joke = ({ value }) => {\n  return (\n    <div>\n      <img src={SmileFace} />\n      {value || \'loading...\'}\n    </div>\n  );\n};`, `18983168810433405000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="jsx"><pre style="counter-reset: linenumber NaN" class="language-jsx line-numbers"><code class="language-jsx"><span class="token keyword">import</span> SmileFace <span class="token keyword">from</span> <span class="token string">\'./yaoming_simile.png\'</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> <span class="token function-variable function">Joke</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> value <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">return</span> <span class="token punctuation">(</span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>SmileFace<span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">\n      </span><span class="token punctuation">{</span>value <span class="token operator">||</span> <span class="token string">\'loading...\'</span><span class="token punctuation">}</span><span class="token plain-text">\n    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n  <span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="purecomponent"><a href="#purecomponent" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>PureComponent</h3>\n<p>因为傻瓜组件一般没有自己的状态，所以可以像上面的 Joke 一样实现为函数形式，其实，我们可以进一步改进，利用 PureComponent 来提高傻瓜组件的性能。</p>\n<p>函数形式的 React 组件，好处是不需要管理 state，占用资源少，但是，函数形式的组件无法利用 shouldComponentUpdate。</p>\n<p>PureComponent 中 shouldComponentUpdate 的实现方式就是比较这次渲染的 props 是否和上一次 props 相同。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="93553945471139510000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class Joke extends React.PureComponent {\n  render() {\n    return (\n      <div>\n        <img src={SmileFace} />\n        {this.props.value || \'loading...\'}\n      </div>\n    );\n  }\n}`, `93553945471139510000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="jsx"><pre style="counter-reset: linenumber NaN" class="language-jsx line-numbers"><code class="language-jsx"><span class="token keyword">class</span> <span class="token class-name">Joke</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>PureComponent</span> <span class="token punctuation">{</span>\n  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">return</span> <span class="token punctuation">(</span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\n        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>SmileFace<span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">\n        </span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>value <span class="token operator">||</span> <span class="token string">\'loading...\'</span><span class="token punctuation">}</span><span class="token plain-text">\n      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n    <span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>值得一提的是，PureComponent 中 shouldComponentUpdate 对 props 做得只是浅层比较，不是深层比较，如果 props 是一个深层对象，就容易产生问题。</p>\n<h3 id="reactmemo"><a href="#reactmemo" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>React.memo</h3>\n<p>如果你使用 React v16.6.0 之后的版本，可以使用一个新功能 React.memo 来完美实现 React 组件，而不需要用 class，上面的 Joke 组件可以这么写：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="664439645561865100"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`const Joke = React.memo(() => (\n  <div>\n    <img src={SmileFace} />\n    {this.props.value || \'loading...\'}\n  </div>\n));`, `664439645561865100`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="jsx"><pre style="counter-reset: linenumber NaN" class="language-jsx line-numbers"><code class="language-jsx"><span class="token keyword">const</span> Joke <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">memo</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\n    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>SmileFace<span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">\n    </span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>value <span class="token operator">||</span> <span class="token string">\'loading...\'</span><span class="token punctuation">}</span><span class="token plain-text">\n  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2 id="高阶组件"><a href="#%E9%AB%98%E9%98%B6%E7%BB%84%E4%BB%B6" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>高阶组件</h2>\n<h3 id="基本形式"><a href="#%E5%9F%BA%E6%9C%AC%E5%BD%A2%E5%BC%8F" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>基本形式</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="11915730495917187000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`const withDoNothing = (Component) => {\n  const NewComponent = (props) => {\n    return <Component {...props} />;\n  };\n  return NewComponent;\n};`, `11915730495917187000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="jsx"><pre style="counter-reset: linenumber NaN" class="language-jsx line-numbers"><code class="language-jsx"><span class="token keyword">const</span> <span class="token function-variable function">withDoNothing</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">Component</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> <span class="token function-variable function">NewComponent</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Component</span></span> <span class="token spread"><span class="token punctuation">{</span><span class="token punctuation">...</span><span class="token attr-value">props</span><span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">;</span>\n  <span class="token keyword">return</span> NewComponent<span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="基本思路"><a href="#%E5%9F%BA%E6%9C%AC%E6%80%9D%E8%B7%AF" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>基本思路</h3>\n<ol>\n<li>高阶组件不能去修改作为参数的组件，高阶组件必须是一个纯函数，不应该有任何副作用。</li>\n<li>高阶组件返回的结果必须是一个新的 React 组件，这个新的组件的 JSX 部分肯定会包含作为参数的组件。</li>\n<li>高阶组件一般需要把传给自己的 props 转手传递给作为参数的组件。</li>\n</ol>\n<h3 id="用高阶组件抽取共同逻辑"><a href="#%E7%94%A8%E9%AB%98%E9%98%B6%E7%BB%84%E4%BB%B6%E6%8A%BD%E5%8F%96%E5%85%B1%E5%90%8C%E9%80%BB%E8%BE%91" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>用高阶组件抽取共同逻辑</h3>\n<p>接下来，我们对 withDoNothing 进行一些改进，让它实现“只有在登录时才显示”这个功能。</p>\n<p>假设我们已经有一个函数 getUserId 能够从 cookies 中读取登录用户的 ID，如果用户未登录，这个 getUserId 就返回空，那么“退出登录按钮“就需要这么写：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="76245171730734860000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`const LogoutButton = () => {\n  if (getUserId()) {\n    return ...; // 显示”退出登录“的JSX\n  } else {\n    return null;\n  }\n};`, `76245171730734860000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="jsx"><pre style="counter-reset: linenumber NaN" class="language-jsx line-numbers"><code class="language-jsx"><span class="token keyword">const</span> <span class="token function-variable function">LogoutButton</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">getUserId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">return</span> <span class="token operator">...</span><span class="token punctuation">;</span> <span class="token comment">// 显示”退出登录“的JSX</span>\n  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n    <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>同样，购物车的代码就是这样：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="369031121406759900"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`const ShoppintCart = () => {\n  if (getUserId()) {\n    return ...; // 显示”购物车“的JSX\n  } else {\n    return null;\n  }\n};`, `369031121406759900`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="jsx"><pre style="counter-reset: linenumber NaN" class="language-jsx line-numbers"><code class="language-jsx"><span class="token keyword">const</span> <span class="token function-variable function">ShoppintCart</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">getUserId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">return</span> <span class="token operator">...</span><span class="token punctuation">;</span> <span class="token comment">// 显示”购物车“的JSX</span>\n  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n    <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>上面两个组件明显有重复的代码，我们可以把重复代码抽取出来，形成 withLogin 这个高阶组件，代码如下：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="40253040941260700000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`const withLogin = (Component) => {\n  const NewComponent = (props) => {\n    if (getUserId()) {\n      return <Component {...props} />;\n    } else {\n      return null;\n    }\n  };\n\n  return NewComponent;\n};`, `40253040941260700000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="jsx"><pre style="counter-reset: linenumber NaN" class="language-jsx line-numbers"><code class="language-jsx"><span class="token keyword">const</span> <span class="token function-variable function">withLogin</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">Component</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> <span class="token function-variable function">NewComponent</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">getUserId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Component</span></span> <span class="token spread"><span class="token punctuation">{</span><span class="token punctuation">...</span><span class="token attr-value">props</span><span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n      <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n  <span class="token keyword">return</span> NewComponent<span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>如此一来，我们就只需要这样定义 LogoutButton 和 ShoppintCart：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="98734850994947300000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`const LogoutButton = withLogin((props) => {\n  return ...; // 显示”退出登录“的JSX\n});\n\nconst ShoppingCart = withLogin(() => {\n  return ...; // 显示”购物车“的JSX\n});`, `98734850994947300000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="jsx"><pre style="counter-reset: linenumber NaN" class="language-jsx line-numbers"><code class="language-jsx"><span class="token keyword">const</span> LogoutButton <span class="token operator">=</span> <span class="token function">withLogin</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">return</span> <span class="token operator">...</span><span class="token punctuation">;</span> <span class="token comment">// 显示”退出登录“的JSX</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> ShoppingCart <span class="token operator">=</span> <span class="token function">withLogin</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">return</span> <span class="token operator">...</span><span class="token punctuation">;</span> <span class="token comment">// 显示”购物车“的JSX</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="高阶组件的高级用法"><a href="#%E9%AB%98%E9%98%B6%E7%BB%84%E4%BB%B6%E7%9A%84%E9%AB%98%E7%BA%A7%E7%94%A8%E6%B3%95" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>高阶组件的高级用法</h3>\n<p>高阶组件只需要返回一个 React 组件即可，没人规定高阶组件只能接受一个 React 组件作为参数，完全可以传入多个 React 组件给高阶组件。</p>\n<p>比如，我们可以改进上面的 withLogin，让它接受两个 React 组件，根据用户是否登录选择渲染合适的组件。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="85132059543747720000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`const withLoginAndLogout = (ComponentForLogin, ComponentForLogout) => {\n  const NewComponent = (props) => {\n    if (getUserId()) {\n      return <ComponentForLogin {...props} />;\n    } else {\n      return <ComponentForLogout {...props} />;\n    }\n  };\n  return NewComponent;\n};`, `85132059543747720000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="jsx"><pre style="counter-reset: linenumber NaN" class="language-jsx line-numbers"><code class="language-jsx"><span class="token keyword">const</span> <span class="token function-variable function">withLoginAndLogout</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">ComponentForLogin<span class="token punctuation">,</span> ComponentForLogout</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> <span class="token function-variable function">NewComponent</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">getUserId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ComponentForLogin</span></span> <span class="token spread"><span class="token punctuation">{</span><span class="token punctuation">...</span><span class="token attr-value">props</span><span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n      <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ComponentForLogout</span></span> <span class="token spread"><span class="token punctuation">{</span><span class="token punctuation">...</span><span class="token attr-value">props</span><span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span><span class="token punctuation">;</span>\n  <span class="token keyword">return</span> NewComponent<span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>有了上面的 withLoginAndLogout，就可以产生根据用户登录状态显示不同的内容。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="59472784506686720000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`const TopButtons = withLoginAndLogout(LogoutButton, LoginButton);`, `59472784506686720000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="jsx"><pre style="counter-reset: linenumber NaN" class="language-jsx line-numbers"><code class="language-jsx"><span class="token keyword">const</span> TopButtons <span class="token operator">=</span> <span class="token function">withLoginAndLogout</span><span class="token punctuation">(</span>LogoutButton<span class="token punctuation">,</span> LoginButton<span class="token punctuation">)</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span></span></pre></div>\n<h3 id="链式调用高阶组件"><a href="#%E9%93%BE%E5%BC%8F%E8%B0%83%E7%94%A8%E9%AB%98%E9%98%B6%E7%BB%84%E4%BB%B6" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>链式调用高阶组件</h3>\n<p>高阶组件最巧妙的一点，是可以链式调用。</p>\n<p>假设，你有三个高阶组件分别是 withOne、withTwo 和 withThree，那么，如果要赋予一个组件 X 某个高阶组件的超能力，那么，你要做的就是挨个使用高阶组件包装，代码如下：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="13066957878989527000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`const X1 = withOne(X);\nconst X2 = withTwo(X1);\nconst X3 = withThree(X2);\nconst SuperX = X3; //最终的SuperX具备三个高阶组件的超能力`, `13066957878989527000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="jsx"><pre style="counter-reset: linenumber NaN" class="language-jsx line-numbers"><code class="language-jsx"><span class="token keyword">const</span> <span class="token constant">X1</span> <span class="token operator">=</span> <span class="token function">withOne</span><span class="token punctuation">(</span><span class="token constant">X</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> <span class="token constant">X2</span> <span class="token operator">=</span> <span class="token function">withTwo</span><span class="token punctuation">(</span><span class="token constant">X1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> <span class="token constant">X3</span> <span class="token operator">=</span> <span class="token function">withThree</span><span class="token punctuation">(</span><span class="token constant">X2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> SuperX <span class="token operator">=</span> <span class="token constant">X3</span><span class="token punctuation">;</span> <span class="token comment">//最终的SuperX具备三个高阶组件的超能力</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>\n<p>很自然，我们可以避免使用中间变量 X1 和 X2，直接连续调用高阶组件，如下：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="81839176398434450000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`const SuperX = withThree(withTwo(withOne(X)));`, `81839176398434450000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="jsx"><pre style="counter-reset: linenumber NaN" class="language-jsx line-numbers"><code class="language-jsx"><span class="token keyword">const</span> SuperX <span class="token operator">=</span> <span class="token function">withThree</span><span class="token punctuation">(</span><span class="token function">withTwo</span><span class="token punctuation">(</span><span class="token function">withOne</span><span class="token punctuation">(</span><span class="token constant">X</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span></span></pre></div>\n<p>对于 X 而言，它被高阶组件包装了，至于被一个高阶组件包装，还是被 N 个高阶组件包装，没有什么差别。而高阶组件本身就是一个纯函数，纯函数是可以组合使用的，所以，我们其实可以把多个高阶组件组合为一个高阶组件，然后用这一个高阶组件去包装 X，代码如下：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="24788371244307460000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`const hoc = compose(\n  withThree,\n  withTwo,\n  withOne\n);\nconst SuperX = hoc(X);`, `24788371244307460000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="jsx"><pre style="counter-reset: linenumber NaN" class="language-jsx line-numbers"><code class="language-jsx"><span class="token keyword">const</span> hoc <span class="token operator">=</span> <span class="token function">compose</span><span class="token punctuation">(</span>\n  withThree<span class="token punctuation">,</span>\n  withTwo<span class="token punctuation">,</span>\n  withOne\n<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> SuperX <span class="token operator">=</span> <span class="token function">hoc</span><span class="token punctuation">(</span><span class="token constant">X</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>在上面代码中使用的 compose，是函数式编程中很基础的一种方法，作用就是把多个函数组合为一个函数，在很多开源的代码库中都可以看到，下面是一个参考实现：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="98392706670821600000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`export default function compose(...funcs) {\n  if (funcs.length === 0) {\n    return (arg) => arg;\n  }\n\n  if (funcs.length === 1) {\n    return funcs[0];\n  }\n\n  return funcs.reduce((a, b) => (...args) => a(b(...args)));\n}`, `98392706670821600000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="jsx"><pre style="counter-reset: linenumber NaN" class="language-jsx line-numbers"><code class="language-jsx"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">compose</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>funcs</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token keyword">if</span> <span class="token punctuation">(</span>funcs<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token parameter">arg</span><span class="token punctuation">)</span> <span class="token operator">=></span> arg<span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n\n  <span class="token keyword">if</span> <span class="token punctuation">(</span>funcs<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">return</span> funcs<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n\n  <span class="token keyword">return</span> funcs<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token function">b</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>React 组件可以当做积木一样组合使用，现在有了 compose，我们就可以把高阶组件也当做积木一样组合，进一步重用代码。</p>\n<p>假如一个应用中多个组件都需要同样的多个高阶组件包装，那就可以用 compose 组合这些高阶组件为一个高阶组件，这样在使用多个高阶组件的地方实际上就只需要使用一个高阶组件了。</p>\n<h3 id="不要滥用高阶组件"><a href="#%E4%B8%8D%E8%A6%81%E6%BB%A5%E7%94%A8%E9%AB%98%E9%98%B6%E7%BB%84%E4%BB%B6" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>不要滥用高阶组件</h3>\n<p>高阶组件虽然可以用一种可重用的方式扩充现有 React 组件的功能，但高阶组件并不是绝对完美的。</p>\n<p>首先，高阶组件不得不处理 displayName，不然 debug 会很痛苦。当 React 渲染出错的时候，靠组件的 displayName 静态属性来判断出错的组件类，而高阶组件总是创造一个新的 React 组件类，所以，每个高阶组件都需要处理一下 displayName。</p>\n<p>如果要做一个最简单的什么增强功能都没有的高阶组件，也必须要写下面这样的代码：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="17761584609922142000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`const withExample = (Component) => {\n  const NewComponent = (props) => {\n    return <Component {...props} />;\n  };\n\n  NewComponent.displayName = \\`withExample(\\${Component.displayName || Component.name || \'Component\'})\\`;\n\n  return NewCompoennt;\n};`, `17761584609922142000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="jsx"><pre style="counter-reset: linenumber NaN" class="language-jsx line-numbers"><code class="language-jsx"><span class="token keyword">const</span> <span class="token function-variable function">withExample</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">Component</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> <span class="token function-variable function">NewComponent</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Component</span></span> <span class="token spread"><span class="token punctuation">{</span><span class="token punctuation">...</span><span class="token attr-value">props</span><span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n  NewComponent<span class="token punctuation">.</span>displayName <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">withExample(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>Component<span class="token punctuation">.</span>displayName <span class="token operator">||</span> Component<span class="token punctuation">.</span>name <span class="token operator">||</span> <span class="token string">\'Component\'</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>\n\n  <span class="token keyword">return</span> NewCompoennt<span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>每个高阶组件都这么写，就会非常的麻烦。</p>\n<p>对于 React 生命周期函数，高阶组件不用怎么特殊处理，但是，如果内层组件包含定制的静态函数，这些静态函数的调用在 React 生命周期之外，那么高阶组件就必须要在新产生的组件中增加这些静态函数的支持，这更加麻烦。</p>\n<p>其次，高阶组件支持嵌套调用，这是它的优势。但是如果真的一大长串高阶组件被应用的话，当组件出错，你看到的会是一个超深的 stack trace，十分痛苦。</p>\n<p>最后，使用高阶组件，一定要非常小心，要避免重复产生 React 组件，比如，下面的代码是有问题的：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="72071618437053340000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`const Example = () => {\n  const EnhancedFoo = withExample(Foo);\n  return <EnhancedFoo />;\n};`, `72071618437053340000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="jsx"><pre style="counter-reset: linenumber NaN" class="language-jsx line-numbers"><code class="language-jsx"><span class="token keyword">const</span> <span class="token function-variable function">Example</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> EnhancedFoo <span class="token operator">=</span> <span class="token function">withExample</span><span class="token punctuation">(</span>Foo<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">EnhancedFoo</span></span> <span class="token punctuation">/></span></span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>\n<p>像上面这样写，每一次渲染 Example，都会用高阶组件产生一个新的组件，虽然都叫做 EnhancedFoo，但是对 React 来说是一个全新的东西，在重新渲染的时候不会重用之前的虚拟 DOM，会造成极大的浪费。</p>\n<p>正确的写法是下面这样，自始至终只有一个 EnhancedFoo 组件类被创建：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="48299884269579650000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`const EnhancedFoo = withExample(Foo);\n\nconst Example = () => {\n  return <EnhancedFoo />;\n};`, `48299884269579650000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="jsx"><pre style="counter-reset: linenumber NaN" class="language-jsx line-numbers"><code class="language-jsx"><span class="token keyword">const</span> EnhancedFoo <span class="token operator">=</span> <span class="token function">withExample</span><span class="token punctuation">(</span>Foo<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> <span class="token function-variable function">Example</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">EnhancedFoo</span></span> <span class="token punctuation">/></span></span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>总之，高阶组件是重用代码的一种方式，但并不是唯一方式，在下一小节，我们会介绍一种更加精妙的方式。</p>\n<p>以上更新于<code class="language-text">2019-3-19 21:09:53</code></p>\n<hr>\n<h2 id="render-props-模式"><a href="#render-props-%E6%A8%A1%E5%BC%8F" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>render props 模式</h2>\n<p>所谓 render props，指的是让 React 组件的 props 支持函数这种模式。因为作为 props 传入的函数往往被用来渲染一部分界面，所以这种模式被称为 render props。</p>\n<p>一个最简单的 render props 组件 RenderAll，代码如下：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="66658331404070760000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`const RenderAll = (props) => {\n  return <React.Fragment>{props.children(props)}</React.Fragment>;\n};`, `66658331404070760000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="jsx"><pre style="counter-reset: linenumber NaN" class="language-jsx line-numbers"><code class="language-jsx"><span class="token keyword">const</span> <span class="token function-variable function">RenderAll</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">React.Fragment</span></span><span class="token punctuation">></span></span><span class="token punctuation">{</span>props<span class="token punctuation">.</span><span class="token function">children</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">React.Fragment</span></span><span class="token punctuation">></span></span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<p>这个 RenderAll 预期子组件是一个函数，它所做的事情就是把子组件当做函数调用，调用参数就是传入的 props，然后把返回结果渲染出来，除此之外什么事情都没有做。</p>\n<p>使用 RenderAll 的代码如下：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="6995309830894047000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`<RenderAll>{() => <h1>hello world</h1>}</RenderAll>`, `6995309830894047000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="jsx"><pre style="counter-reset: linenumber NaN" class="language-jsx line-numbers"><code class="language-jsx"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">RenderAll</span></span><span class="token punctuation">></span></span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">hello world</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">RenderAll</span></span><span class="token punctuation">></span></span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span></span></pre></div>\n<p>可以看到，RenderAll 的子组件，也就是夹在 RenderAll 标签之间的部分，其实是一个函数。这个函数渲染出 <code class="language-text">&lt;h1&gt;hello world&lt;/h1&gt;</code>，这就是上面使用 RenderAll 渲染出来的结果。</p>\n<p>当然，这个 RenderAll 没做任何实际工作，接下来我们看 render props 真正强悍的使用方法。</p>\n<h3 id="传递-props"><a href="#%E4%BC%A0%E9%80%92-props" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>传递 props</h3>\n<p>和高阶组件一样，render props 可以做很多的定制功能，我们还是以根据是否登录状态来显示一些界面元素为例，来实现一个 render props。</p>\n<p>下面是实现 render props 的 Login 组件，可以看到，render props 和高阶组件的第一个区别，就是 render props 是真正的 React 组件，而不是一个返回 React 组件的函数。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="85363715520765510000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`const Login = (props) => {\n  const userName = getUserName();\n\n  if (userName) {\n    const allProps = { userName, ...props };\n    return <React.Fragment>{props.children(allProps)}</React.Fragment>;\n  } else {\n    return null;\n  }\n};`, `85363715520765510000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="jsx"><pre style="counter-reset: linenumber NaN" class="language-jsx line-numbers"><code class="language-jsx"><span class="token keyword">const</span> <span class="token function-variable function">Login</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> userName <span class="token operator">=</span> <span class="token function">getUserName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n  <span class="token keyword">if</span> <span class="token punctuation">(</span>userName<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">const</span> allProps <span class="token operator">=</span> <span class="token punctuation">{</span> userName<span class="token punctuation">,</span> <span class="token operator">...</span>props <span class="token punctuation">}</span><span class="token punctuation">;</span>\n    <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">React.Fragment</span></span><span class="token punctuation">></span></span><span class="token punctuation">{</span>props<span class="token punctuation">.</span><span class="token function">children</span><span class="token punctuation">(</span>allProps<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">React.Fragment</span></span><span class="token punctuation">></span></span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n    <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>当用户处于登录状态，getUserName 返回当前用户名，否则返回空，然后我们根据这个结果决定是否渲染 props.children 返回的结果。</p>\n<p>当然，render props 完全可以决定哪些 props 可以传递给 props.children，在 Login 中，我们把 userName 作为增加的 props 传递给下去，这样就是 Login 的增强功能。</p>\n<p>一个使用上面 Login 的 JSX 代码示例如下：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="17855326329973352000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`<Login>{({ userName }) => <h1>Hello {userName}</h1>}</Login>`, `17855326329973352000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="jsx"><pre style="counter-reset: linenumber NaN" class="language-jsx line-numbers"><code class="language-jsx"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Login</span></span><span class="token punctuation">></span></span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> userName <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">Hello </span><span class="token punctuation">{</span>userName<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Login</span></span><span class="token punctuation">></span></span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span></span></pre></div>\n<p>对于名为<code class="language-text">程墨Morgan</code>的用户登录，上面的 JSX 会产生 <code class="language-text">&lt;h1&gt;Hello 程墨Morgan&lt;/h1&gt;</code>。</p>\n<h3 id="不局限于-children"><a href="#%E4%B8%8D%E5%B1%80%E9%99%90%E4%BA%8E-children" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>不局限于 children</h3>\n<p>在上面的例子中，作为 render 方法的 props 就是 children，在我写的《深入浅出 React 和 Redux》中，将这种模式称为“以函数为子组件（function as child）”的模式，这可以算是 render props 的一种具体形式，也就利用 children 这个 props 来作为函数传递。</p>\n<p>实际上，render props 这个模式不必局限于 children 这一个 props，任何一个 props 都可以作为函数，也可以利用多个 props 来作为函数。</p>\n<p>我们来扩展 Login，不光在用户登录时显示一些东西，也可以定制用户没有登录时显示的东西，我们把这个组件叫做 Auth，对应代码如下：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="24174665586286182000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`const Auth = (props) => {\n  const userName = getUserName();\n\n  if (userName) {\n    const allProps = { userName, ...props };\n    return <React.Fragment>{props.login(allProps)}</React.Fragment>;\n  } else {\n    <React.Fragment>{props.nologin(props)}</React.Fragment>;\n  }\n};`, `24174665586286182000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="js"><pre style="counter-reset: linenumber NaN" class="language-js line-numbers"><code class="language-js"><span class="token keyword">const</span> <span class="token function-variable function">Auth</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> userName <span class="token operator">=</span> <span class="token function">getUserName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n  <span class="token keyword">if</span> <span class="token punctuation">(</span>userName<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">const</span> allProps <span class="token operator">=</span> <span class="token punctuation">{</span> userName<span class="token punctuation">,</span> <span class="token operator">...</span>props <span class="token punctuation">}</span><span class="token punctuation">;</span>\n    <span class="token keyword">return</span> <span class="token operator">&lt;</span>React<span class="token punctuation">.</span>Fragment<span class="token operator">></span><span class="token punctuation">{</span>props<span class="token punctuation">.</span><span class="token function">login</span><span class="token punctuation">(</span>allProps<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>React<span class="token punctuation">.</span>Fragment<span class="token operator">></span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n    <span class="token operator">&lt;</span>React<span class="token punctuation">.</span>Fragment<span class="token operator">></span><span class="token punctuation">{</span>props<span class="token punctuation">.</span><span class="token function">nologin</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>React<span class="token punctuation">.</span>Fragment<span class="token operator">></span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>使用 Auth 的话，可以分别通过 login 和 nologin 两个 props 来指定用户登录或者没登录时显示什么，用法如下：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="57272689950361125000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`<Auth login={({ userName }) => <h1>Hello {userName}</h1>} nologin={() => <h1>Please login</h1>} />`, `57272689950361125000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="js"><pre style="counter-reset: linenumber NaN" class="language-js line-numbers"><code class="language-js"><span class="token operator">&lt;</span>Auth login<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> userName <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token operator">&lt;</span>h1<span class="token operator">></span>Hello <span class="token punctuation">{</span>userName<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">></span><span class="token punctuation">}</span> nologin<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token operator">&lt;</span>h1<span class="token operator">></span>Please login<span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">></span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span></span></pre></div>\n<h3 id="依赖注入"><a href="#%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>依赖注入</h3>\n<p>render props 其实就是 React 世界中的“依赖注入”（Dependency Injection)。</p>\n<p>所谓依赖注入，指的是解决这样一个问题：逻辑 A 依赖于逻辑 B，如果让 A 直接依赖于 B，当然可行，但是 A 就没法做得通用了。依赖注入就是把 B 的逻辑以函数形式传递给 A，A 和 B 之间只需要对这个函数接口达成一致就行，如此一来，再来一个逻辑 C，也可以用一样的方法重用逻辑 A。</p>\n<p>在上面的代码示例中，Login 和 Auth 组件就是上面所说的逻辑 A，而传递给组件的函数类型 props，就是逻辑 B 和 C。</p>\n<h3 id="render-props-和高阶组件的比较"><a href="#render-props-%E5%92%8C%E9%AB%98%E9%98%B6%E7%BB%84%E4%BB%B6%E7%9A%84%E6%AF%94%E8%BE%83" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>render props 和高阶组件的比较</h3>\n<p>我们来比对一下这两种重用 React 组件逻辑的模式。</p>\n<p>首先，render props 模式的应用，就是做一个 React 组件，而高阶组件，虽然名为“组件”，其实只是一个产生 React 组件的函数。</p>\n<p>render props 不像上一小节中介绍的高阶组件有那么多毛病，如果说 render props 有什么缺点，那就是 render props 不能像高阶组件那样链式调用，当然，这并不是一个致命缺点。</p>\n<p>render props 相对于高阶组件还有一个显著优势，就是对于新增的 props 更加灵活。还是以登录状态为例，假如我们扩展 withLogin 的功能，让它给被包裹的组件传递用户名这个 props，代码如下：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="98821141129176810000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`const withLogin = (Component) => {\n  const NewComponent = (props) => {\n    const userName = getUserName();\n    if (userName) {\n      return <Component {...props} userName={userName} />;\n    } else {\n      return null;\n    }\n  };\n\n  return NewComponent;\n};`, `98821141129176810000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="jsx"><pre style="counter-reset: linenumber NaN" class="language-jsx line-numbers"><code class="language-jsx"><span class="token keyword">const</span> <span class="token function-variable function">withLogin</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">Component</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> <span class="token function-variable function">NewComponent</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    <span class="token keyword">const</span> userName <span class="token operator">=</span> <span class="token function">getUserName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">if</span> <span class="token punctuation">(</span>userName<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n      <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Component</span></span> <span class="token spread"><span class="token punctuation">{</span><span class="token punctuation">...</span><span class="token attr-value">props</span><span class="token punctuation">}</span></span> <span class="token attr-name">userName</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>userName<span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n      <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n  <span class="token keyword">return</span> NewComponent<span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>这就要求被 withLogin 包住的组件要接受 userName 这个 props。可是，假如有一个现成的 React 组件不接受 userName，却接受名为 name 的 props 作为用户名，这就麻烦了。我们就不能直接用 withLogin 包住这个 React 组件，还要再造一个组件来做 userName 到 name 的映射，十分费事。</p>\n<p>对于应用 render props 的 Login，就不存在这个问题，接受 name 不接受 userName 是吗？这样写就好了：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="61646625964940890000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`<Login>\n  {(props) => {\n    const { userName } = props;\n    return <TheComponent {...props} name={userName} />;\n  }}\n</Login>`, `61646625964940890000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="jsx"><pre style="counter-reset: linenumber NaN" class="language-jsx line-numbers"><code class="language-jsx"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Login</span></span><span class="token punctuation">></span></span><span class="token plain-text">\n  </span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n    <span class="token keyword">const</span> <span class="token punctuation">{</span> userName <span class="token punctuation">}</span> <span class="token operator">=</span> props<span class="token punctuation">;</span>\n    <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">TheComponent</span></span> <span class="token spread"><span class="token punctuation">{</span><span class="token punctuation">...</span><span class="token attr-value">props</span><span class="token punctuation">}</span></span> <span class="token attr-name">name</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>userName<span class="token punctuation">}</span></span> <span class="token punctuation">/></span></span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token plain-text">\n</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Login</span></span><span class="token punctuation">></span></span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>所以，当需要重用 React 组件的逻辑时，建议首先看这个功能是否可以抽象为一个简单的组件；如果行不通的话，考虑是否可以应用 render props 模式；再不行的话，才考虑应用高阶组件模式。</p>\n<p>这并不表示高阶组件无用武之地，在后续章节，我们会对 render props 和高阶组件分别讲解具体的实例。</p>\n<p>以上更新于 <code class="language-text">2019-3-20 15:54:08</code></p>\n<hr>\n<h2 id="提供者模式"><a href="#%E6%8F%90%E4%BE%9B%E8%80%85%E6%A8%A1%E5%BC%8F" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>提供者模式</h2>\n<h3 id="问题场景"><a href="#%E9%97%AE%E9%A2%98%E5%9C%BA%E6%99%AF" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题场景</h3>\n<p>在 React 中，props 是组件之间通讯的主要手段，但是，有一种场景单纯靠 props 来通讯是不恰当的，那就是两个组件之间间隔着多层其他组件，下面是一个简单的组件树示例图：</p>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/2019-03-20-20-47-52-1835f52a38388c2bc92e6d015b5d95df-a9fd5.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 58.90624999999999%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAA7DAAAOwwHHb6hkAAABqUlEQVQoz42STUsCQRjH/Qb1UeoLRFDQoQIv0a0P0CHCXig7BR0NClJ7OXjJ6GIZRElB5lpR4EuQSGvvpaul0ura7rzb7LomWUTDM3P4z/Ob+T/PjKX622CMMAIppaz617A0UXxSkAfnVhwZRKfdRE4YMv0HzHSYgZwW7tBOurSjNlSMsX/CGiTvZVgoAVUFBH0giBCmPDCmqoaLMigpCEKq+zPCYnrlbimbcceHZs96x4I74TRXiFEyIfq66hcH7MKAPTznudKTuci+37zmT005o7bFyEUiXzuOZ1AD9oeep13xyaX4+v7D15YOc2OZN/VRUnKFCmOsIKsPkvKUrXCrZhNZrRvVUgU+SuUnSZHL0Kz5OPbabwtZxwXrhKACPLoQtU4JncOH3kCKcwQjDmOs0/PeZJ8t2DMSnHZemvB9RlnZTi1viZ7dW0yoX3hx+UTHhhi/URrmjfpDsZzbJy5uXu+dZn6+c+PBqkCC2YCW2UOFiCmy5j9hqemUMWqsRid1i0B04EALPWiFx+1fME+i9Wjudv1I/UsgOandrWl3yyC907j5e3wCqkiS/HHREJgAAAAASUVORK5CYII=\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;"\n        alt="2019 03 20 20 47 52"\n        title=""\n        src="/static/2019-03-20-20-47-52-1835f52a38388c2bc92e6d015b5d95df-fee1c.png"\n        srcset="/static/2019-03-20-20-47-52-1835f52a38388c2bc92e6d015b5d95df-a67b7.png 200w,\n/static/2019-03-20-20-47-52-1835f52a38388c2bc92e6d015b5d95df-0b187.png 400w,\n/static/2019-03-20-20-47-52-1835f52a38388c2bc92e6d015b5d95df-fee1c.png 800w,\n/static/2019-03-20-20-47-52-1835f52a38388c2bc92e6d015b5d95df-b1a91.png 1200w,\n/static/2019-03-20-20-47-52-1835f52a38388c2bc92e6d015b5d95df-a9fd5.png 1280w"\n        sizes="(max-width: 800px) 100vw, 800px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>在上图中，组件 A 需要传递信息给组件 X，如果通过 props 的话，那么从顶部的组件 A 开始，要把 props 传递给组件 B，然后组件 B 传递给组件 D，最后组件 D 再传递给组件 X。</p>\n<p>其实组件 B 和组件 D 完全用不上这些 props，但是又被迫传递这些 props，这明显不合理，要知道组件树的结构会变化的，将来如果组件 B 和组件 D 之间再插入一层新的组件，这个组件也需要传递这个 props，这就麻烦无比。</p>\n<p>可见，对于跨级的信息传递，我们需要一个更好的方法。</p>\n<p>在 React 中，解决这个问题应用的就是“提供者模式”。</p>\n<h3 id="提供者模式-1"><a href="#%E6%8F%90%E4%BE%9B%E8%80%85%E6%A8%A1%E5%BC%8F-1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>提供者模式</h3>\n<p>虽然这个模式叫做“提供者模式”，但是其实有两个角色，一个叫“提供者”（Provider），另一个叫“消费者”（Consumer），这两个角色都是 React 组件。其中“提供者”在组件树上居于比较靠上的位置，“消费者”处于靠下的位置。在上面的组件树中，组件 A 可以作为提供者，组件 X 就是消费者。</p>\n<p>既然名为“提供者”，它可以提供一些信息，而且这些信息在它之下的所有组件，无论隔了多少层，都可以直接访问到，而不需要通过 props 层层传递。</p>\n<p>避免 props 逐级传递，即是提供者的用途。</p>\n<h3 id="如何实现提供者模式"><a href="#%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E6%8F%90%E4%BE%9B%E8%80%85%E6%A8%A1%E5%BC%8F" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>如何实现提供者模式</h3>\n<p>实现提供者模式，需要 React 的 Context 功能，可以说，提供者模式只不过是让 Context 功能更好用一些而已。</p>\n<p>所谓 Context 功能，就是能够创造一个“上下文”，在这个上下文笼罩之下的所有组件都可以访问同样的数据。</p>\n<p>在 React v16.3.0 之前，React 虽然提供了 Context 功能，但是官方文档上都建议尽量不要使用，因为对应的 API 他们并不满意，觉得迟早要废弃掉。即使如此，依然有很多库和应用使用 Context 功能，可见对这个需求的呼声有多大。</p>\n<p>当 React 发布 v16.3.0 时，终于提供了“正式版本”的 Context 功能 API，和之前的有很大不同，当然，这也带来一些问题，我在后面会介绍。</p>\n<p>提供者模式的一个典型用例就是实现“样式主题”（Theme），由顶层的提供者确定一个主题，下面的样式就可以直接使用对应主题里的样式。这样，当需要切换样式时，只需要修改提供者就行，其他组件不用修改。</p>\n<p>为了方便比对，这里我会介绍提供者模式用不同 Context API 的实现方法。不过，你如果完全不在意老版本 React 如何实现的，可以略过下面一段。</p>\n<h4 id="react-v1630-之前的提供者模式"><a href="#react-v1630-%E4%B9%8B%E5%89%8D%E7%9A%84%E6%8F%90%E4%BE%9B%E8%80%85%E6%A8%A1%E5%BC%8F" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>React v16.3.0 之前的提供者模式</h4>\n<p>在 React v16.3.0 之前，要实现提供者，就要实现一个 React 组件，不过这个组件要做两个特殊处理。</p>\n<ol>\n<li>需要实现 getChildContext 方法，用于返回“上下文”的数据；</li>\n<li>需要定义 childContextTypes 属性，声明“上下文”的结构。</li>\n</ol>\n<p>下面就是一个实现“提供者”的例子，组件名为 ThemeProvider：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="34764430323746920000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class ThemeProvider extends React.Component {\n  getChildContext() {\n    return {\n      theme: this.props.value\n    };\n  }\n\n  render() {\n    return <React.Fragment>{this.props.children}</React.Fragment>;\n  }\n}\n\nThemeProvider.childContextTypes = {\n  theme: PropTypes.object\n};`, `34764430323746920000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="jsx"><pre style="counter-reset: linenumber NaN" class="language-jsx line-numbers"><code class="language-jsx"><span class="token keyword">class</span> <span class="token class-name">ThemeProvider</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>\n  <span class="token function">getChildContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">return</span> <span class="token punctuation">{</span>\n      theme<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>value\n    <span class="token punctuation">}</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n\n  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">React.Fragment</span></span><span class="token punctuation">></span></span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>children<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">React.Fragment</span></span><span class="token punctuation">></span></span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\nThemeProvider<span class="token punctuation">.</span>childContextTypes <span class="token operator">=</span> <span class="token punctuation">{</span>\n  theme<span class="token punctuation">:</span> PropTypes<span class="token punctuation">.</span>object\n<span class="token punctuation">}</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>在上面的例子中，getChildContext 只是简单返回名为 value 的 props 值，但是，因为 getChildContext 是一个函数，它可以有更加复杂的操作，比如可以从 state 或者其他数据源获得数据。</p>\n<p>对于 ThemeProvider，我们创造了一个上下文，这个上下文就是一个对象，结构是这样：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="27917427189241106000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`{\n  &quot;theme&quot;: {\n    //一个对象\n  }\n}`, `27917427189241106000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="json"><pre style="counter-reset: linenumber NaN" class="language-json line-numbers"><code class="language-json"><span class="token punctuation">{</span>\n  <span class="token property">"theme"</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token comment">//一个对象</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>接下来，我们来做两个消费（也就是使用）这个“上下文”的组件，第一个是 Subject，代表标题；第二个是 Paragraph，代表章节。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="49816530270258030000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class Subject extends React.Component {\n  render() {\n    const { mainColor } = this.context.theme;\n    return <h1 style={{ color: mainColor }}>{this.props.children}</h1>;\n  }\n}\n\nSubject.contextTypes = {\n  theme: PropTypes.object\n};`, `49816530270258030000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="jsx"><pre style="counter-reset: linenumber NaN" class="language-jsx line-numbers"><code class="language-jsx"><span class="token keyword">class</span> <span class="token class-name">Subject</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>\n  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">const</span> <span class="token punctuation">{</span> mainColor <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>context<span class="token punctuation">.</span>theme<span class="token punctuation">;</span>\n    <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span> <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> color<span class="token punctuation">:</span> mainColor <span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>children<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\nSubject<span class="token punctuation">.</span>contextTypes <span class="token operator">=</span> <span class="token punctuation">{</span>\n  theme<span class="token punctuation">:</span> PropTypes<span class="token punctuation">.</span>object\n<span class="token punctuation">}</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>在 Subject 的 render 函数中，可以通过 this.context 访问到“上下文”数据，因为 ThemeProvider 提供的“上下文”包含 theme 字段，所以可以直接访问 this.context.theme。</p>\n<p>千万不要忘了 Subject 必须增加 contextTypes 属性，必须和 ThemeProvider 的 childContextTypes 属性一致，不然，this.context 就不会得到任何值。</p>\n<p>读者可能会问了，为什么这么麻烦呢？为什么要求“提供者”用 childContextTypes 定义一次上下文结构，又要求“消费者”再用 contextTypes 再重复定义一次呢？这不是很浪费吗？</p>\n<p>React 这么要求，是考虑到“上下文”可能会嵌套，就是一个“提供者”套着另一个“提供者”，这时候，底层的消费者组件到底消费哪一个“提供者”呢？通过这种显式的方式指定。</p>\n<p>不过，实话实说，这样的 API 设计的确麻烦了一点，难怪 React 官方在最初就不建议使用。</p>\n<p>上面的 Subject 是一个类，其实也可以把消费者实现为一个纯函数组件，只不过访问“上下文”的方式有些不同，我们用纯函数的方式实现另一个消费者 Paragraph，代码如下：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="34051192703355880000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`const Paragraph = (props, context) => {\n  const { textColor } = context.theme;\n  return <p style={{ color: textColor }}>{props.children}</p>;\n};\n\nParagraph.contextTypes = {\n  theme: PropTypes.object\n};`, `34051192703355880000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="jsx"><pre style="counter-reset: linenumber NaN" class="language-jsx line-numbers"><code class="language-jsx"><span class="token keyword">const</span> <span class="token function-variable function">Paragraph</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">props<span class="token punctuation">,</span> context</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> <span class="token punctuation">{</span> textColor <span class="token punctuation">}</span> <span class="token operator">=</span> context<span class="token punctuation">.</span>theme<span class="token punctuation">;</span>\n  <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> color<span class="token punctuation">:</span> textColor <span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token punctuation">{</span>props<span class="token punctuation">.</span>children<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n\nParagraph<span class="token punctuation">.</span>contextTypes <span class="token operator">=</span> <span class="token punctuation">{</span>\n  theme<span class="token punctuation">:</span> PropTypes<span class="token punctuation">.</span>object\n<span class="token punctuation">}</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>从上面的代码可以看到，因为 Paragraph 是一个函数形式，所以不可能访问 this.context，但是函数的第二个参数其实就是 context。</p>\n<p>当然，也不要忘了设定 Paragraph 的 contextTypes，不然参数 context 也不会是上下文。</p>\n<p>最后，我们看如何结合”提供者“和”消费者“。</p>\n<p>我们做一个组件来使用 Subject 和 Paragraph，这个组件不需要帮助传递任何 props，代码如下：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="6408260850628334000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`const Page = () => (\n  <div>\n    <Subject>这是标题</Subject>\n    <Paragraph>这是正文</Paragraph>\n  </div>\n);`, `6408260850628334000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="jsx"><pre style="counter-reset: linenumber NaN" class="language-jsx line-numbers"><code class="language-jsx"><span class="token keyword">const</span> <span class="token function-variable function">Page</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span>\n  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">\n    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Subject</span></span><span class="token punctuation">></span></span><span class="token plain-text">这是标题</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Subject</span></span><span class="token punctuation">></span></span><span class="token plain-text">\n    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Paragraph</span></span><span class="token punctuation">></span></span><span class="token plain-text">这是正文</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Paragraph</span></span><span class="token punctuation">></span></span><span class="token plain-text">\n  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>\n<span class="token punctuation">)</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>上面的组件 Page 使用了 Subject 和 Paragraph，现在我们想要定制样式主题，只需要在 Page 或者任何需要应用这个主题的组件外面包上 ThemeProvider，对应的 JSX 代码如下：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="16745110385348760000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`<ThemeProvider value={{ mainColor: \'green\', textColor: \'red\' }}>\n  <Page />\n</ThemeProvider>`, `16745110385348760000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="jsx"><pre style="counter-reset: linenumber NaN" class="language-jsx line-numbers"><code class="language-jsx"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ThemeProvider</span></span> <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> mainColor<span class="token punctuation">:</span> <span class="token string">\'green\'</span><span class="token punctuation">,</span> textColor<span class="token punctuation">:</span> <span class="token string">\'red\'</span> <span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">\n  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Page</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">\n</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">ThemeProvider</span></span><span class="token punctuation">></span></span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<p>最后，看到的效果如下：</p>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/2019-03-21-19-30-01-03aa482ec26ee66e9a862e71a0344711-ad522.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 23.57894736842105%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAi0lEQVQY042PTQoCMQyFe3Zxq6BLPcYs3YgbT+B6FsIo7WjVphlSm9Q6gvhTwZeQzePLS1T6koh0oXPkgDwQWLSRYypJvWG5UsKA1aaarKaz9Xy0HA8WQ+303eXef2lVSE7SerPH1pA90rm57EIMH9hPON+dBzea662Yw3Plf3BvRYCrPbHHxy9F+Abb/yK1aQhV2QAAAABJRU5ErkJggg==\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;"\n        alt="2019 03 21 19 30 01"\n        title=""\n        src="/static/2019-03-21-19-30-01-03aa482ec26ee66e9a862e71a0344711-fee1c.png"\n        srcset="/static/2019-03-21-19-30-01-03aa482ec26ee66e9a862e71a0344711-a67b7.png 200w,\n/static/2019-03-21-19-30-01-03aa482ec26ee66e9a862e71a0344711-0b187.png 400w,\n/static/2019-03-21-19-30-01-03aa482ec26ee66e9a862e71a0344711-fee1c.png 800w,\n/static/2019-03-21-19-30-01-03aa482ec26ee66e9a862e71a0344711-ad522.png 950w"\n        sizes="(max-width: 800px) 100vw, 800px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>当我们需要改变一个样式主题的时候，改变传给 ThemeProvider 的 value 值就搞定了。</p>\n<h4 id="react-v1630-之后的提供者模式"><a href="#react-v1630-%E4%B9%8B%E5%90%8E%E7%9A%84%E6%8F%90%E4%BE%9B%E8%80%85%E6%A8%A1%E5%BC%8F" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>React v16.3.0 之后的提供者模式</h4>\n<p>到了 React v16.3.0 的时候，新的 Context API 出来了，这套 API 毫不掩饰自己就是“提供者模式”的实现，命名上就带 “Provider” 和 “Consumer”。</p>\n<p>还是上面的样式主题的例子，首先，要用新提供的 createContext 函数创造一个“上下文”对象。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="43494104685723480000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`const ThemeContext = React.createContext();`, `43494104685723480000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="jsx"><pre style="counter-reset: linenumber NaN" class="language-jsx line-numbers"><code class="language-jsx"><span class="token keyword">const</span> ThemeContext <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span></span></pre></div>\n<p>这个“上下文”对象 ThemeContext 有两个属性，分别就是 Provider 和 Consumer。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="62345956733514465000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`const ThemeProvider = ThemeContext.Provider;\nconst ThemeConsumer = ThemeContext.Consumer;`, `62345956733514465000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="jsx"><pre style="counter-reset: linenumber NaN" class="language-jsx line-numbers"><code class="language-jsx"><span class="token keyword">const</span> ThemeProvider <span class="token operator">=</span> ThemeContext<span class="token punctuation">.</span>Provider<span class="token punctuation">;</span>\n<span class="token keyword">const</span> ThemeConsumer <span class="token operator">=</span> ThemeContext<span class="token punctuation">.</span>Consumer<span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>\n<p>创造“提供者”极大简化了，都不需要我们创造一个 React 组件类。</p>\n<p>使用“消费者”也同样简单，而且应用了上一节我们介绍的 render props 模式，比如，Subject 的代码如下:</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="28315659266217484000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class Subject extends React.Component {\n  render() {\n    return (\n      <ThemeConsumer>{(theme) => <h1 style={{ color: theme.mainColor }}>{this.props.children}</h1>}</ThemeConsumer>\n    );\n  }\n}`, `28315659266217484000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="jsx"><pre style="counter-reset: linenumber NaN" class="language-jsx line-numbers"><code class="language-jsx"><span class="token keyword">class</span> <span class="token class-name">Subject</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>\n  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">return</span> <span class="token punctuation">(</span>\n      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ThemeConsumer</span></span><span class="token punctuation">></span></span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter">theme</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span> <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> color<span class="token punctuation">:</span> theme<span class="token punctuation">.</span>mainColor <span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>children<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">ThemeConsumer</span></span><span class="token punctuation">></span></span>\n    <span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>上面的 ThemeConsumer 其实就是一个应用了 render props 模式的组件，它要求子组件是一个函数，会把“上下文”的数据作为参数传递给这个函数，而这个函数里就可以通过参数访问“上下文”对象。</p>\n<p>在新的 API 里，不需要设定组件的 childContextTypes 或者 contextTypes 属性，这省了不少事。</p>\n<p>可以注意到，Subject 没有自己的状态，没必要实现为类，我们用纯函数的形式实现 Paragraph，代码如下：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="58477711078381910000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`const Paragraph = (props, context) => {\n  return <ThemeConsumer>{(theme) => <p style={{ color: theme.textColor }}>{props.children}</p>}</ThemeConsumer>;\n};`, `58477711078381910000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="jsx"><pre style="counter-reset: linenumber NaN" class="language-jsx line-numbers"><code class="language-jsx"><span class="token keyword">const</span> <span class="token function-variable function">Paragraph</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">props<span class="token punctuation">,</span> context</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ThemeConsumer</span></span><span class="token punctuation">></span></span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter">theme</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> color<span class="token punctuation">:</span> theme<span class="token punctuation">.</span>textColor <span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token punctuation">{</span>props<span class="token punctuation">.</span>children<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">ThemeConsumer</span></span><span class="token punctuation">></span></span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<p>实现 Page 的方式并没有变化，而应用 ThemeProvider 的代码和之前也完全一样:</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="78216188807484560000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`<ThemeProvider value={{ mainColor: \'green\', textColor: \'red\' }}>\n  <Page />\n</ThemeProvider>`, `78216188807484560000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="jsx"><pre style="counter-reset: linenumber NaN" class="language-jsx line-numbers"><code class="language-jsx"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ThemeProvider</span></span> <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> mainColor<span class="token punctuation">:</span> <span class="token string">\'green\'</span><span class="token punctuation">,</span> textColor<span class="token punctuation">:</span> <span class="token string">\'red\'</span> <span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">\n  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Page</span></span> <span class="token punctuation">/></span></span><span class="token plain-text">\n</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">ThemeProvider</span></span><span class="token punctuation">></span></span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<h3 id="两种提供者模式实现方式的比较"><a href="#%E4%B8%A4%E7%A7%8D%E6%8F%90%E4%BE%9B%E8%80%85%E6%A8%A1%E5%BC%8F%E5%AE%9E%E7%8E%B0%E6%96%B9%E5%BC%8F%E7%9A%84%E6%AF%94%E8%BE%83" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>两种提供者模式实现方式的比较</h3>\n<p>通过上面的代码，可以很清楚地看到，新的 Context API 更简洁，但是也并不是十全十美。</p>\n<p>在老版 Context API 中，“上下文”只是一个概念，并不对应一个代码，两个组件之间达成一个协议，就诞生了“上下文”。</p>\n<p>在新版 Context API 中，需要一个“上下文”对象（上面的例子中就是 ThemeContext)，使用“提供者”的代码和“消费者”的代码往往分布在不同的代码文件中，那么，这个 ThemeContext 对象放在哪个代码文件中呢？</p>\n<p>最好是放在一个独立的文件中，这么一来，就多出一个代码文件，而且所有和这个“上下文”相关的代码，都要依赖于这个“上下文”代码文件，虽然这没什么大不了的，但是的确多了一层依赖关系。</p>\n<p>为了避免依赖关系复杂，每个应用都不要滥用“上下文”，应该限制“上下文”的使用个数。</p>\n<p>不管怎么说，新版本的 Context API 才是未来，在 React v17 中，可能就会删除对老版 Context API 的支持，所以，现在大家都应该使用第二种实现方式。</p>\n<h2 id="组合组件"><a href="#%E7%BB%84%E5%90%88%E7%BB%84%E4%BB%B6" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>组合组件</h2>\n<p>组合组件模式要解决的是这样一类问题：父组件想要传递一些信息给子组件，但是，如果用 props 传递又显得十分麻烦。</p>\n<p>一看到这个问题描述，读者应该能立刻想到上一节我们介绍过的 Context API，利用 Context，可以让组件之间不用 props 来传递信息。</p>\n<p>不过，使用 Context 也不是完美解法，上一节我们介绍过，使用 React 在 v16.3.0 之后提供的新的 Context API，需要让“提供者”和“消费者”共同依赖于一个 Context 对象，而且消费者也要使用 render props 模式。</p>\n<p>如果不嫌麻烦，用 Context 来解决问题当然好，但是我们肯定会想有没有更简洁的方式。</p>\n<h3 id="问题描述"><a href="#%E9%97%AE%E9%A2%98%E6%8F%8F%E8%BF%B0" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>问题描述</h3>\n<p>为了让问题更加具体，我们来解决一个实例。</p>\n<p>很多界面都有 Tab 这样的元件，我们需要一个 Tabs 组件和 TabItem 组件，Tabs 是容器，TabItem 是一个一个单独的 Tab，因为一个时刻只有一个 TabItem 被选中，很自然希望被选中的 TabItem 样式会和其他 TabItem 不同。</p>\n<p>这并不是一个很难的功能，首先我们想到的就是，用 Tabs 中一个 state 记录当前被选中的 Tabitem 序号，然后根据这个 state 传递 props 给 TabItem，当然，还要传递一个 onClick 事件进去，捕获点击选择事件。</p>\n<p>按照这样的设计，Tabs 中如果要显示 One、Two、Three 三个 TabItem，JSX 代码大致这么写：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="95563080770579090000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`<TabItem active={true} onClick={this.onClick}>One</TabItem>\n<TabItem active={false} onClick={this.onClick}>Two</TabItem>\n<TabItem active={false} onClick={this.onClick}>Three</TabItem>`, `95563080770579090000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="jsx"><pre style="counter-reset: linenumber NaN" class="language-jsx line-numbers"><code class="language-jsx"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">TabItem</span></span> <span class="token attr-name">active</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token boolean">true</span><span class="token punctuation">}</span></span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>onClick<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">One</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">TabItem</span></span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">TabItem</span></span> <span class="token attr-name">active</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token boolean">false</span><span class="token punctuation">}</span></span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>onClick<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">Two</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">TabItem</span></span><span class="token punctuation">></span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">TabItem</span></span> <span class="token attr-name">active</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token boolean">false</span><span class="token punctuation">}</span></span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>onClick<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">Three</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">TabItem</span></span><span class="token punctuation">></span></span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>\n<p>上面的 TabItem 组件接受 active 这个 props，如果 true 代表当前是选中状态，当然可以工作，但是，也存在大问题：</p>\n<ol>\n<li>每次使用 TabItem 都要传递一堆 props，好麻烦；</li>\n<li>每增加一个新的 TabItem，都要增加对应的 props，更麻烦；</li>\n<li>如果要增加 TabItem，就要去修改 Tabs 的 JSX 代码，超麻烦。</li>\n</ol>\n<p>我们不想要这么麻烦，理想情况下，我们希望可以随意增加减少 TabItem 实例，不用传递一堆 props，也不用去修改 Tabs 的代码，最好代码就这样：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="46970517186471270000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`<Tabs>\n  <TabItem>One</TabItem>\n  <TabItem>Two</TabItem>\n  <TabItem>Three</TabItem>\n</Tabs>`, `46970517186471270000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="jsx"><pre style="counter-reset: linenumber NaN" class="language-jsx line-numbers"><code class="language-jsx"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Tabs</span></span><span class="token punctuation">></span></span><span class="token plain-text">\n  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">TabItem</span></span><span class="token punctuation">></span></span><span class="token plain-text">One</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">TabItem</span></span><span class="token punctuation">></span></span><span class="token plain-text">\n  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">TabItem</span></span><span class="token punctuation">></span></span><span class="token plain-text">Two</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">TabItem</span></span><span class="token punctuation">></span></span><span class="token plain-text">\n  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">TabItem</span></span><span class="token punctuation">></span></span><span class="token plain-text">Three</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">TabItem</span></span><span class="token punctuation">></span></span><span class="token plain-text">\n</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Tabs</span></span><span class="token punctuation">></span></span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>如果能像上面一样写代码，那就达到目的了。</p>\n<p>像上面这样，Tabs 和 TabItem 不通过表面的 props 传递也能心有灵犀，二者之间有某种神秘的“组合”，就是我们所说的“组合组件”。</p>\n<h3 id="实现方式"><a href="#%E5%AE%9E%E7%8E%B0%E6%96%B9%E5%BC%8F" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>实现方式</h3>\n<p>上面我们说过，利用 Context API，可以实现组合组件，但是那样 TabItem 需要应用 render props，至于如何实现，读者可以参照上一节的介绍自己尝试。</p>\n<p>在这里，我们用一种更巧妙的方式来实现组合组件，可以避免 TabItem 的复杂化。</p>\n<p>我们先写出 TabItem 的代码，如下：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="6776300611026609000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`const TabItem = (props) => {\n  const { active, onClick } = props;\n  const tabStyle = {\n    \'max-width\': \'150px\',\n    color: active ? \'red\' : \'green\',\n    border: active ? \'1px red solid\' : \'0px\'\n  };\n  return (\n    <h1 style={tabStyle} onClick={onClick}>\n      {props.children}\n    </h1>\n  );\n};`, `6776300611026609000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="jsx"><pre style="counter-reset: linenumber NaN" class="language-jsx line-numbers"><code class="language-jsx"><span class="token keyword">const</span> <span class="token function-variable function">TabItem</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n  <span class="token keyword">const</span> <span class="token punctuation">{</span> active<span class="token punctuation">,</span> onClick <span class="token punctuation">}</span> <span class="token operator">=</span> props<span class="token punctuation">;</span>\n  <span class="token keyword">const</span> tabStyle <span class="token operator">=</span> <span class="token punctuation">{</span>\n    <span class="token string">\'max-width\'</span><span class="token punctuation">:</span> <span class="token string">\'150px\'</span><span class="token punctuation">,</span>\n    color<span class="token punctuation">:</span> active <span class="token operator">?</span> <span class="token string">\'red\'</span> <span class="token punctuation">:</span> <span class="token string">\'green\'</span><span class="token punctuation">,</span>\n    border<span class="token punctuation">:</span> active <span class="token operator">?</span> <span class="token string">\'1px red solid\'</span> <span class="token punctuation">:</span> <span class="token string">\'0px\'</span>\n  <span class="token punctuation">}</span><span class="token punctuation">;</span>\n  <span class="token keyword">return</span> <span class="token punctuation">(</span>\n    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span> <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>tabStyle<span class="token punctuation">}</span></span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>onClick<span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">\n      </span><span class="token punctuation">{</span>props<span class="token punctuation">.</span>children<span class="token punctuation">}</span><span class="token plain-text">\n    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>\n  <span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>TabItem 有两个重要的 props：active 代表自己是否被激活，onClick 是自己被点击时应该调用的回调函数，这就足够了。TabItem 所做的就是根据这两个 props 渲染出 props.children，没有任何复杂逻辑，是一个活脱脱的“傻瓜组件”，所以，用一个纯函数实现就可以了。</p>\n<p>接下来要做的，就看 Tabs 如何把 active 和 onClick 传递给 TabItem。</p>\n<p>我们再来看一下使用组合组件的 JSX 代码：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="58610283149724520000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`<Tabs>\n  <TabItem>One</TabItem>\n  <TabItem>Two</TabItem>\n  <TabItem>Three</TabItem>\n</Tabs>`, `58610283149724520000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="jsx"><pre style="counter-reset: linenumber NaN" class="language-jsx line-numbers"><code class="language-jsx"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Tabs</span></span><span class="token punctuation">></span></span><span class="token plain-text">\n  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">TabItem</span></span><span class="token punctuation">></span></span><span class="token plain-text">One</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">TabItem</span></span><span class="token punctuation">></span></span><span class="token plain-text">\n  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">TabItem</span></span><span class="token punctuation">></span></span><span class="token plain-text">Two</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">TabItem</span></span><span class="token punctuation">></span></span><span class="token plain-text">\n  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">TabItem</span></span><span class="token punctuation">></span></span><span class="token plain-text">Three</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">TabItem</span></span><span class="token punctuation">></span></span><span class="token plain-text">\n</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Tabs</span></span><span class="token punctuation">></span></span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>没有 props 的传递啊，怎么悄无声息地把 active 和 onClick 传递给 TabItem 呢？</p>\n<p>Tabs 虽然可以访问到作为 props 的 children，但是到手的 children 已经是创造好的元素，而且是不可改变的，Tabs 是不可能把创造好的元素再强塞给 children 的。</p>\n<p>怎么办？</p>\n<p>办法还是有的，如果 Tabs 并不去渲染 children，而是把 children 拷贝一份，就有机会去篡改这份拷贝，最后渲染这份拷贝就好了。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="79019704056809600000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class Tabs extends React.Component {\n  state = {\n    activeIndex: 0\n  };\n\n  render() {\n    const newChildren = React.Children.map(this.props.children, (child, index) => {\n      if (child.type) {\n        return React.cloneElement(child, {\n          active: this.state.activeIndex === index,\n          onClick: () => this.setState({ activeIndex: index })\n        });\n      } else {\n        return child;\n      }\n    });\n\n    return <Fragment>{newChildren}</Fragment>;\n  }\n}`, `79019704056809600000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="jsx"><pre style="counter-reset: linenumber NaN" class="language-jsx line-numbers"><code class="language-jsx"><span class="token keyword">class</span> <span class="token class-name">Tabs</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>\n  state <span class="token operator">=</span> <span class="token punctuation">{</span>\n    activeIndex<span class="token punctuation">:</span> <span class="token number">0</span>\n  <span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">const</span> newChildren <span class="token operator">=</span> React<span class="token punctuation">.</span>Children<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>children<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">child<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n      <span class="token keyword">if</span> <span class="token punctuation">(</span>child<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> React<span class="token punctuation">.</span><span class="token function">cloneElement</span><span class="token punctuation">(</span>child<span class="token punctuation">,</span> <span class="token punctuation">{</span>\n          active<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>activeIndex <span class="token operator">===</span> index<span class="token punctuation">,</span>\n          <span class="token function-variable function">onClick</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> activeIndex<span class="token punctuation">:</span> index <span class="token punctuation">}</span><span class="token punctuation">)</span>\n        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> child<span class="token punctuation">;</span>\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Fragment</span></span><span class="token punctuation">></span></span><span class="token punctuation">{</span>newChildren<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Fragment</span></span><span class="token punctuation">></span></span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>在 render 函数中，我们用了 React 中不常用的两个 API：</p>\n<ol>\n<li>React.Children.map</li>\n<li>React.cloneElement</li>\n</ol>\n<p>使用 React.Children.map，可以遍历 children 中所有的元素，因为 children 可能是一个数组嘛。</p>\n<p>使用 React.cloneElement 可以复制某个元素。这个函数第一个参数就是被复制的元素，第二个参数可以增加新产生元素的 props，我们就是利用这个机会，把 active 和 onClick 添加了进去。</p>\n<p>这两个 API 双剑合璧，就能实现不通过表面的 props 传递，完成两个组件的“组合”。</p>\n<p>最终的效果如下：</p>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/2019-03-21-19-58-17-4735348425806547bce8130f92ae8b7c-088ba.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 390px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 98.97435897435896%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAIAAAAC64paAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAB70lEQVQ4y5VUW08TURDeP6l/wmcfTIwPhosPKvqAKKImSOID8ELQYgEjjQRIaGkxxCJUWre79OxuL6Tt7p7brGe6tLTdpY0nXyYnZ+abnZnzndWCyAKA0EqQCGUCCOKWFntaqpVqbr2X6LalRb95Zp+tHK+u5Ja/5pMZI/v9fKfm1mITDZBVkcpmypn1k/UXqZevfsxNJCfvLN7NGbmed3zZR+WjUv1vm7adlp23Tj3uh5WNJ4fjGdXrMFmN1Kc9cNcVnid9X1nuuWpz7fJ84LyP3BkD0w1qXjLLZsRihDCneoNGg9kOq5COy6J/ikF3cl2yUZFCqoEoCOLQ1+/5zxPp+bLZEsSWlKELcGIqMhBykGwqskA3gODc+7RMV9da9+63Hzx2J5/Sz0kkcySpyAi5bHZ8EPLZeUEapr+2wdJZuvmN/y4gWSCJ6maEbFTUKbskKjGCOIzYvHHFqnVmOQhDnRMMK+q9m9Ci9yRx9AKTSiwFNzBa27e4ATUJA9rsi9SGhH1RvfjyK5HW0x5zsR3BOs8LYl+INiSscsP4cLi4cPBueuvJx8Ol56mZN3vzz3Zm9osHUXkP99z0m7vF/Yyefbu3kMhvzO7OTW1PP0w8ShVS48mhqqGrbeiO67r3QWijpX/zD4Hgv8kx9fThH5Qne+7jnNbeAAAAAElFTkSuQmCC\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;"\n        alt="2019 03 21 19 58 17"\n        title=""\n        src="/static/2019-03-21-19-58-17-4735348425806547bce8130f92ae8b7c-088ba.png"\n        srcset="/static/2019-03-21-19-58-17-4735348425806547bce8130f92ae8b7c-265d0.png 200w,\n/static/2019-03-21-19-58-17-4735348425806547bce8130f92ae8b7c-088ba.png 390w"\n        sizes="(max-width: 390px) 100vw, 390px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>点击任何一个 TabItem，其样式就会立刻改变。而维护哪个 TabItem 是当前选中的状态，则是 Tabs 的责任。</p>\n<h3 id="实际应用"><a href="#%E5%AE%9E%E9%99%85%E5%BA%94%E7%94%A8" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>实际应用</h3>\n<p>从上面的代码可以看出来，对于组合组件这种实现方式，TabItem 非常简化；Tabs 稍微麻烦了一点，但是好处就是把复杂度都封装起来了，从使用者角度，连 props 都看不见。</p>\n<p>所以，应用组合组件的往往是共享组件库，把一些常用的功能封装在组件里，让应用层直接用就行。在 antd 和 bootstrap 这样的共享库中，都使用了组合组件这种模式。</p>\n<p>如果你的某两个组件并不需要重用，那么就要谨慎使用组合组件模式，毕竟这让代码复杂了一些。</p>\n<p>以上更新于 <code class="language-text">2019-3-21 21:27:09</code></p>\n<hr>',
id:"/github/workspace/blog/React设计模式与最佳实践/index.md absPath of file >>> MarkdownRemark",timeToRead:16,frontmatter:{date:"2019-03-19 20:18:18",path:"/react-design-pattern/",tags:"前端, 设计模式, React",title:"React设计模式与最佳实践",draft:null}},{excerpt:"模板方法模式(Template Method) 定义一个操作中的算法的骨架，而将一些步骤延迟到子类中。TemplateMethod 使得子类可以不改变一个算法的结构即可重定义该算法的某些特定步骤。 模式背景 题目抄错，会做也白搭 学生甲和学生乙的试卷类非常类似，除了答案不同，没什么区别，如果老师修改题目，…",html:'<h2 id="模板方法模式template-method"><a href="#%E6%A8%A1%E6%9D%BF%E6%96%B9%E6%B3%95%E6%A8%A1%E5%BC%8Ftemplate-method" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模板方法模式(Template Method)</h2>\n<p>定义一个操作中的算法的骨架，而将一些步骤延迟到子类中。TemplateMethod 使得子类可以不改变一个算法的结构即可重定义该算法的某些特定步骤。</p>\n<h3 id="模式背景"><a href="#%E6%A8%A1%E5%BC%8F%E8%83%8C%E6%99%AF" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式背景</h3>\n<p>题目抄错，会做也白搭</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="14378584130683270000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class TestPaperA\n{\n    //试题1\n    public void TestQuestion1()\n    {\n        Console.WriteLine(&quot; 杨过得到，后来给了郭靖，炼成倚天剑、屠龙刀的玄铁可能是[ ] a.球磨铸铁 b.马口铁 c.高速合金钢 d.碳素纤维 &quot;);\n        Console.WriteLine(&quot;答案：b&quot;);\n    }\n    //试题2\n    public void TestQuestion2()\n    {\n        Console.WriteLine(&quot; 杨过、程英、陆无双铲除了情花，造成[ ] a.使这种植物不再害人b.使一种珍稀物种灭绝 c.破坏了那个生物圈的生态平衡 d.造成该地区沙漠化  &quot;);\n        Console.WriteLine(&quot;答案：a&quot;);\n    }\n    //试题3\n    public void TestQuestion3()\n    {\n        Console.WriteLine(&quot; 蓝凤凰的致使华山师徒、桃谷六仙呕吐不止,如果你是大夫,会给他们开什么药[ ] a.阿司匹林 b.牛黄解毒片 c.氟哌酸 d.让他们喝大量的生牛奶 e.以上全不对   &quot;);\n        Console.WriteLine(&quot;答案：c&quot;);\n    }\n}\n\nclass TestPaperB\n{\n    //试题1\n    public void TestQuestion1()\n    {\n        Console.WriteLine(&quot; 杨过得到，后来给了郭靖，炼成倚天剑、屠龙刀的玄铁可能是[ ] a.球磨铸铁 b.马口铁 c.高速合金钢 d.碳素纤维 &quot;);\n        Console.WriteLine(&quot;答案：d&quot;);\n    }\n    //试题2\n    public void TestQuestion2()\n    {\n        Console.WriteLine(&quot; 杨过、程英、陆无双铲除了情花，造成[ ] a.使这种植物不再害人b.使一种珍稀物种灭绝 c.破坏了那个生物圈的生态平衡 d.造成该地区沙漠化  &quot;);\n        Console.WriteLine(&quot;答案：b&quot;);\n    }\n    //试题3\n    public void TestQuestion3()\n    {\n        Console.WriteLine(&quot; 蓝凤凰的致使华山师徒、桃谷六仙呕吐不止,如果你是大夫,会给他们开什么药[ ] a.阿司匹林 b.牛黄解毒片 c.氟哌酸 d.让他们喝大量的生牛奶 e.以上全不对   &quot;);\n        Console.WriteLine(&quot;答案：a&quot;);\n    }\n}\n\nstatic void Main(string[] args)\n{\n    Console.WriteLine(&quot;学生甲的试卷：&quot;);\n    TestPaperA studentA = new TestPaperA();\n    studentA.TestQuestion1();\n    studentA.TestQuestion2();\n    studentA.TestQuestion3();\n\n    Console.WriteLine(&quot;学生乙的试卷：&quot;);\n    TestPaperB studentB = new TestPaperB();\n    studentB.TestQuestion1();\n    studentB.TestQuestion2();\n    studentB.TestQuestion3();\n\n    Console.Read();\n}`, `14378584130683270000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">TestPaperA</span>\n<span class="token punctuation">{</span>\n    <span class="token comment">//试题1</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">TestQuestion1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">" 杨过得到，后来给了郭靖，炼成倚天剑、屠龙刀的玄铁可能是[ ] a.球磨铸铁 b.马口铁 c.高速合金钢 d.碳素纤维 "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"答案：b"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token comment">//试题2</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">TestQuestion2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">" 杨过、程英、陆无双铲除了情花，造成[ ] a.使这种植物不再害人b.使一种珍稀物种灭绝 c.破坏了那个生物圈的生态平衡 d.造成该地区沙漠化  "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"答案：a"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token comment">//试题3</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">TestQuestion3</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">" 蓝凤凰的致使华山师徒、桃谷六仙呕吐不止,如果你是大夫,会给他们开什么药[ ] a.阿司匹林 b.牛黄解毒片 c.氟哌酸 d.让他们喝大量的生牛奶 e.以上全不对   "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"答案：c"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">class</span> <span class="token class-name">TestPaperB</span>\n<span class="token punctuation">{</span>\n    <span class="token comment">//试题1</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">TestQuestion1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">" 杨过得到，后来给了郭靖，炼成倚天剑、屠龙刀的玄铁可能是[ ] a.球磨铸铁 b.马口铁 c.高速合金钢 d.碳素纤维 "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"答案：d"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token comment">//试题2</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">TestQuestion2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">" 杨过、程英、陆无双铲除了情花，造成[ ] a.使这种植物不再害人b.使一种珍稀物种灭绝 c.破坏了那个生物圈的生态平衡 d.造成该地区沙漠化  "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"答案：b"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token comment">//试题3</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">TestQuestion3</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">" 蓝凤凰的致使华山师徒、桃谷六仙呕吐不止,如果你是大夫,会给他们开什么药[ ] a.阿司匹林 b.牛黄解毒片 c.氟哌酸 d.让他们喝大量的生牛奶 e.以上全不对   "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"答案：a"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">Main</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"学生甲的试卷："</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    TestPaperA studentA <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">TestPaperA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    studentA<span class="token punctuation">.</span><span class="token function">TestQuestion1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    studentA<span class="token punctuation">.</span><span class="token function">TestQuestion2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    studentA<span class="token punctuation">.</span><span class="token function">TestQuestion3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"学生乙的试卷："</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    TestPaperB studentB <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">TestPaperB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    studentB<span class="token punctuation">.</span><span class="token function">TestQuestion1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    studentB<span class="token punctuation">.</span><span class="token function">TestQuestion2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    studentB<span class="token punctuation">.</span><span class="token function">TestQuestion3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Console<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>学生甲和学生乙的试卷类非常类似，除了答案不同，没什么区别，如果老师修改题目，2 个类都需要修改。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="60831953676201470000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class TestPaper\n{\n    //试题1\n    public void TestQuestion1()\n    {\n        Console.WriteLine(&quot; 杨过得到，后来给了郭靖，炼成倚天剑、屠龙刀的玄铁可能是[ ] a.球磨铸铁 b.马口铁 c.高速合金钢 d.碳素纤维 &quot;);\n        Console.WriteLine(&quot;答案：b&quot;);\n    }\n    //试题2\n    public void TestQuestion2()\n    {\n        Console.WriteLine(&quot; 杨过、程英、陆无双铲除了情花，造成[ ] a.使这种植物不再害人 b.使一种珍稀物种灭绝 c.破坏了那个生物圈的生态平衡 d.造成该地区沙漠化  &quot;);\n        Console.WriteLine(&quot;答案：a&quot;);\n    }\n    //试题3\n    public void TestQuestion3()\n    {\n        Console.WriteLine(&quot; 蓝凤凰的致使华山师徒、桃谷六仙呕吐不止,如果你是大夫,会给他们开什么药[ ] a.阿司匹林 b.牛黄解毒片 c.氟哌酸 d.让他们喝大量的生牛奶 e.以上全不对   &quot;);\n        Console.WriteLine(&quot;答案：c&quot;);\n    }\n}\n\nclass TestPaperA : TestPaper\n{\n    public new void TestQuestion1()\n    {\n        base.TestQuestion1();\n        Console.WriteLine(&quot;答案：c&quot;);\n    }\n\n    public new void TestQuestion2()\n    {\n        base.TestQuestion2();\n        Console.WriteLine(&quot;答案：b&quot;);\n    }\n\n    public new void TestQuestion3()\n    {\n        base.TestQuestion3();\n        Console.WriteLine(&quot;答案：a&quot;);\n    }\n}\n\nclass TestPaperB : TestPaper\n{\n    public new void TestQuestion1()\n    {\n        base.TestQuestion1();\n        Console.WriteLine(&quot;答案：d&quot;);\n    }\n\n    public new void TestQuestion2()\n    {\n        base.TestQuestion2();\n        Console.WriteLine(&quot;答案：c&quot;);\n    }\n\n    public new void TestQuestion3()\n    {\n        base.TestQuestion3();\n        Console.WriteLine(&quot;答案：a&quot;);\n    }\n}`, `60831953676201470000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">TestPaper</span>\n<span class="token punctuation">{</span>\n    <span class="token comment">//试题1</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">TestQuestion1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">" 杨过得到，后来给了郭靖，炼成倚天剑、屠龙刀的玄铁可能是[ ] a.球磨铸铁 b.马口铁 c.高速合金钢 d.碳素纤维 "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"答案：b"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token comment">//试题2</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">TestQuestion2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">" 杨过、程英、陆无双铲除了情花，造成[ ] a.使这种植物不再害人 b.使一种珍稀物种灭绝 c.破坏了那个生物圈的生态平衡 d.造成该地区沙漠化  "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"答案：a"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token comment">//试题3</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">TestQuestion3</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">" 蓝凤凰的致使华山师徒、桃谷六仙呕吐不止,如果你是大夫,会给他们开什么药[ ] a.阿司匹林 b.牛黄解毒片 c.氟哌酸 d.让他们喝大量的生牛奶 e.以上全不对   "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"答案：c"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">class</span> <span class="token class-name">TestPaperA</span> <span class="token operator">:</span> TestPaper\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> <span class="token keyword">new</span> <span class="token keyword">void</span> <span class="token function">TestQuestion1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        base<span class="token punctuation">.</span><span class="token function">TestQuestion1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"答案：c"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">public</span> <span class="token keyword">new</span> <span class="token keyword">void</span> <span class="token function">TestQuestion2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        base<span class="token punctuation">.</span><span class="token function">TestQuestion2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"答案：b"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">public</span> <span class="token keyword">new</span> <span class="token keyword">void</span> <span class="token function">TestQuestion3</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        base<span class="token punctuation">.</span><span class="token function">TestQuestion3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"答案：a"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">class</span> <span class="token class-name">TestPaperB</span> <span class="token operator">:</span> TestPaper\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> <span class="token keyword">new</span> <span class="token keyword">void</span> <span class="token function">TestQuestion1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        base<span class="token punctuation">.</span><span class="token function">TestQuestion1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"答案：d"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">public</span> <span class="token keyword">new</span> <span class="token keyword">void</span> <span class="token function">TestQuestion2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        base<span class="token punctuation">.</span><span class="token function">TestQuestion2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"答案：c"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">public</span> <span class="token keyword">new</span> <span class="token keyword">void</span> <span class="token function">TestQuestion3</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        base<span class="token punctuation">.</span><span class="token function">TestQuestion3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"答案：a"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>是不是可以进一步的优化？</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="68374253421931954000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class TestPaper\n{\n    public void TestQuestion1()\n    {\n        Console.WriteLine(&quot; 杨过得到，后来给了郭靖，炼成倚天剑、屠龙刀的玄铁可能是[ ] a.球磨铸铁 b.马口铁 c.高速合金钢 d.碳素纤维 &quot;);\n        Console.WriteLine(&quot;答案：&quot; + Answer1());\n    }\n\n    protected virtual string Answer1()\n    {\n        return &quot;&quot;;\n    }\n}\n\n//学生甲抄的试卷\nclass TestPaperA : TestPaper\n{\n    protected override string Answer1()\n    {\n        return &quot;b&quot;;\n    }\n\n    protected override string Answer2()\n    {\n        return &quot;c&quot;;\n    }\n\n    protected override string Answer3()\n    {\n        return &quot;a&quot;;\n    }\n}\n\n//学生乙抄的试卷\nclass TestPaperB : TestPaper\n{\n    protected override string Answer1()\n    {\n        return &quot;c&quot;;\n    }\n\n    protected override string Answer2()\n    {\n        return &quot;a&quot;;\n    }\n\n    protected override string Answer3()\n    {\n        return &quot;a&quot;;\n    }\n}\n\nstatic void Main(string[] args)\n{\n    Console.WriteLine(&quot;学生甲抄的试卷：&quot;);\n    TestPaper studentA = new TestPaperA();\n    studentA.TestQuestion1();\n    studentA.TestQuestion2();\n    studentA.TestQuestion3();\n\n    Console.WriteLine(&quot;学生乙抄的试卷：&quot;);\n    TestPaper studentB = new TestPaperB();\n    studentB.TestQuestion1();\n    studentB.TestQuestion2();\n    studentB.TestQuestion3();\n\n    Console.Read();\n}`, `68374253421931954000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">TestPaper</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">TestQuestion1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">" 杨过得到，后来给了郭靖，炼成倚天剑、屠龙刀的玄铁可能是[ ] a.球磨铸铁 b.马口铁 c.高速合金钢 d.碳素纤维 "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"答案："</span> <span class="token operator">+</span> <span class="token function">Answer1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">protected</span> <span class="token keyword">virtual</span> string <span class="token function">Answer1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> <span class="token string">""</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">//学生甲抄的试卷</span>\n<span class="token keyword">class</span> <span class="token class-name">TestPaperA</span> <span class="token operator">:</span> TestPaper\n<span class="token punctuation">{</span>\n    <span class="token keyword">protected</span> override string <span class="token function">Answer1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> <span class="token string">"b"</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">protected</span> override string <span class="token function">Answer2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> <span class="token string">"c"</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">protected</span> override string <span class="token function">Answer3</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> <span class="token string">"a"</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">//学生乙抄的试卷</span>\n<span class="token keyword">class</span> <span class="token class-name">TestPaperB</span> <span class="token operator">:</span> TestPaper\n<span class="token punctuation">{</span>\n    <span class="token keyword">protected</span> override string <span class="token function">Answer1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> <span class="token string">"c"</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">protected</span> override string <span class="token function">Answer2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> <span class="token string">"a"</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">protected</span> override string <span class="token function">Answer3</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> <span class="token string">"a"</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">Main</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"学生甲抄的试卷："</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    TestPaper studentA <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">TestPaperA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    studentA<span class="token punctuation">.</span><span class="token function">TestQuestion1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    studentA<span class="token punctuation">.</span><span class="token function">TestQuestion2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    studentA<span class="token punctuation">.</span><span class="token function">TestQuestion3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"学生乙抄的试卷："</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    TestPaper studentB <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">TestPaperB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    studentB<span class="token punctuation">.</span><span class="token function">TestQuestion1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    studentB<span class="token punctuation">.</span><span class="token function">TestQuestion2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    studentB<span class="token punctuation">.</span><span class="token function">TestQuestion3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Console<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="模式动机"><a href="#%E6%A8%A1%E5%BC%8F%E5%8A%A8%E6%9C%BA" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式动机</h3>\n<ul>\n<li>准备一个抽象类，将部分逻辑以具体方法以及具体构造函数的形式实现，然后声明一些抽象方法来迫使子类实现剩余的逻辑。不同的子类可以以不同的方式实现这些抽象方法，从而对剩余的逻辑有不同的实现。这就是模版方法模式的用意。</li>\n<li>很多人可能没有想到，模版方法模式实际上是所有模式中最为常见的几个模式之一，而且很多人可能使用过模版方法模式而没有意识到自己已经使用了这个模式。模版方法模式是基于继承的代码复用的基本技术，模版方法模式的结构和用法也是面向对象设计的核心。</li>\n<li>模版方法模式需要开发抽象类和具体子类的设计师之间的协作。一个设计师负责给出一个算法的轮廓和骨架，另一些设计师则负责给出这个算法的各个逻辑步骤。代表这些具体逻辑步骤的方法称做基本方法（primitive method）；而将这些基本法方法总汇起来的方法叫做模版方法（template method），这个设计模式的名字就是从此而来。</li>\n</ul>\n<h3 id="模式定义"><a href="#%E6%A8%A1%E5%BC%8F%E5%AE%9A%E4%B9%89" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式定义</h3>\n<p>定义一个操作中算法的骨架，而将一些步骤延迟到子类中。模板方法使得子类可以不改变一个算法的结构即可重定义该算法的某些特定步骤。模板方法是一种类行为型模式。</p>\n<h3 id="模式结构"><a href="#%E6%A8%A1%E5%BC%8F%E7%BB%93%E6%9E%84" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式结构</h3>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/微信截图_20180418114919-921c3fc7114a95a5c5656a2b2960d0cb-02abd.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 715px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 111.88811188811188%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAWCAYAAADAQbwGAAAACXBIWXMAABnWAAAZ1gEY0crtAAADZElEQVQ4y51US08aURRmpkkXGmkjW2OMO3Xl/3CtLjXqxk1/Q39BE7eVLhqjq5pYHhqs0UYRGZUAgiKPEQ2+8AmOCgwzt9+55TrFYtv0Jl/u65zvnnPuOcdms9kkQP4PkN7vY2NjY/r8/Dx8cnISPDw8VCKRiKKqqpJMJvm8u7ur7O3tKZlMRqF7yAWAuN/v/0D6mqbJs7OzFmE8Hk+y2igWiywajbJcLsdAyEDIjo6O+JxOpxmUmWmaXBZy30gfS9nn81mE29vbYRLM5/OVy8vL6vX1dfXq6orj+b52Vn58fGSKorhIX9d12eVyWYSxWCxCLz48PBj39/eMgDWH2BPI+hp0kg+Hwx5h4cLCgkWIWETIRcTJEG7iEQ7Eje3v77NEIsEuLi4YLCTo5XKZLPQ0tBBEUbImm80aZ2dnDC6R+zx2cJeviYiGYRisUqlwC/HYk4Vra2sWIX41RIqnp6dlkOhkAfY6PkHHb9IjOu50ZIKOX9axLxEhLP8qCFdWVupimK3FkMdKDLKK9rCIkYs06PPEGg9+F4Srq6sWodfrfR8KhT7jcBJw4tedm5ubk8vLy5/m5+cVOgsGg85AIOCEa3T/ETGdRqq8I314IU1NTdn+Onp6ejpmZmb8WDpekoF1DQ9l4NUz0KvNw8PDHfiU1y/IyIK0jnhgYEAaGxuTRkZGpNHRUWloaEiamJiQarXaQjKDg4NP9wL9/f1cf3x83NbX12f712H/02VTU1PD8+aaor21tdXe1dVl7+zstLe3t791OBztvb29Ld3d3fa2tja7kAPeEF9DNpSQ9+7uLndzc5M+Pj5WaSDfMkh0FamRzfwcKnJURdKrkEsBecoG0kezkD0ej0WIBE2I3KM8Ozg4YCBkSGQ+4xFejrQWOUgDbc0nPnVpackiRM6FqeipIlCvBhLagCUGrWkmiDM8QqhQwqOP8gIulUry3NxcnctRqga4Ydze3vL6xZoVCgVGewLtCbV79AOdwRDuJ+pbdrvdFuH6+jrvNohXFe6bcM1EvMydnR0TsTPhLp/pLJVK0V6vVqsM1eUWLqPa6rpNjCykLkMtSvRDeuRXCym+dA8LecsGsbdht9na2goi8DqsKMICDbWpYa+haWhQ4sBHaXhAgwc0F8gA3H8RhIuLi098PwCaPP3/SBo7vgAAAABJRU5ErkJggg==\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;"\n        alt="     20180418114919"\n        title=""\n        src="/static/微信截图_20180418114919-921c3fc7114a95a5c5656a2b2960d0cb-02abd.png"\n        srcset="/static/微信截图_20180418114919-921c3fc7114a95a5c5656a2b2960d0cb-c2d90.png 200w,\n/static/微信截图_20180418114919-921c3fc7114a95a5c5656a2b2960d0cb-3b989.png 400w,\n/static/微信截图_20180418114919-921c3fc7114a95a5c5656a2b2960d0cb-02abd.png 715w"\n        sizes="(max-width: 715px) 100vw, 715px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<ul>\n<li>AbstractClass：抽象类</li>\n<li>ConcreteClass：具体子类</li>\n</ul>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="41217295265654070000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`public abstract class AbstractCar\n{\n    protected abstract string StartUp();\n    protected abstract string Run();\n    protected abstract string Stop();\n\n    public void DriveOnTheRoad()\n    {\n        Console.WriteLine(StartUp());\n        Console.WriteLine(Run());\n        Console.WriteLine(Stop());\n    }\n}\npublic class BORA : AbstractCar\n{\n    protected override string StartUp()\n    {\n        return &quot;BORA is StartUp&quot;;\n    }\n\n    protected override string Run()\n    {\n        return &quot;BORA is Running&quot;;\n    }\n\n    protected override string Stop()\n    {\n        return &quot;BORA is Stoped&quot;;\n    }\n}\n\nstatic void Main(string[] args)\n{\n     AbstractCar car = new BORA();\n     car.DriveOnTheRoad();\n     Console.Read();\n}`, `41217295265654070000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp"><span class="token keyword">public</span> abstract <span class="token keyword">class</span> <span class="token class-name">AbstractCar</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">protected</span> abstract string <span class="token function">StartUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">protected</span> abstract string <span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">protected</span> abstract string <span class="token function">Stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">DriveOnTheRoad</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token function">StartUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token function">Stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BORA</span> <span class="token operator">:</span> AbstractCar\n<span class="token punctuation">{</span>\n    <span class="token keyword">protected</span> override string <span class="token function">StartUp</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> <span class="token string">"BORA is StartUp"</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">protected</span> override string <span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> <span class="token string">"BORA is Running"</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">protected</span> override string <span class="token function">Stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> <span class="token string">"BORA is Stoped"</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">Main</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n     AbstractCar car <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">BORA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n     car<span class="token punctuation">.</span><span class="token function">DriveOnTheRoad</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n     Console<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>AbstractCar 中的 DriveOnTheRoad 方法叫做 template method（模板方法），template method 用 primitive operation 定义一个算法，是相对稳定的部分。（子类中重新定义 primitive operation）。</p>\n<p>在这段代码中，抽象方法 StartUp、Run、Stop 叫做 primitive operation（原语操作），它们是在子类中的扩展点。</p>\n<h3 id="优缺点"><a href="#%E4%BC%98%E7%BC%BA%E7%82%B9" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>优缺点</h3>\n<ul>\n<li>\n<p>优点</p>\n<ul>\n<li>模板方法模式在一个类中形式化地定义算法，而由它的子类实现细节的处理。模板方法模式的优势是，在子类定义详细的处理算法时不会改变算法的结构。</li>\n<li>模板方法是一种代码复用的基本技术，它们在类库中尤为重要，它们提取了类库中的公共行为。</li>\n<li>模板方法导致一种反向的控制结构，一个父类调用一个子类的操作，而不是相反。</li>\n</ul>\n</li>\n<li>\n<p>缺点</p>\n<ul>\n<li>每个不同的实现都需要定义一个子类，这会导致类的个数增加，但是更加符合类职责的分配原则，使得类的内聚性得以提高。</li>\n</ul>\n</li>\n</ul>\n<h3 id="模式使用"><a href="#%E6%A8%A1%E5%BC%8F%E4%BD%BF%E7%94%A8" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式使用</h3>\n<ul>\n<li>一次性实现一个算法的不变的部分，并将可变的行为留给子类来实现。</li>\n<li>各子类中公共的行为应被提取出来并集中到一个公共父类中以避免代码重复。</li>\n<li>对一些复杂的算法进行分割，将其算法中固定不变的部分设计为模板方法和父类具体方法，而一些可以改变的细节由其子类来实现。</li>\n</ul>\n<h3 id="模式应用"><a href="#%E6%A8%A1%E5%BC%8F%E5%BA%94%E7%94%A8" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式应用</h3>\n<ul>\n<li>模板方法模式主要应用于框架设计，以确保父类控制处理流程的逻辑顺序（如框架的初始化）。</li>\n<li>模板方法模式鼓励我们恰当使用继承，此模式可以用来改写一些拥有相同功能的相关类，将可复用的一般性的行为代码移到父类里面，而将特殊化的行为代码移到子类里面。这也进一步说明，虽然继承复用存在一些问题，但是在某些情况下还是可以给开发人员带来方便，模板方法模式就是体现继承优势的模式之一。</li>\n<li>在模板方法模式中，子类不显式调用父类的方法，而是通过覆盖父类的方法来实现某些具体的业务逻辑，父类控制对子类的调用，这种机制被称为好莱坞原则(Hollywood Principle)，即“不要给我们打电话，我们会给你打电话(Don‘t call us, we’ll call you)”。</li>\n<li>在模板方法模式中，好莱坞原则体现在：子类不需要调用父类，而通过父类来调用子类，将某些步骤的实现写在子类中，由父类来控制整个过程。</li>\n</ul>\n<h2 id="访问者模式visitor"><a href="#%E8%AE%BF%E9%97%AE%E8%80%85%E6%A8%A1%E5%BC%8Fvisitor" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>访问者模式(Visitor)</h2>\n<p>表示一个作用于某对象结构中的各元素的操作，它使你可以在不改变各元素的类的前提下定义作用于这些元素的新操作。</p>\n<h3 id="模式背景-1"><a href="#%E6%A8%A1%E5%BC%8F%E8%83%8C%E6%99%AF-1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式背景</h3>\n<p>学校有教师和工程师</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="56724951674910384000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`abstract class Employee\n{\n    private string name;\n    private double income;\n    private int vacationDays;\n\n    public string Name\n    {\n        get { return name; }\n        set { name = value; }\n    }\n    public double Income\n    {\n        get { return income; }\n        set { income = value; }\n    }\n    public int VacationDays\n    {\n        get { return vacationDays; }\n        set { vacationDays = value; }\n    }\n}\n\nclass Teacher : Employee\n{\n    public Teacher(string name, double income,int vacationDays)\n    {\n        Name = name;\n        Income = income;\n        VacationDays = vacationDays;\n    }\n}\n\nclass Engineer : Employee\n{\n    public Engineer(string name, double income,int vacationDays)\n    {\n        Name = name;\n        Income = income;\n        VacationDays = vacationDays;\n    }\n}\n\nstatic void Main(string[] args)\n{\n    Teacher zhangsan = new Teacher(&quot;张三&quot;, 2500.0, 14);\n    Engineer lisi    = new Engineer(&quot;李四&quot;, 3500.0, 16);\n\n    Console.WriteLine(zhangsan.Name + &quot;的收入是&quot;+ zhangsan.Income +\n                                &quot;, 假期是&quot;+ zhangsan.VacationDays);\n\n    Console.WriteLine(lisi.Name + &quot;的收入是&quot; + lisi.Income + \v                                       &quot;, 假期是&quot; + lisi.VacationDays);\n\n    Console.ReadKey();\n}`, `56724951674910384000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp">abstract <span class="token keyword">class</span> <span class="token class-name">Employee</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">private</span> string name<span class="token punctuation">;</span>\n    <span class="token keyword">private</span> <span class="token keyword">double</span> income<span class="token punctuation">;</span>\n    <span class="token keyword">private</span> <span class="token keyword">int</span> vacationDays<span class="token punctuation">;</span>\n\n    <span class="token keyword">public</span> string Name\n    <span class="token punctuation">{</span>\n        get <span class="token punctuation">{</span> <span class="token keyword">return</span> name<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n        set <span class="token punctuation">{</span> name <span class="token operator">=</span> value<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> <span class="token keyword">double</span> Income\n    <span class="token punctuation">{</span>\n        get <span class="token punctuation">{</span> <span class="token keyword">return</span> income<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n        set <span class="token punctuation">{</span> income <span class="token operator">=</span> value<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> <span class="token keyword">int</span> VacationDays\n    <span class="token punctuation">{</span>\n        get <span class="token punctuation">{</span> <span class="token keyword">return</span> vacationDays<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n        set <span class="token punctuation">{</span> vacationDays <span class="token operator">=</span> value<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">class</span> <span class="token class-name">Teacher</span> <span class="token operator">:</span> Employee\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> <span class="token function">Teacher</span><span class="token punctuation">(</span>string name<span class="token punctuation">,</span> <span class="token keyword">double</span> income<span class="token punctuation">,</span><span class="token keyword">int</span> vacationDays<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Name <span class="token operator">=</span> name<span class="token punctuation">;</span>\n        Income <span class="token operator">=</span> income<span class="token punctuation">;</span>\n        VacationDays <span class="token operator">=</span> vacationDays<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">class</span> <span class="token class-name">Engineer</span> <span class="token operator">:</span> Employee\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> <span class="token function">Engineer</span><span class="token punctuation">(</span>string name<span class="token punctuation">,</span> <span class="token keyword">double</span> income<span class="token punctuation">,</span><span class="token keyword">int</span> vacationDays<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Name <span class="token operator">=</span> name<span class="token punctuation">;</span>\n        Income <span class="token operator">=</span> income<span class="token punctuation">;</span>\n        VacationDays <span class="token operator">=</span> vacationDays<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">Main</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    Teacher zhangsan <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Teacher</span><span class="token punctuation">(</span><span class="token string">"张三"</span><span class="token punctuation">,</span> <span class="token number">2500.0</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    Engineer lisi    <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Engineer</span><span class="token punctuation">(</span><span class="token string">"李四"</span><span class="token punctuation">,</span> <span class="token number">3500.0</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>zhangsan<span class="token punctuation">.</span>Name <span class="token operator">+</span> <span class="token string">"的收入是"</span><span class="token operator">+</span> zhangsan<span class="token punctuation">.</span>Income <span class="token operator">+</span>\n                                <span class="token string">", 假期是"</span><span class="token operator">+</span> zhangsan<span class="token punctuation">.</span>VacationDays<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>lisi<span class="token punctuation">.</span>Name <span class="token operator">+</span> <span class="token string">"的收入是"</span> <span class="token operator">+</span> lisi<span class="token punctuation">.</span>Income <span class="token operator">+</span> \v                                       <span class="token string">", 假期是"</span> <span class="token operator">+</span> lisi<span class="token punctuation">.</span>VacationDays<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Console<span class="token punctuation">.</span><span class="token function">ReadKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>如何批量给员工加薪，加假期？</p>\n<h3 id="模式动机-1"><a href="#%E6%A8%A1%E5%BC%8F%E5%8A%A8%E6%9C%BA-1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式动机</h3>\n<ul>\n<li>对于系统中的某些对象，它们存储在同一个集合中，且具有不同的类型，而且对于该集合中的对象，可以接受一类称为访问者的对象来访问，而且不同的访问者其访问方式有所不同，访问者模式为解决这类问题而诞生。</li>\n<li>在实际使用时，对同一集合对象的操作并不是唯一的，对相同的元素对象可能存在多种不同的操作方式。</li>\n<li>而且这些操作方式并不稳定，可能还需要增加新的操作，以满足新的业务需求。</li>\n<li>此时，访问者模式就是一个值得考虑的解决方案。</li>\n</ul>\n<h3 id="模式定义-1"><a href="#%E6%A8%A1%E5%BC%8F%E5%AE%9A%E4%B9%89-1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式定义</h3>\n<p>表示一个作用于某对象结构中的各元素的操作。它使我们可以在不改变各元素的类的前提下定义作用于这些元素的新操作。访问者模式是一种对象行为型模式。</p>\n<h3 id="模式结构-1"><a href="#%E6%A8%A1%E5%BC%8F%E7%BB%93%E6%9E%84-1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式结构</h3>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/微信截图_20180418121437-b0ec74a789752742d192aa76c0099f7e-6cf7b.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 69.29196499602227%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAABnWAAAZ1gEY0crtAAACpElEQVQ4y51UXWiSURj+nM6fLvImiBC66aaLxsS62oIokCDSu0YjhthF7D52V1iDpMVaOClYUI5hQ7vZheDFFoP8QcSJbnNz/m3m3PwZ/qJTRD0952vGZmtBDxy+c877nvc87/u852Oy2exYLBZ7FolEnhcKhbHx8fFzDDA4OMiZnJzk0vna2tr1fD7/9eDg4Es0Gp3P5XLzmJvW19evUXswGOQwHVQqFdJBs9kkGo3mEt3v7+/njY6OCuh8ZWXl0XGfDkDiPrWHQiGuUqn8FTCRSDwES9X+/r46nU4PGwwGPt2HPwejl87BpG9ra2saB3Uej8e0ubmpg69uZ2fn6pFvL/Vn/oZGo9HD/AfYoOFweAY3Gjc2NuZ3d3dnrFbreWrc29u7l0qlPmB/IhAITMXj8Wlk8RLpizOZzKvt7W0dajuFs6+R4XvY77BR4URarRZpt9sEhScmk4mtIYT6SLpQKpWIw+G4TL8d0LMUyWRygg0IBgMo7i2wuA22A3Nzc4Kjug1hvQBVZ8HCgAs+g8kbn88nxPod9j/BTm2zYLyAgIqzanFiLZVKOV6vV2KxWCRms/mK3W6XuFwuCUycP84Vi8Ueo9HIlcvlQpVKxReJRDzYuDKZjKfVaoXU0e/3P6Bp1et1AnUJRGNTBcO7RyLyukn8hlgsZm/V6/U9i4uLbPput/sm2uY70voGsdwIuozvMkS5Qe0IzD/R3P9K+TgUCsWFM9umGyg2uwlGMoj1BG0ygpqpweYxmAyhrQT4DkNEtdPpVKOWI9QP4vSdegvSoTVk0Fdvad2gIDsODw8J+rJos9kkaLVatVoleM8EqbNtg1ejOTUgbmcDrq6uvqDOOJSv1WoljDp+CuGlpaWLYP8Dj6BWLpdLECpP3zfq+5Se+wkpbiULnmBjKAAAAABJRU5ErkJggg==\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;"\n        alt="     20180418121437"\n        title=""\n        src="/static/微信截图_20180418121437-b0ec74a789752742d192aa76c0099f7e-fee1c.png"\n        srcset="/static/微信截图_20180418121437-b0ec74a789752742d192aa76c0099f7e-a67b7.png 200w,\n/static/微信截图_20180418121437-b0ec74a789752742d192aa76c0099f7e-0b187.png 400w,\n/static/微信截图_20180418121437-b0ec74a789752742d192aa76c0099f7e-fee1c.png 800w,\n/static/微信截图_20180418121437-b0ec74a789752742d192aa76c0099f7e-b1a91.png 1200w,\n/static/微信截图_20180418121437-b0ec74a789752742d192aa76c0099f7e-6cf7b.png 1257w"\n        sizes="(max-width: 800px) 100vw, 800px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<ul>\n<li>Vistor：抽象访问者</li>\n<li>ConcreteVisitor：具体访问者</li>\n<li>Element：抽象元素</li>\n<li>ConcreteElement：具体元素</li>\n<li>ObjectStructure：对象结构</li>\n</ul>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/微信截图_20180418121632-0330a4570cc579dca757405757503454-6cf69.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 69.25872093023257%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAABnWAAAZ1gEY0crtAAAClklEQVQ4y4VU3WuSURjXTV+XEXS3QOgimASDAhl4MYhYLAiCpIuGwSTpT8i6yiy8aMQYzLHR7mrUIscY5q0XCooXbmx+f39O50ebDjU35vTt97zpaFuuBw7nvOf3PM/5nef5nZdXKBRexuPx17FYTLu7u/tKr9eLeTCZTNan1Wr7ae12u0fK5bIR+Ff4Lu/t7S1j/c3j8QwTHgwG+byu1Wo1tmtHR0esTqe7RvtSqZRRKpUDtHY6naquT6vVOvEPhUIPCcfcr1Kp/iTMZDLKYrH4LJvNPs/n809XV1cZ2oc/H0NIa7/ffysSicxFo1HDxsbGdyQwIGY2mUze7PgKyZ/Xy9rtdm/wAuOSooYfceIXMFhGnRZNJtMVAre3tx/s7+/P+3y+KdRwBuwNOzs77xwOx1XEvE+n07Obm5szYD0FtvOpVGqMy4oPFoy4mlQqFRYJuRomEolF9ozhABYJr9fr9ZO9bmwul/vAJQSDUZxyFyzugeno2tqaiPa9Xu8EOmrCWEIXl3DA51KpNL2+vj4Avzmo4hMGh4H9DyR8dFEtTn2r1Wo+EkmMRqNkZWXlhtVqlaDzEkD8c3HHx8d9CwsLArlcflmhUIgYhqHOCoaGhoQajeYSObpcrgmSC0kMdWQPDw/ZZrNJsrlPODDBWRK8zml8sVjMzSRqs9ks6ujwDoLtkJYVw4Ur0mzb2toaIRxlYU6J+39X/tvGx8cHe2HhcPh8UnSa33lOtyEPNUStpJcCRpOQ1mPUUIRmPIFsJm02mwp7SmDqQCAw3EvUAprxCqa7UoE+OWngqhW73S7B3CS54D1zOBn83/4zIRwEHdm8gbjZn7BGo1H+BcNPIWCxWAZxtRSwWrVaLR8cHBBOzXpBcb8BEXgmKR+A7xcAAAAASUVORK5CYII=\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;"\n        alt="     20180418121632"\n        title=""\n        src="/static/微信截图_20180418121632-0330a4570cc579dca757405757503454-fee1c.png"\n        srcset="/static/微信截图_20180418121632-0330a4570cc579dca757405757503454-a67b7.png 200w,\n/static/微信截图_20180418121632-0330a4570cc579dca757405757503454-0b187.png 400w,\n/static/微信截图_20180418121632-0330a4570cc579dca757405757503454-fee1c.png 800w,\n/static/微信截图_20180418121632-0330a4570cc579dca757405757503454-b1a91.png 1200w,\n/static/微信截图_20180418121632-0330a4570cc579dca757405757503454-6cf69.png 1376w"\n        sizes="(max-width: 800px) 100vw, 800px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="90020820456857620000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`abstract class Employee\n{\n    private string name;\n    private double income;\n    private int vacationDays;\n\n    public string Name\n    {\n        get { return name; }\n        set { name = value; }\n    }\n    public double Income\n    {\n        get { return income; }\n        set { income = value; }\n    }\n    public int VacationDays\n    {\n        get { return vacationDays; }\n        set { vacationDays = value; }\n    }\n\n    abstract public void Accept(Visitor visitor);\n}\nclass Teacher : Employee\n{\n    public Teacher(string name, double income,int vacationDays)\n    {\n        Name = name;\n        Income = income;\n        VacationDays = vacationDays;\n    }\n    public override void Accept(Visitor visitor)\n    {\n        visitor.Visit(this);\n    }\n}\nclass Engineer : Employee\n{\n    public Engineer(string name, double income,int vacationDays)\n    {\n        Name = name;\n        Income = income;\n        VacationDays = vacationDays;\n    }\n    public override void Accept(Visitor visitor)\n    {\n        visitor.Visit(this);\n    }\n}\n\nabstract class Visitor\n{\n    abstract public void Visit(Employee element);\n}\n\nclass IncomeVisitor : Visitor\n{\n    public override void Visit(Employee element)\n    {\n        element.Income *= 1.10;\n        Console.WriteLine(element.Name + &quot;的新工资是: &quot; + element.Income);\n    }\n}\n\nclass VacationVisitor : Visitor\n{\n    public override void Visit(Employee element)\n    {\n        element.VacationDays += 3;\n        Console.WriteLine(element.Name + &quot;的新假期是&quot; + element.VacationDays);\n    }\n}\n\nclass Employees\n{\n    private ArrayList employees = new ArrayList();\n    public void Attach(Employee employee)\n    {\n        employees.Add(employee);\n    }\n    public void Detach(Employee employee)\n    {\n        employees.Remove(employee);\n    }\n    public void Accept(Visitor visitor)\n    {\n        foreach (Employee e in employees)\n            e.Accept(visitor);\n    }\n}\n\nstatic void Main(string[] args)\n{\n    Teacher zhangsan = new Teacher(&quot;张三&quot;, 2500.0, 14);\n    Engineer lisi    = new Engineer(&quot;李四&quot;, 3500.0, 16);\n\n    Employees e = new Employees();\n    e.Attach(zhangsan);\n    e.Attach(lisi);\n\n    IncomeVisitor v1 = new IncomeVisitor();\n    VacationVisitor v2 = new VacationVisitor();\n\n    e.Accept(v1);\n    e.Accept(v2);\n    Console.Read();\n}`, `90020820456857620000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp">abstract <span class="token keyword">class</span> <span class="token class-name">Employee</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">private</span> string name<span class="token punctuation">;</span>\n    <span class="token keyword">private</span> <span class="token keyword">double</span> income<span class="token punctuation">;</span>\n    <span class="token keyword">private</span> <span class="token keyword">int</span> vacationDays<span class="token punctuation">;</span>\n\n    <span class="token keyword">public</span> string Name\n    <span class="token punctuation">{</span>\n        get <span class="token punctuation">{</span> <span class="token keyword">return</span> name<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n        set <span class="token punctuation">{</span> name <span class="token operator">=</span> value<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> <span class="token keyword">double</span> Income\n    <span class="token punctuation">{</span>\n        get <span class="token punctuation">{</span> <span class="token keyword">return</span> income<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n        set <span class="token punctuation">{</span> income <span class="token operator">=</span> value<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> <span class="token keyword">int</span> VacationDays\n    <span class="token punctuation">{</span>\n        get <span class="token punctuation">{</span> <span class="token keyword">return</span> vacationDays<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n        set <span class="token punctuation">{</span> vacationDays <span class="token operator">=</span> value<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n\n    abstract <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Accept</span><span class="token punctuation">(</span>Visitor visitor<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">class</span> <span class="token class-name">Teacher</span> <span class="token operator">:</span> Employee\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> <span class="token function">Teacher</span><span class="token punctuation">(</span>string name<span class="token punctuation">,</span> <span class="token keyword">double</span> income<span class="token punctuation">,</span><span class="token keyword">int</span> vacationDays<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Name <span class="token operator">=</span> name<span class="token punctuation">;</span>\n        Income <span class="token operator">=</span> income<span class="token punctuation">;</span>\n        VacationDays <span class="token operator">=</span> vacationDays<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> override <span class="token keyword">void</span> <span class="token function">Accept</span><span class="token punctuation">(</span>Visitor visitor<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        visitor<span class="token punctuation">.</span><span class="token function">Visit</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">class</span> <span class="token class-name">Engineer</span> <span class="token operator">:</span> Employee\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> <span class="token function">Engineer</span><span class="token punctuation">(</span>string name<span class="token punctuation">,</span> <span class="token keyword">double</span> income<span class="token punctuation">,</span><span class="token keyword">int</span> vacationDays<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Name <span class="token operator">=</span> name<span class="token punctuation">;</span>\n        Income <span class="token operator">=</span> income<span class="token punctuation">;</span>\n        VacationDays <span class="token operator">=</span> vacationDays<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> override <span class="token keyword">void</span> <span class="token function">Accept</span><span class="token punctuation">(</span>Visitor visitor<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        visitor<span class="token punctuation">.</span><span class="token function">Visit</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\nabstract <span class="token keyword">class</span> <span class="token class-name">Visitor</span>\n<span class="token punctuation">{</span>\n    abstract <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Visit</span><span class="token punctuation">(</span>Employee element<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">class</span> <span class="token class-name">IncomeVisitor</span> <span class="token operator">:</span> Visitor\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> override <span class="token keyword">void</span> <span class="token function">Visit</span><span class="token punctuation">(</span>Employee element<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        element<span class="token punctuation">.</span>Income <span class="token operator">*=</span> <span class="token number">1.10</span><span class="token punctuation">;</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>element<span class="token punctuation">.</span>Name <span class="token operator">+</span> <span class="token string">"的新工资是: "</span> <span class="token operator">+</span> element<span class="token punctuation">.</span>Income<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">class</span> <span class="token class-name">VacationVisitor</span> <span class="token operator">:</span> Visitor\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> override <span class="token keyword">void</span> <span class="token function">Visit</span><span class="token punctuation">(</span>Employee element<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        element<span class="token punctuation">.</span>VacationDays <span class="token operator">+=</span> <span class="token number">3</span><span class="token punctuation">;</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>element<span class="token punctuation">.</span>Name <span class="token operator">+</span> <span class="token string">"的新假期是"</span> <span class="token operator">+</span> element<span class="token punctuation">.</span>VacationDays<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">class</span> <span class="token class-name">Employees</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">private</span> ArrayList employees <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">ArrayList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Attach</span><span class="token punctuation">(</span>Employee employee<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        employees<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>employee<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Detach</span><span class="token punctuation">(</span>Employee employee<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        employees<span class="token punctuation">.</span><span class="token function">Remove</span><span class="token punctuation">(</span>employee<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Accept</span><span class="token punctuation">(</span>Visitor visitor<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        foreach <span class="token punctuation">(</span>Employee e in employees<span class="token punctuation">)</span>\n            e<span class="token punctuation">.</span><span class="token function">Accept</span><span class="token punctuation">(</span>visitor<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">Main</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    Teacher zhangsan <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Teacher</span><span class="token punctuation">(</span><span class="token string">"张三"</span><span class="token punctuation">,</span> <span class="token number">2500.0</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    Engineer lisi    <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Engineer</span><span class="token punctuation">(</span><span class="token string">"李四"</span><span class="token punctuation">,</span> <span class="token number">3500.0</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Employees e <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Employees</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    e<span class="token punctuation">.</span><span class="token function">Attach</span><span class="token punctuation">(</span>zhangsan<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    e<span class="token punctuation">.</span><span class="token function">Attach</span><span class="token punctuation">(</span>lisi<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    IncomeVisitor v1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">IncomeVisitor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    VacationVisitor v2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">VacationVisitor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    e<span class="token punctuation">.</span><span class="token function">Accept</span><span class="token punctuation">(</span>v1<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    e<span class="token punctuation">.</span><span class="token function">Accept</span><span class="token punctuation">(</span>v2<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    Console<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="优缺点-1"><a href="#%E4%BC%98%E7%BC%BA%E7%82%B9-1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>优缺点</h3>\n<ul>\n<li>\n<p>优点</p>\n<ul>\n<li>使得增加新的操作变得很容易。如果一些操作依赖于一个复杂的结构对象的话，那么一般而言，增加新的操作会很复杂。而使用访问者模式，增加新的操作就意味着增加一个新的访问者类，因此将变得很容易。</li>\n<li>将有关的行为集中到一个访问者对象中，而不是分散到一个个的节点类中。</li>\n<li>可以跨过几个类的等级结构访问属于不同的等级结构的成员类。</li>\n</ul>\n</li>\n<li>\n<p>缺点</p>\n<ul>\n<li>破坏封装。访问者模式要求访问者对象访问并调用每一个节点对象的操作，这隐含了一个对所有节点对象的要求：它们必须暴露一些自己的操作和内部状态。不然，访问者的访问就变得没有意义。由于访问者对象自己会积累访问操作所需的状态，从而使这些状态不再存储在节点对象中，这也是破坏封装的。</li>\n<li>增加新的节点类变得很困难。每增加一个新的节点都意味着要在抽象访问者角色中增加一个新的抽象操作，并在每一个具体访问者类中增加相应的具体操作。</li>\n</ul>\n</li>\n</ul>\n<h3 id="模式使用-1"><a href="#%E6%A8%A1%E5%BC%8F%E4%BD%BF%E7%94%A8-1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式使用</h3>\n<ul>\n<li>定义对象结构的类很少改变，但经常需要在此结构上定义新的操作。</li>\n<li>对象需要添加很多不同的并且不相关的操作，而我们想避免让这些操作“污染”这些对象的类。访问者模式使得我们可以将相关的操作集中起来定义在一个类中。当该对象结构被很多应用共享时，用访问者模式让每个应用仅包含需要用到的操作。</li>\n</ul>\n<h3 id="模式应用-1"><a href="#%E6%A8%A1%E5%BC%8F%E5%BA%94%E7%94%A8-1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式应用</h3>\n<ul>\n<li>访问者模式中对象结构存储了不同类型的元素对象，以供不同访问者访问。访问者模式包括两个层次结构，一个是访问者层次结构，提供了抽象访问者和具体访问者，一个是元素层次结构，提供了抽象元素和具体元素。相同的访问者可以以不同的方式访问不同的元素，相同的元素可以接受不同访问者以不同访问方式访问。</li>\n<li>在访问者模式中，增加新的访问者无须修改原有系统，系统具有较好的可扩展性。</li>\n</ul>\n<h3 id="模式小结"><a href="#%E6%A8%A1%E5%BC%8F%E5%B0%8F%E7%BB%93" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式小结</h3>\n<p>访问者模式的主要优点在于使得增加新的访问操作变得很容易，将有关元素对象的访问行为集中到一个访问者对象中，而不是分散到一个个的元素类中，还可以跨过类的等级结构访问属于不同的等级结构的元素类，让用户能够在不修改现有类层次结构的情况下，定义该类层次结构的操作；其主要缺点在于增加新的元素类很困难，而且在一定程度上破坏系统的封装性。</p>\n<h2 id="解释器模式interpreter"><a href="#%E8%A7%A3%E9%87%8A%E5%99%A8%E6%A8%A1%E5%BC%8Finterpreter" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>解释器模式(Interpreter)</h2>\n<p>给定一个语言，定义它的文法的一种表示，并定义一个解释器，这个解释器使用该表示来解释语言中的句子。</p>\n<h3 id="模式背景-2"><a href="#%E6%A8%A1%E5%BC%8F%E8%83%8C%E6%99%AF-2" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式背景</h3>\n<p>设计与实现一个四则算术运算解释器</p>\n<ul>\n<li>可以分析任意+、-、*、/表达式，并计算其数值</li>\n<li>输入表达式为一个字符串表达式</li>\n<li>输出结果为双精度浮点数(Double)</li>\n</ul>\n<p>输入是一个用字符串表达的四则运算，比如 1 + 2 * 3 。目的是试图去理解这个字符串表达的运算指令，然后计算出结果 7。之所以是一个解释器 Interpreter，而不是一个编译器 Compiler，是因为程序是去理解指令并且执行指令，而不是把指令编译成机器代码来运行；后者是编译器的目标。</p>\n<p>第一个部分，是截取输入字符串，然后返回单元指令。比如，对于指令 1 + 2 * 3 – 4 / 5，就需要被分解成如下所示的单元指令集：</p>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/微信截图_20180418123729-6ff7d61c721cbf00f9ea46989844841c-dc56b.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 58.307210031347964%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABnWAAAZ1gEY0crtAAACWElEQVQoz32T3UtTYRzH97cU3nRR4XwjU2fmy6ZpOhOJ3ugi7QVJwmmolYRQIk7aZjbLuTCdcyqhpXjbyNIWBNaFtZllQpkTUcm2nc/p2Y6F2urAh+ech8OH7/l9n6NaX4fV1WjIUYCNgIwkbycokAV2uyypZDmEJAUBBSm8ij058hI7kPnqfc9zp4MJVx8vBvp5OejC7XDgdY/j6EVWyZv2nWy9JEmK7K0sLGDRabmdlEjTgSQa9+8T7KU+JoaBk3p6u0OoJt+M4xyxMDhqZXDMSt+IGbdneJv0t3DJ56NDl0P38VLsxUW0Zx6iTZOKMSGB8Qtn6AkLLzUmcO56LGU31JQ3xHG2bg+W/nJFuCkipIzA/3GWjlwdXcf0dBYexZKehiklmeY4NWPlp5SEBqOGOlMutSatWHUYjOnYnxqUeS0vM7+4yFogoCSc9WEVn9xVUiyEBbRlpCtC9RZh7Z1srpnzqTfl0XBXT7UxA9uTKqSNn3hHhpl5PMSMs4+lt9P4P38SCbVKwqJ/JWzRUGPMoqY1k6ut2VxpTlWEgSDfpqdZFKIvU5P45+YiWLU5EeGDgnzMaSl/J6y4FU9l00EuNyWLNYWLjbF0CWG05v2zYoZ5ygxt+sLtCc+fVoT3+iuxugx0uKoE1bQ5Knjnc0cEoVAwUoy0pZT7R3J5WFqCLdxy1mEsouWWxERGy04oLf/vHP6532z7u9eLWZMmismhPTuTlng1zeIc3ty9i2cN1biG5LCQqNfOwx1+/rGygqe3B4/4JV4LXvU8wiOY6LSxNv8Bp0vmFxM47S+z4SUmAAAAAElFTkSuQmCC\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;"\n        alt="     20180418123729"\n        title=""\n        src="/static/微信截图_20180418123729-6ff7d61c721cbf00f9ea46989844841c-fee1c.png"\n        srcset="/static/微信截图_20180418123729-6ff7d61c721cbf00f9ea46989844841c-a67b7.png 200w,\n/static/微信截图_20180418123729-6ff7d61c721cbf00f9ea46989844841c-0b187.png 400w,\n/static/微信截图_20180418123729-6ff7d61c721cbf00f9ea46989844841c-fee1c.png 800w,\n/static/微信截图_20180418123729-6ff7d61c721cbf00f9ea46989844841c-dc56b.png 957w"\n        sizes="(max-width: 800px) 100vw, 800px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>第二个部分，把单元指令集组成一个树结构，称之为 Abstract Syntax Tree。按照将来需要解释的顺序，优先执行的指令放在树的叶的位置，最后执行的指令是树根 Root。</p>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/微信截图_20180418123855-9d5bf691f24549c4ae1a0d5a166d10af-5bcb1.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 49.184339314845026%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABnWAAAZ1gEY0crtAAACDklEQVQoz21SW2sTURDefyIUX8VSi/hQ7E0fKgbv+IPEJ7Eh1iRW0tIiiDYqaS1NQa2kSGiTjZWmFpqSlnTT2ETjZrP32/k8e3a7teLAcGbODN/MNzOc2AGBL+TYsFxAVQk0DYGSQOk/fQ0dEGUHXwXJj6uE6DpBh2JxXVFD+cMyWX/3BqXFBay/TaPxfSuAdr06OBES+s2ujGRhG4ZphP1YFgHHp9+T2OAAYiND5NHFfjw424N8dNxPcVyaRk6pJxptS9d1ZiuKCtMwWIA+hCu+ymAqcg0zd28jMTqMaF8v+ETcp25ZYW8ucdk7U9pBvlpntu36BTKbu8hWDhghrvh6HqnrY5i+cwvx4UE8Pn8OxQCwJQgwZZl26oQT2Dn6BbHbZa4TFDkUFey32iA2A8zg+dhVpG5E8HToMgPkJ5OwKa2DTx+xn12C0jiCakvIbbxkACu7Ar7sHTK7VFmG8GMLpinhMz9HZzi3gOmbEczev0cpjyB6oReF+IRPiVK2bYvtQTUkbNdyPkj9J77Vm8yuNni0OjWYtoqNygq4tRdpTAxcQvLKKMb7+/Cw5wz4Z8lgKQ7+ld9SC7rSgUNvp9kWTsUITef2imXkJxNYm0ph9UkMObrhdrXqJ7h/b9mf1+rmLGrNMjRDRrYQg2WbwQET6IYLzrDwXzk+ER/sxPcAHNq551uWEcY9QO96/gBTMsf2fczlpwAAAABJRU5ErkJggg==\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;"\n        alt="     20180418123855"\n        title=""\n        src="/static/微信截图_20180418123855-9d5bf691f24549c4ae1a0d5a166d10af-fee1c.png"\n        srcset="/static/微信截图_20180418123855-9d5bf691f24549c4ae1a0d5a166d10af-a67b7.png 200w,\n/static/微信截图_20180418123855-9d5bf691f24549c4ae1a0d5a166d10af-0b187.png 400w,\n/static/微信截图_20180418123855-9d5bf691f24549c4ae1a0d5a166d10af-fee1c.png 800w,\n/static/微信截图_20180418123855-9d5bf691f24549c4ae1a0d5a166d10af-b1a91.png 1200w,\n/static/微信截图_20180418123855-9d5bf691f24549c4ae1a0d5a166d10af-5bcb1.png 1226w"\n        sizes="(max-width: 800px) 100vw, 800px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>程序只有 2 种单元指令：操作数 NumExpression 和 运算符 OpExpression 。</p>\n<p>定义了一个抽象类，叫做 Expression，然后 NumExpression 和 OpExpression 继承了该抽象类。</p>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/微信截图_20180418123939-2460bcf31c9375f1d855a5be2d669928-88ef2.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 51.751751751751755%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABnWAAAZ1gEY0crtAAAB50lEQVQoz41Sy2sacRDeuH9BaCHgIZBTr0lJSMghARHRU46xgZAQA8k/4slT8Gqpl1oPUePFgyg+wCeIwSeI4gPfL1S0uu42k5ntWiqUNAMDMzvffvPNzI9hJFOpVAwAiHG1Wn3GGMrlMnS7XajX65RCoVB4pDqGrEKhYN40jUbzh7DdbvuJgOd5Dl1YLpcLyrHRN4lQplQq3yZUq9UE3KC4WCx6J5MJdDqdGfpP9OlsNoNcLvd1pZAE/NMQLBsOh2w2m2Wps9Fo3AgGg58ymcye2+0+cblcDz6fbzeVSh14vd4dmoJwtVqNRfVss9mUSU2Y9xgrl8u3/wdaI4tEIuexWEyHKq49Hs99PB6/SSQSOvRbp9P5kTBWq3UrmUwSRhcIBHR+v/8e61fpdPouFAqdEgbV/iZsNBoj2k+pVIJerweDwQBGoxHM53OIRqP7hMFRjzmOg1arBTgi4IoADydeHkd/Wh1KJMzn81UCIBmPT0RA5/v9vlCpVATc4R5hUOkh/shhs19Ul3DcdDoF3O33NUJUKD4yVPRCKhaLBT0XUWU4HP4sKTwaj8cCfcf6CifQf9j4xxqh2Ww+czgcFzabTbtyzLUWi0VrMBg2CaPX6z/gHs/tdvuXv3CUX5pMpmPC4B1Evle7LZ/Fn1XiNgAAAABJRU5ErkJggg==\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;"\n        alt="     20180418123939"\n        title=""\n        src="/static/微信截图_20180418123939-2460bcf31c9375f1d855a5be2d669928-fee1c.png"\n        srcset="/static/微信截图_20180418123939-2460bcf31c9375f1d855a5be2d669928-a67b7.png 200w,\n/static/微信截图_20180418123939-2460bcf31c9375f1d855a5be2d669928-0b187.png 400w,\n/static/微信截图_20180418123939-2460bcf31c9375f1d855a5be2d669928-fee1c.png 800w,\n/static/微信截图_20180418123939-2460bcf31c9375f1d855a5be2d669928-88ef2.png 999w"\n        sizes="(max-width: 800px) 100vw, 800px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="95248775385350680000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`abstract class Expression\n{\n    abstract public double Interpreter(Syntax root);\n}\n\nclass NumExpression : Expression\n{\n    private double _value;\n\n    public NumExpression(double value)\n    {\n        this._value = value;\n    }\n    public double Value\n    {\n        get { return this._value; }\n    }\n    public override double Interpreter(Syntax root)\n    {\n        return ((NumExpression)(root.Expression)).Value;\n    }\n}\n\nenum Op : int\n{\n    Plus = \'+\',\n    Minus = \'-\',\n    Multiply = \'*\',\n    Divide = \'/\'\n}\nenum Prioirty\n{\n    Lv2 = 2,\n    Lv1 = 1,\n    Lv0 = 0\n}\n\nclass OpExpression : Expression\n{\n    private Op _value;\n    ……\n    public override double Interpreter(Syntax root)\n    {\n        double lvalue, rvalue;\n        if (root.LeftChild == null)\n            lvalue = 0;\n        else\n            lvalue = ((Expression)root.LeftChild.Expression).Interpreter(root.LeftChild);\n\n        if (root.RightChild == null)\n            rvalue = 0;\n        else\n            rvalue = ((Expression)root.RightChild.Expression).Interpreter(root.RightChild);\n        switch (((OpExpression)root.Expression).Value)\n        {\n            case Op.Plus:\n                return lvalue + rvalue;\n            case Op.Minus:\n                return lvalue - rvalue;\n            case Op.Multiply:\n                return lvalue * rvalue;\n            case Op.Divide:\n                return lvalue / rvalue;\n            default:\n                return 0;\n        }\n    }\n}\n\nclass Syntax\n{\n    private Expression _Expression;\n    private Syntax _left;\n    private Syntax _right;\n    public Syntax(Expression Expression)\n    {\n        this._Expression = Expression;\n        this._left = null;\n        this._right = null;\n    }\n    public Expression Expression\n    {\n        get { return this._Expression; }\n    }\n    public Syntax LeftChild\n    {\n        get { return this._left; }\n        set { this._left = value; }\n    }\n    public Syntax RightChild\n    {\n        get { return this._right; }\n        set { this._right = value; }\n    }\n}\n\nclass SyntaxTree\n{\n    private Syntax _root;\n    private int _count;\n\n    public SyntaxTree()\n    {\n        this._root = null;\n        this._count = 0;\n    }\n    public Syntax Root\n    {\n        get { return this._root; }\n    }\n    public void Append(Expression Expression)\n    {\n        this._root = this.Append(this._root, Expression);\n        this._count++;\n    }\n    private Syntax Append(Syntax root, Expression Expression)\n    {\n        ……\n    }\n}\n\nclass Interpreter\n{\n    private Expressionizer Expressionizer = new Expressionizer();\n\n    public SyntaxTree Eval(String expr)\n    {\n        Expression[] Expressions = Expressionizer.Parse(expr);\n        SyntaxTree astree = new SyntaxTree();\n\n        foreach (Expression Expression in Expressions)\n        {\n            astree.Append(Expression);\n        }\n        return astree;\n    }\n}`, `95248775385350680000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp">abstract <span class="token keyword">class</span> <span class="token class-name">Expression</span>\n<span class="token punctuation">{</span>\n    abstract <span class="token keyword">public</span> <span class="token keyword">double</span> <span class="token function">Interpreter</span><span class="token punctuation">(</span>Syntax root<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">class</span> <span class="token class-name">NumExpression</span> <span class="token operator">:</span> Expression\n<span class="token punctuation">{</span>\n    <span class="token keyword">private</span> <span class="token keyword">double</span> _value<span class="token punctuation">;</span>\n\n    <span class="token keyword">public</span> <span class="token function">NumExpression</span><span class="token punctuation">(</span><span class="token keyword">double</span> value<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>_value <span class="token operator">=</span> value<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> <span class="token keyword">double</span> Value\n    <span class="token punctuation">{</span>\n        get <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_value<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> override <span class="token keyword">double</span> <span class="token function">Interpreter</span><span class="token punctuation">(</span>Syntax root<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>NumExpression<span class="token punctuation">)</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span>Expression<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Value<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">enum</span> <span class="token class-name">Op</span> <span class="token operator">:</span> <span class="token keyword">int</span>\n<span class="token punctuation">{</span>\n    Plus <span class="token operator">=</span> <span class="token string">\'+\'</span><span class="token punctuation">,</span>\n    Minus <span class="token operator">=</span> <span class="token string">\'-\'</span><span class="token punctuation">,</span>\n    Multiply <span class="token operator">=</span> <span class="token string">\'*\'</span><span class="token punctuation">,</span>\n    Divide <span class="token operator">=</span> <span class="token string">\'/\'</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">enum</span> <span class="token class-name">Prioirty</span>\n<span class="token punctuation">{</span>\n    Lv2 <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span>\n    Lv1 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span>\n    Lv0 <span class="token operator">=</span> <span class="token number">0</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">class</span> <span class="token class-name">OpExpression</span> <span class="token operator">:</span> Expression\n<span class="token punctuation">{</span>\n    <span class="token keyword">private</span> Op _value<span class="token punctuation">;</span>\n    ……\n    <span class="token keyword">public</span> override <span class="token keyword">double</span> <span class="token function">Interpreter</span><span class="token punctuation">(</span>Syntax root<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">double</span> lvalue<span class="token punctuation">,</span> rvalue<span class="token punctuation">;</span>\n        <span class="token keyword">if</span> <span class="token punctuation">(</span>root<span class="token punctuation">.</span>LeftChild <span class="token operator">==</span> null<span class="token punctuation">)</span>\n            lvalue <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>\n        <span class="token keyword">else</span>\n            lvalue <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>Expression<span class="token punctuation">)</span>root<span class="token punctuation">.</span>LeftChild<span class="token punctuation">.</span>Expression<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Interpreter</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span>LeftChild<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n        <span class="token keyword">if</span> <span class="token punctuation">(</span>root<span class="token punctuation">.</span>RightChild <span class="token operator">==</span> null<span class="token punctuation">)</span>\n            rvalue <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>\n        <span class="token keyword">else</span>\n            rvalue <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>Expression<span class="token punctuation">)</span>root<span class="token punctuation">.</span>RightChild<span class="token punctuation">.</span>Expression<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Interpreter</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span>RightChild<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token keyword">switch</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>OpExpression<span class="token punctuation">)</span>root<span class="token punctuation">.</span>Expression<span class="token punctuation">)</span><span class="token punctuation">.</span>Value<span class="token punctuation">)</span>\n        <span class="token punctuation">{</span>\n            <span class="token keyword">case</span> Op<span class="token punctuation">.</span>Plus<span class="token operator">:</span>\n                <span class="token keyword">return</span> lvalue <span class="token operator">+</span> rvalue<span class="token punctuation">;</span>\n            <span class="token keyword">case</span> Op<span class="token punctuation">.</span>Minus<span class="token operator">:</span>\n                <span class="token keyword">return</span> lvalue <span class="token operator">-</span> rvalue<span class="token punctuation">;</span>\n            <span class="token keyword">case</span> Op<span class="token punctuation">.</span>Multiply<span class="token operator">:</span>\n                <span class="token keyword">return</span> lvalue <span class="token operator">*</span> rvalue<span class="token punctuation">;</span>\n            <span class="token keyword">case</span> Op<span class="token punctuation">.</span>Divide<span class="token operator">:</span>\n                <span class="token keyword">return</span> lvalue <span class="token operator">/</span> rvalue<span class="token punctuation">;</span>\n            <span class="token keyword">default</span><span class="token operator">:</span>\n                <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">class</span> <span class="token class-name">Syntax</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">private</span> Expression _Expression<span class="token punctuation">;</span>\n    <span class="token keyword">private</span> Syntax _left<span class="token punctuation">;</span>\n    <span class="token keyword">private</span> Syntax _right<span class="token punctuation">;</span>\n    <span class="token keyword">public</span> <span class="token function">Syntax</span><span class="token punctuation">(</span>Expression Expression<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>_Expression <span class="token operator">=</span> Expression<span class="token punctuation">;</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>_left <span class="token operator">=</span> null<span class="token punctuation">;</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>_right <span class="token operator">=</span> null<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> Expression Expression\n    <span class="token punctuation">{</span>\n        get <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_Expression<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> Syntax LeftChild\n    <span class="token punctuation">{</span>\n        get <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_left<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n        set <span class="token punctuation">{</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_left <span class="token operator">=</span> value<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> Syntax RightChild\n    <span class="token punctuation">{</span>\n        get <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_right<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n        set <span class="token punctuation">{</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_right <span class="token operator">=</span> value<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">class</span> <span class="token class-name">SyntaxTree</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">private</span> Syntax _root<span class="token punctuation">;</span>\n    <span class="token keyword">private</span> <span class="token keyword">int</span> _count<span class="token punctuation">;</span>\n\n    <span class="token keyword">public</span> <span class="token function">SyntaxTree</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>_root <span class="token operator">=</span> null<span class="token punctuation">;</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>_count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> Syntax Root\n    <span class="token punctuation">{</span>\n        get <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_root<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Append</span><span class="token punctuation">(</span>Expression Expression<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>_root <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">Append</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>_root<span class="token punctuation">,</span> Expression<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>_count<span class="token operator">++</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">private</span> Syntax <span class="token function">Append</span><span class="token punctuation">(</span>Syntax root<span class="token punctuation">,</span> Expression Expression<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        ……\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">class</span> <span class="token class-name">Interpreter</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">private</span> Expressionizer Expressionizer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Expressionizer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">public</span> SyntaxTree <span class="token function">Eval</span><span class="token punctuation">(</span>String expr<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Expression<span class="token punctuation">[</span><span class="token punctuation">]</span> Expressions <span class="token operator">=</span> Expressionizer<span class="token punctuation">.</span><span class="token function">Parse</span><span class="token punctuation">(</span>expr<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        SyntaxTree astree <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">SyntaxTree</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n        foreach <span class="token punctuation">(</span>Expression Expression in Expressions<span class="token punctuation">)</span>\n        <span class="token punctuation">{</span>\n            astree<span class="token punctuation">.</span><span class="token function">Append</span><span class="token punctuation">(</span>Expression<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n        <span class="token keyword">return</span> astree<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="模式动机-2"><a href="#%E6%A8%A1%E5%BC%8F%E5%8A%A8%E6%9C%BA-2" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式动机</h3>\n<ul>\n<li>如果在系统中某一特定类型的问题发生的频率很高，此时可以考虑将这些问题的实例表述为一个语言中的句子，因此可以构建一个解释器，该解释器通过解释这些句子来解决这些问题。</li>\n<li>解释器模式描述了如何构成一个简单的语言解释器，主要应用在使用面向对象语言开发的编译器中。</li>\n</ul>\n<h3 id="模式定义-2"><a href="#%E6%A8%A1%E5%BC%8F%E5%AE%9A%E4%B9%89-2" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式定义</h3>\n<p>定义语言的文法，并且建立一个解释器来解释该语言中的句子，这里的“语言”意思是使用规定格式和语法的代码，它是一种类行为型模式。</p>\n<h3 id="模式结构-2"><a href="#%E6%A8%A1%E5%BC%8F%E7%BB%93%E6%9E%84-2" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式结构</h3>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/微信截图_20180418124653-8bebd269e4ab77df241fd1d03ce10d92-5f38b.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 62.904498816101025%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAABnWAAAZ1gEY0crtAAACvUlEQVQ4y31TS0wTURQd21Ig7YqFLly6cGlcu3EhP0MiJiJuWGJcGRbGhTGBjVuVKETZGKEgVMQWrNA60k5LUVKmU1taC22Z6YeZaaF8CmUCpe/6plOBSOpNzmTuPXfuvJxzH0HI0Q0E0QPnTsO0DBqZSuTQyz0ACIp7BZsvhhZ4qfBLArCmUKfMO0RQE2dCGVKFof6Lh1aolilmA/pSeKB3E8CTA7BnAJz4D+NxuC/z5uQ/A3EvccuQV13pL2iUHB3X5ZhPo8uuNLppWyvWm7nDhol4sf5jHJoHo+iizI+wQFQIfMqT99JzKHS6djaMHDpb5HNQ88Yaq33u3NeFN4o1VBKqAfaOeW7zUEsFeL0jlNaRwYyOzoCOZA/0k6uKxk8cJf0VyCFIwCxERYZaEb2+LViaSyPb0zmk73WBqsw/DibWI5Q/RpN+lpn2cfQsl1umMnBb5mOS0lf2giCwxsBhhMqwrCHUZUd1ncZ8SWyvIA1mcd2/DUBjuDawQTg3cvBI5u+asHnd+LQ95cEOEbVZeWibSsGdTwnUPspBS2/gxDlbLHd11LPaMbaQeGD08F2vnJH2t4tix3sWLsn8s8XjVdNUFNsy/kH1btqtGnNGNP8zxe4Pqu3kV9UL86K6aUDQrkmSinBnkNqVAU1/YFdV6UPDhKAdGM9q+z6nqwYtW9X6a8sVewl+V3EHL7+WW8/fmHF5mg2TZNOQhWocJukWO7t/3Q2KPgDFUm/mAM6Tc75WEznfOPxlttEwM9869J1po5JSA8HlUGnXEnm4gB0FoYDN2SoCk0Xgx/ksf7T5OgR6uSe6jUoSsDm4d4iNiewUIbSt3KKf2DkvLhJOdqc08Ad/VOeMZekpZjUyuSSER+n4b4M3xRqj0rcBEWrlHldScd6dlOqplbRgZrigKSCER+h4eNifDpsSxfAfUWvsony7erIAAAAASUVORK5CYII=\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;"\n        alt="     20180418124653"\n        title=""\n        src="/static/微信截图_20180418124653-8bebd269e4ab77df241fd1d03ce10d92-fee1c.png"\n        srcset="/static/微信截图_20180418124653-8bebd269e4ab77df241fd1d03ce10d92-a67b7.png 200w,\n/static/微信截图_20180418124653-8bebd269e4ab77df241fd1d03ce10d92-0b187.png 400w,\n/static/微信截图_20180418124653-8bebd269e4ab77df241fd1d03ce10d92-fee1c.png 800w,\n/static/微信截图_20180418124653-8bebd269e4ab77df241fd1d03ce10d92-b1a91.png 1200w,\n/static/微信截图_20180418124653-8bebd269e4ab77df241fd1d03ce10d92-5f38b.png 1267w"\n        sizes="(max-width: 800px) 100vw, 800px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<ul>\n<li>AbstractExpression: 抽象表达式</li>\n<li>TerminalExpression: 终结符表达式</li>\n<li>NonterminalExpression: 非终结符表达式</li>\n<li>Context: 环境类</li>\n<li>Client: 客户类</li>\n</ul>\n<h3 id="模式分析"><a href="#%E6%A8%A1%E5%BC%8F%E5%88%86%E6%9E%90" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式分析</h3>\n<p>解释器模式描述了如何为简单的语言定义一个文法，如何在该语言中表示一个句子，以及如何解释这些句子。</p>\n<p>文法规则实例：</p>\n<ul>\n<li>expression ::= value | symbol</li>\n<li>symbol ::= expression ’+’ expression | expression ’-‘</li>\n<li>value ::= an integer //一个整数值</li>\n<li>在文法规则定义中可以使用一些符号来表示不同的含义，如使用“|”表示或，使用“{”和“}”表示组合，使用“*”表示出现 0 次或多次等。</li>\n</ul>\n<p>抽象语法树：</p>\n<p>除了使用文法规则来定义一个语言，在解释器模式中还可以通过一种称之为抽象语法树(Abstract Syntax Tree, AST)的图形方式来直观地表示语言的构成，每一棵抽象语法树对应一个语言实例。</p>\n<ul>\n<li>抽象语法树描述了如何构成一个复杂的句子，通过对抽象语法树的分析，可以识别出语言中的终结符和非终结符类。</li>\n<li>在解释器模式中，每一种终结符和非终结符都有一个具体类与之对应，正因为使用类来表示每一个语法规则，使得系统具有较好的扩展性和灵活性。</li>\n</ul>\n<h3 id="优缺点-2"><a href="#%E4%BC%98%E7%BC%BA%E7%82%B9-2" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>优缺点</h3>\n<ul>\n<li>\n<p>优点</p>\n<ul>\n<li>易于改变和扩展文法。</li>\n<li>易于实现文法。</li>\n<li>增加了新的解释表达式的方式。</li>\n</ul>\n</li>\n<li>\n<p>缺点</p>\n<ul>\n<li>对于复杂文法难以维护。</li>\n<li>执行效率较低。</li>\n<li>应用场景很有限。</li>\n</ul>\n</li>\n</ul>\n<h3 id="模式使用-2"><a href="#%E6%A8%A1%E5%BC%8F%E4%BD%BF%E7%94%A8-2" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式使用</h3>\n<ul>\n<li>可以将一个需要解释执行的语言中的句子表示为一个抽象语法树。</li>\n<li>一些重复出现的问题可以用一种简单的语言来进行表达。</li>\n<li>文法较为简单。</li>\n<li>效率不是关键问题。</li>\n</ul>\n<h3 id="模式应用-2"><a href="#%E6%A8%A1%E5%BC%8F%E5%BA%94%E7%94%A8-2" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式应用</h3>\n<ul>\n<li>解释器模式在使用面向对象语言实现的编译器中得到了广泛的应用，如 Smalltalk 语言的编译器。</li>\n<li>目前有一些基于 Java 抽象语法树的源代码处理工具，如在 Eclipse 中就提供了 Eclipse AST，它是 Eclipse JDT 的一个重要组成部分，用来表示 Java 语言的语法结构，用户可以通过扩展其功能，创建自己的文法规则。</li>\n<li>可以使用解释器模式，通过 C++、Java、C#等面向对象语言开发简单的编译器，如数学表达式解析器、正则表达式解析器等，用于增强这些语言的功能，使之增加一些新的文法规则，用于解释一些特定类型的语句。</li>\n<li>在实际项目开发中如果需要解析数学公式，无须再运用解释器模式进行设计，可以直接使用一些第三方解析工具包，它们可以统称为数学表达式解析器(Math Expression Parser, MEP)，如 Expression4J、Jep、JbcParser、Symja、Math Expression String Parser(MESP)等来取代解释器模式，它们可以方便地解释一些较为复杂的文法，功能强大，且使用简单，效率较好。</li>\n<li>Expression4J：Expression4J 是一个基于 Java 的开源框架，它用于对数学表达式进行操作，是一个数学公式解析器，在 Expression4J 中可以将数学表达式存储在字符串对象中。Expression4J 是高度定制的，用户可以自定义文法，其主要功能包括实数和复数的基本数学运算，支持基本数学函数、复杂函数以及用户使用 Java 语言自定义的函数和文法，还可以定义函数目录（函数集）、支持 XML 配置文件等。</li>\n</ul>\n<h3 id="模式总结"><a href="#%E6%A8%A1%E5%BC%8F%E6%80%BB%E7%BB%93" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式总结</h3>\n<ul>\n<li>解释器模式定义语言的文法，并且建立一个解释器来解释该语言中的句子，这里的“语言”意思是使用规定格式和语法的代码，它是一种类行为型模式。</li>\n<li>解释器模式描述了如何为简单的语言定义一个文法，如何在该语言中表示一个句子，以及如何解释这些句子。</li>\n<li>解释器模式主要包含如下四个角色：在抽象表达式中声明了抽象的解释操作，它是所有的终结符表达式和非终结符表达式的公共父类；终结符表达式是抽象表达式的子类，它实现了与文法中的终结符相关联的解释操作；非终结符表达式也是抽象表达式的子类，它实现了文法中非终结符的解释操作；环境类又称为上下文类，它用于存储解释器之外的一些全局信息。</li>\n<li>对于一个简单的语言可以使用一些文法规则来进行定义，还可以通过抽象语法树的图形方式来直观地表示语言的构成，每一棵抽象语法树对应一个语言实例。</li>\n<li>解释器模式的主要优点包括易于改变和扩展文法，易于实现文法并增加了新的解释表达式的方式；其主要缺点是对于复杂文法难以维护，执行效率较低且应用场景很有限。</li>\n<li>解释器模式适用情况包括：可以将一个需要解释执行的语言中的句子表示为一个抽象语法树；一些重复出现的问题可以用一种简单的语言来进行表达；文法较为简单且效率不是关键问题。</li>\n</ul>',
id:"/github/workspace/blog/设计模式之行为型模式（三）/index.md absPath of file >>> MarkdownRemark",timeToRead:11,frontmatter:{date:"2018-04-19 00:04:46",path:"/design-pattern-behavior-3/",tags:"面试, 设计模式",title:"设计模式之行为型模式（三）",draft:null}},{excerpt:"备忘录模式(Memento…",html:'<h2 id="备忘录模式memento"><a href="#%E5%A4%87%E5%BF%98%E5%BD%95%E6%A8%A1%E5%BC%8Fmemento" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>备忘录模式(Memento)</h2>\n<p>在不破坏封装性的前提下，捕获一个对象的内部状态，并在该对象之外保存这个状态。这样以后就可将该对象恢复到原先保存的状态。</p>\n<h3 id="模式背景"><a href="#%E6%A8%A1%E5%BC%8F%E8%83%8C%E6%99%AF" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式背景</h3>\n<p>我要保存游戏进度</p>\n<ul>\n<li>游戏角色，生命力、攻击力、防御力</li>\n<li>模拟战斗代码，读取进度</li>\n</ul>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="28487274137018483000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class GameRole\n{\n    //生命力\n    private int vit;\n    public int Vitality\n    {\n        get { return vit; }\n        set { vit = value; }\n    }\n\n    //攻击力\n    private int atk;\n    public int Attack\n    {\n        get { return atk; }\n        set { atk = value; }\n    }\n\n    //防御力\n    private int def;\n    public int Defense\n    {\n        get { return def; }\n        set { def = value; }\n    }\n    //状态显示\n    public void StateDisplay()\n    {\n        Console.WriteLine(&quot;角色当前状态：&quot;);\n        Console.WriteLine(&quot;体力：{0}&quot;, this.vit);\n        Console.WriteLine(&quot;攻击力：{0}&quot;, this.atk);\n        Console.WriteLine(&quot;防御力：{0}&quot;, this.def);\n        Console.WriteLine(&quot;&quot;);\n    }\n\n    //获得初始状态\n    public void GetInitState()\n    {\n        this.vit = 100;\n        this.atk = 100;\n        this.def = 100;\n    }\n\n    //战斗\n    public void Fight()\n    {\n        this.vit = 0;\n        this.atk = 0;\n        this.def = 0;\n    }\n}\n\nstatic void Main(string[] args)\n{\n    //大战Boss前\n    GameRole lixiaoyao = new GameRole();\n    lixiaoyao.GetInitState();\n    lixiaoyao.StateDisplay();\n\n    //保存进度\n    GameRole backup = new GameRole();\n    backup.Vitality = lixiaoyao.Vitality;\n    backup.Attack = lixiaoyao.Attack;\n    backup.Defense = lixiaoyao.Defense;\n\n    //大战Boss时，损耗严重\n    lixiaoyao.Fight();\n    lixiaoyao.StateDisplay();\n\n    //恢复之前状态\n    lixiaoyao.Vitality = backup.Vitality;\n    lixiaoyao.Attack = backup.Attack;\n    lixiaoyao.Defense = backup.Defense;\n\n    lixiaoyao.StateDisplay();\n    Console.Read();\n}`, `28487274137018483000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">GameRole</span>\n<span class="token punctuation">{</span>\n    <span class="token comment">//生命力</span>\n    <span class="token keyword">private</span> <span class="token keyword">int</span> vit<span class="token punctuation">;</span>\n    <span class="token keyword">public</span> <span class="token keyword">int</span> Vitality\n    <span class="token punctuation">{</span>\n        get <span class="token punctuation">{</span> <span class="token keyword">return</span> vit<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n        set <span class="token punctuation">{</span> vit <span class="token operator">=</span> value<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token comment">//攻击力</span>\n    <span class="token keyword">private</span> <span class="token keyword">int</span> atk<span class="token punctuation">;</span>\n    <span class="token keyword">public</span> <span class="token keyword">int</span> Attack\n    <span class="token punctuation">{</span>\n        get <span class="token punctuation">{</span> <span class="token keyword">return</span> atk<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n        set <span class="token punctuation">{</span> atk <span class="token operator">=</span> value<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token comment">//防御力</span>\n    <span class="token keyword">private</span> <span class="token keyword">int</span> def<span class="token punctuation">;</span>\n    <span class="token keyword">public</span> <span class="token keyword">int</span> Defense\n    <span class="token punctuation">{</span>\n        get <span class="token punctuation">{</span> <span class="token keyword">return</span> def<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n        set <span class="token punctuation">{</span> def <span class="token operator">=</span> value<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n    <span class="token comment">//状态显示</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">StateDisplay</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"角色当前状态："</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"体力：{0}"</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>vit<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"攻击力：{0}"</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>atk<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"防御力：{0}"</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>def<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token comment">//获得初始状态</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">GetInitState</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>vit <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>atk <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>def <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token comment">//战斗</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Fight</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>vit <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>atk <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>def <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">Main</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    <span class="token comment">//大战Boss前</span>\n    GameRole lixiaoyao <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">GameRole</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    lixiaoyao<span class="token punctuation">.</span><span class="token function">GetInitState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    lixiaoyao<span class="token punctuation">.</span><span class="token function">StateDisplay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">//保存进度</span>\n    GameRole backup <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">GameRole</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    backup<span class="token punctuation">.</span>Vitality <span class="token operator">=</span> lixiaoyao<span class="token punctuation">.</span>Vitality<span class="token punctuation">;</span>\n    backup<span class="token punctuation">.</span>Attack <span class="token operator">=</span> lixiaoyao<span class="token punctuation">.</span>Attack<span class="token punctuation">;</span>\n    backup<span class="token punctuation">.</span>Defense <span class="token operator">=</span> lixiaoyao<span class="token punctuation">.</span>Defense<span class="token punctuation">;</span>\n\n    <span class="token comment">//大战Boss时，损耗严重</span>\n    lixiaoyao<span class="token punctuation">.</span><span class="token function">Fight</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    lixiaoyao<span class="token punctuation">.</span><span class="token function">StateDisplay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">//恢复之前状态</span>\n    lixiaoyao<span class="token punctuation">.</span>Vitality <span class="token operator">=</span> backup<span class="token punctuation">.</span>Vitality<span class="token punctuation">;</span>\n    lixiaoyao<span class="token punctuation">.</span>Attack <span class="token operator">=</span> backup<span class="token punctuation">.</span>Attack<span class="token punctuation">;</span>\n    lixiaoyao<span class="token punctuation">.</span>Defense <span class="token operator">=</span> backup<span class="token punctuation">.</span>Defense<span class="token punctuation">;</span>\n\n    lixiaoyao<span class="token punctuation">.</span><span class="token function">StateDisplay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    Console<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="模式动机"><a href="#%E6%A8%A1%E5%BC%8F%E5%8A%A8%E6%9C%BA" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式动机</h3>\n<ul>\n<li>在应用软件的开发过程中，有时我们有必要记录一个对象的内部状态。为了允许用户取消不确定的操作或从错误中恢复过来，需要实现备份点和撤销机制，而要实现这些机制，我们必须事先将状态信息保存在某处，这样状态才能将对象恢复到它们原先的状态。</li>\n<li>但是对象通常封装了其部分或所有的状态信息，使得其状态不能被其它对象访问，也就不可能在该对象之外保存其状态，而暴露其内部状态又将违反封装的原则，可能有损系统的可靠性和可扩展性。</li>\n</ul>\n<h3 id="模式定义"><a href="#%E6%A8%A1%E5%BC%8F%E5%AE%9A%E4%B9%89" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式定义</h3>\n<p>在不破坏封装的前提下，捕获一个对象的内部状态，并在该对象之外保存这个状态，这样可以在以后将对象恢复到原先保存的状态。</p>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/微信截图_20180417173923-a23b6990c677847f5a81f1082f98600f-63d95.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 33.365477338476374%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA10lEQVQoz41R2QrDMAzL/39dn0qhB70oDfS+bxUZOraxrTOYKHYsy47CBzuO43Fe+Pn+y1XbtojjGGmagnhd1xfSd6I7U1EUgZ7nOZqmwTiOkuDdtm1YlgXf9zHPs8T3fceyLPKuqiqUZSmYsW3boEzTRFEUooyEXddhmiY4joMkSTAMA/q+h9ZaChgLwxCu68IwDHHP86Qp6xUTQRBIF6rgyUKuIcsyIeNDqqERM8cGzHMSYk7JlSmOxQ5MkOwameRUSoX0a7e3O6zrWvZAdhJQ3Tf755dP30Ed4fNbSZcAAAAASUVORK5CYII=\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;"\n        alt="     20180417173923"\n        title=""\n        src="/static/微信截图_20180417173923-a23b6990c677847f5a81f1082f98600f-fee1c.png"\n        srcset="/static/微信截图_20180417173923-a23b6990c677847f5a81f1082f98600f-a67b7.png 200w,\n/static/微信截图_20180417173923-a23b6990c677847f5a81f1082f98600f-0b187.png 400w,\n/static/微信截图_20180417173923-a23b6990c677847f5a81f1082f98600f-fee1c.png 800w,\n/static/微信截图_20180417173923-a23b6990c677847f5a81f1082f98600f-63d95.png 1037w"\n        sizes="(max-width: 800px) 100vw, 800px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="26830851391543865000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class GameRole\n{\n    ……\n\n    //保存角色状态\n    public RoleStateMemento SaveState()\n    {\n        return (new RoleStateMemento(vit, atk, def));\n    }\n\n    //恢复角色状态\n    public void RecoveryState(RoleStateMemento memento)\n    {\n        this.vit = memento.Vitality;\n        this.atk = memento.Attack;\n        this.def = memento.Defense;\n    }\n\n    ……\n}\n\nclass RoleStateMemento    //角色状态存储箱\n{\n    private int vit;\n    private int atk;\n    private int def;\n\n    public RoleStateMemento(int vit, int atk, int def)\n    {\n        this.vit = vit;\n        this.atk = atk;\n        this.def = def;\n    }\n\n    public int Vitality   //生命力\n    {\n        get { return vit; }\n        set { vit = value; }\n    }\n\n    public int Attack   //攻击力\n    {\n        get { return atk; }\n        set { atk = value; }\n    }\n\n    public int Defense    //防御力\n    {\n        get { return def; }\n        set { def = value; }\n    }\n}\n//角色状态管理者\nclass RoleStateCaretaker\n{\n    private RoleStateMemento memento;\n\n    public void ImportState(RoleStateMemento Record)\n    {\n        memento = Record;\n    }\n\n    public RoleStateMemento ExportState()\n    {\n        return memento;\n    }\n}\n\nstatic void Main(string[] args)\n{\n    //大战Boss前\n    GameRole lixiaoyao = new GameRole();\n    lixiaoyao.GetInitState();\n    lixiaoyao.StateDisplay();\n\n    //保存进度\n    RoleStateCaretaker stateAdmin = new RoleStateCaretaker();\n    stateAdmin.ImportState(lixiaoyao.SaveState());\n\n    //大战Boss时，损耗严重\n    lixiaoyao.Fight();\n    lixiaoyao.StateDisplay();\n\n    //恢复之前状态\n    lixiaoyao.RecoveryState(stateAdmin.ExportState());\n    lixiaoyao.StateDisplay();\n\n    Console.Read();\n}`, `26830851391543865000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">GameRole</span>\n<span class="token punctuation">{</span>\n    ……\n\n    <span class="token comment">//保存角色状态</span>\n    <span class="token keyword">public</span> RoleStateMemento <span class="token function">SaveState</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">RoleStateMemento</span><span class="token punctuation">(</span>vit<span class="token punctuation">,</span> atk<span class="token punctuation">,</span> def<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token comment">//恢复角色状态</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">RecoveryState</span><span class="token punctuation">(</span>RoleStateMemento memento<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>vit <span class="token operator">=</span> memento<span class="token punctuation">.</span>Vitality<span class="token punctuation">;</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>atk <span class="token operator">=</span> memento<span class="token punctuation">.</span>Attack<span class="token punctuation">;</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>def <span class="token operator">=</span> memento<span class="token punctuation">.</span>Defense<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    ……\n<span class="token punctuation">}</span>\n\n<span class="token keyword">class</span> <span class="token class-name">RoleStateMemento</span>    <span class="token comment">//角色状态存储箱</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">private</span> <span class="token keyword">int</span> vit<span class="token punctuation">;</span>\n    <span class="token keyword">private</span> <span class="token keyword">int</span> atk<span class="token punctuation">;</span>\n    <span class="token keyword">private</span> <span class="token keyword">int</span> def<span class="token punctuation">;</span>\n\n    <span class="token keyword">public</span> <span class="token function">RoleStateMemento</span><span class="token punctuation">(</span><span class="token keyword">int</span> vit<span class="token punctuation">,</span> <span class="token keyword">int</span> atk<span class="token punctuation">,</span> <span class="token keyword">int</span> def<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>vit <span class="token operator">=</span> vit<span class="token punctuation">;</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>atk <span class="token operator">=</span> atk<span class="token punctuation">;</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>def <span class="token operator">=</span> def<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">public</span> <span class="token keyword">int</span> Vitality   <span class="token comment">//生命力</span>\n    <span class="token punctuation">{</span>\n        get <span class="token punctuation">{</span> <span class="token keyword">return</span> vit<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n        set <span class="token punctuation">{</span> vit <span class="token operator">=</span> value<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">public</span> <span class="token keyword">int</span> Attack   <span class="token comment">//攻击力</span>\n    <span class="token punctuation">{</span>\n        get <span class="token punctuation">{</span> <span class="token keyword">return</span> atk<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n        set <span class="token punctuation">{</span> atk <span class="token operator">=</span> value<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">public</span> <span class="token keyword">int</span> Defense    <span class="token comment">//防御力</span>\n    <span class="token punctuation">{</span>\n        get <span class="token punctuation">{</span> <span class="token keyword">return</span> def<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n        set <span class="token punctuation">{</span> def <span class="token operator">=</span> value<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token comment">//角色状态管理者</span>\n<span class="token keyword">class</span> <span class="token class-name">RoleStateCaretaker</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">private</span> RoleStateMemento memento<span class="token punctuation">;</span>\n\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">ImportState</span><span class="token punctuation">(</span>RoleStateMemento Record<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        memento <span class="token operator">=</span> Record<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">public</span> RoleStateMemento <span class="token function">ExportState</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> memento<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">Main</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    <span class="token comment">//大战Boss前</span>\n    GameRole lixiaoyao <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">GameRole</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    lixiaoyao<span class="token punctuation">.</span><span class="token function">GetInitState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    lixiaoyao<span class="token punctuation">.</span><span class="token function">StateDisplay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">//保存进度</span>\n    RoleStateCaretaker stateAdmin <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">RoleStateCaretaker</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    stateAdmin<span class="token punctuation">.</span><span class="token function">ImportState</span><span class="token punctuation">(</span>lixiaoyao<span class="token punctuation">.</span><span class="token function">SaveState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">//大战Boss时，损耗严重</span>\n    lixiaoyao<span class="token punctuation">.</span><span class="token function">Fight</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    lixiaoyao<span class="token punctuation">.</span><span class="token function">StateDisplay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">//恢复之前状态</span>\n    lixiaoyao<span class="token punctuation">.</span><span class="token function">RecoveryState</span><span class="token punctuation">(</span>stateAdmin<span class="token punctuation">.</span><span class="token function">ExportState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    lixiaoyao<span class="token punctuation">.</span><span class="token function">StateDisplay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Console<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="模式结构"><a href="#%E6%A8%A1%E5%BC%8F%E7%BB%93%E6%9E%84" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式结构</h3>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/微信截图_20180417174524-8b6a11cdc04889d18c9b6a04b555675f-9074e.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 15.852442671984049%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAA20lEQVQI12N4+PBh/82bN2cdO3Zs+u3bt+c9efKkpqSkhJkBCK5cuWJ68uTJnEuXLmUD1VgxQAFQj9udO3dyTp06lQIUzwCyo0JDQxnBktevX//39evX/58/f/4PAo8ePbqbkpLCDZK7fPny1J8/f4LFr127tgoklpeXJwpkXwWJvXjx4v/379//P3369NOMGTNYwAYCTX917969v0CX/fj79+//jx8/nikrK2OHurDo+fPnj96+fXv/6tWr9SAxTU1NVqCBc4Hi91++fHkRSN+6e/funq6uLrCvAFj8l4xeD0NtAAAAAElFTkSuQmCC\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;"\n        alt="     20180417174524"\n        title=""\n        src="/static/微信截图_20180417174524-8b6a11cdc04889d18c9b6a04b555675f-fee1c.png"\n        srcset="/static/微信截图_20180417174524-8b6a11cdc04889d18c9b6a04b555675f-a67b7.png 200w,\n/static/微信截图_20180417174524-8b6a11cdc04889d18c9b6a04b555675f-0b187.png 400w,\n/static/微信截图_20180417174524-8b6a11cdc04889d18c9b6a04b555675f-fee1c.png 800w,\n/static/微信截图_20180417174524-8b6a11cdc04889d18c9b6a04b555675f-9074e.png 1003w"\n        sizes="(max-width: 800px) 100vw, 800px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<ul>\n<li>Originator：原发器</li>\n<li>Memento：备忘录</li>\n<li>Caretaker：负责人</li>\n</ul>\n<h3 id="优缺点"><a href="#%E4%BC%98%E7%BC%BA%E7%82%B9" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>优缺点</h3>\n<ul>\n<li>\n<p>优点</p>\n<ul>\n<li>备忘录模式提供了一种状态恢复的实现机制，使得用户可以方便地回到一个特定的历史步骤，当新的状态无效或者存在问题时，可以使用暂时存储起来的备忘录将状态复原。</li>\n<li>备忘录模式保存了封装的边界信息，Memento 对象是原发器对象的表示，不会被其它代码改动，这种模式简化了原发器对象，Memento 只保存原发器的状态，采用堆栈来存储备忘录对象可以实现多次取消操作。</li>\n</ul>\n</li>\n<li>\n<p>缺点</p>\n<ul>\n<li>资源消耗过大，如果类的成员变量太多，就不可避免占用大量的内存了，而且每保存一次对象的状态都需要消耗内存资源，如果知道这一点大家就容易理解为什么一些提供了 Undo 功能的软件在运行时需要的内存和硬盘空间比较大了。</li>\n</ul>\n</li>\n</ul>\n<h3 id="模式使用"><a href="#%E6%A8%A1%E5%BC%8F%E4%BD%BF%E7%94%A8" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式使用</h3>\n<ul>\n<li>必须保存一个对象在某一个时刻的状态/部分状态，这样以后需要时它能够恢复到先前的状态。</li>\n<li>如果一个用接口来让其它对象得到这些状态，将会暴露对象的实现细节并破坏对象的封装性。</li>\n</ul>\n<h3 id="模式应用"><a href="#%E6%A8%A1%E5%BC%8F%E5%BA%94%E7%94%A8" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式应用</h3>\n<ul>\n<li>Undo 功能</li>\n<li>配置文件</li>\n<li>Cookie Session 对象</li>\n</ul>\n<h2 id="观察者模式observer"><a href="#%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8Fobserver" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>观察者模式(Observer)</h2>\n<p>定义对象间的一种一对多的依赖关系，当一个对象的状态发生改变时，所有依赖于它的对象都得到通知并被自动更新。</p>\n<h3 id="模式背景-1"><a href="#%E6%A8%A1%E5%BC%8F%E8%83%8C%E6%99%AF-1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式背景</h3>\n<p>晕，老板回来了，我不知道</p>\n<ul>\n<li>股市特别火，同事在上班期间偷偷看股票行情</li>\n<li>如果老板出门回来，公司前台 MM 电话事先通知</li>\n<li>可是…..</li>\n<li>老板今天刚一回来，让前台 MM 去打印资料了</li>\n<li>同事背对着大门大喊了一声“耶！我的股票涨停啦！”</li>\n<li>程序模拟发生的事情</li>\n</ul>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="58831547447710400000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class Secretary   //前台秘书类\n{\n    //同事列表\n    private IList<StockObserver> observers = new List<StockObserver>();\n    private string action;\n    //增加\n    public void Attach(StockObserver observer)\n    {\n        observers.Add(observer);\n    }\n    //减少\n    public void Detach(StockObserver observer)\n    {\n        observers.Remove(observer);\n    }\n    //通知\n    public void Notify()\n    {\n        foreach (StockObserver o in observers)\n            o.Update();\n    }\n    //前台状态\n    public string SecretaryAction\n    {\n        get { return action; }\n        set { action = value; }\n    }\n}\n//看股票的同事\nclass StockObserver\n{\n    private string name;\n    private Secretary sub;\n\n    public StockObserver(string name, Secretary sub)\n    {\n        this.name = name;\n        this.sub = sub;\n    }\n\n    public void Update()\n    {\n        Console.WriteLine(&quot;{0} {1} 关闭股票行情，继续工作！&quot;, sub.SecretaryAction, name);\n    }\n}\nstatic void Main(string[] args)\n{\n    //前台秘书MM\n    Secretary MM = new Secretary();\n    //看股票的同事\n    StockObserver tongshi1 = new StockObserver(&quot;魏关姹&quot;, MM);\n    StockObserver tongshi2 = new StockObserver(&quot;易管查&quot;, MM);\n\n    //前台记下了两位同事\n    MM.Attach(tongshi1);\n    MM.Attach(tongshi2);\n    //发现老板回来\n    MM.SecretaryAction = &quot;老板回来了！&quot;;\n    //通知两个同事\n    MM.Notify();\n\n    Console.Read();\n}`, `58831547447710400000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">Secretary</span>   <span class="token comment">//前台秘书类</span>\n<span class="token punctuation">{</span>\n    <span class="token comment">//同事列表</span>\n    <span class="token keyword">private</span> IList<span class="token operator">&lt;</span>StockObserver<span class="token operator">></span> observers <span class="token operator">=</span> <span class="token keyword">new</span> List<span class="token operator">&lt;</span>StockObserver<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">private</span> string action<span class="token punctuation">;</span>\n    <span class="token comment">//增加</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Attach</span><span class="token punctuation">(</span>StockObserver observer<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        observers<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>observer<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token comment">//减少</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Detach</span><span class="token punctuation">(</span>StockObserver observer<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        observers<span class="token punctuation">.</span><span class="token function">Remove</span><span class="token punctuation">(</span>observer<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token comment">//通知</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        foreach <span class="token punctuation">(</span>StockObserver o in observers<span class="token punctuation">)</span>\n            o<span class="token punctuation">.</span><span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token comment">//前台状态</span>\n    <span class="token keyword">public</span> string SecretaryAction\n    <span class="token punctuation">{</span>\n        get <span class="token punctuation">{</span> <span class="token keyword">return</span> action<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n        set <span class="token punctuation">{</span> action <span class="token operator">=</span> value<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token comment">//看股票的同事</span>\n<span class="token keyword">class</span> <span class="token class-name">StockObserver</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">private</span> string name<span class="token punctuation">;</span>\n    <span class="token keyword">private</span> Secretary sub<span class="token punctuation">;</span>\n\n    <span class="token keyword">public</span> <span class="token function">StockObserver</span><span class="token punctuation">(</span>string name<span class="token punctuation">,</span> Secretary sub<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>sub <span class="token operator">=</span> sub<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"{0} {1} 关闭股票行情，继续工作！"</span><span class="token punctuation">,</span> sub<span class="token punctuation">.</span>SecretaryAction<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">Main</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    <span class="token comment">//前台秘书MM</span>\n    Secretary MM <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Secretary</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token comment">//看股票的同事</span>\n    StockObserver tongshi1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">StockObserver</span><span class="token punctuation">(</span><span class="token string">"魏关姹"</span><span class="token punctuation">,</span> MM<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    StockObserver tongshi2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">StockObserver</span><span class="token punctuation">(</span><span class="token string">"易管查"</span><span class="token punctuation">,</span> MM<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">//前台记下了两位同事</span>\n    MM<span class="token punctuation">.</span><span class="token function">Attach</span><span class="token punctuation">(</span>tongshi1<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    MM<span class="token punctuation">.</span><span class="token function">Attach</span><span class="token punctuation">(</span>tongshi2<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token comment">//发现老板回来</span>\n    MM<span class="token punctuation">.</span>SecretaryAction <span class="token operator">=</span> <span class="token string">"老板回来了！"</span><span class="token punctuation">;</span>\n    <span class="token comment">//通知两个同事</span>\n    MM<span class="token punctuation">.</span><span class="token function">Notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Console<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>如果有人聊 QQ，有人看 NBA 都需要通知，如何修改？思考：违背了那些原则？</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="41141868484418270000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`//抽象观察者\nabstract class Observer\n{\n    protected string name;\n    protected Secretary sub;\n\n    public Observer(string name, Secretary sub)\n    {\n        this.name = name;\n        this.sub = sub;\n    }\n\n    public abstract void Update();\n}\n//看股票的同事\nclass StockObserver : Observer\n{\n    public StockObserver(string name, Secretary sub) : base(name, sub)\n    {\n    }\n    public override void Update()\n    {\n        Console.WriteLine(&quot;{0} {1} 关闭股票行情，继续工作！&quot;, sub.SecretaryAction, name);\n    }\n}\n\n//看NBA的同事\nclass NBAObserver : Observer\n{\n    public NBAObserver(string name, Secretary sub)  : base(name, sub)\n    {\n    }\n    public override void Update()\n    {\n        Console.WriteLine(&quot;{0} {1} 关闭NBA直播，继续工作！&quot;, sub.SecretaryAction, name);\n    }\n}\n\nclass Secretary    //前台秘书类\n{\n    //同事列表\n    private IList<Observer> observers = new List<Observer>();\n    private string action;\n\n    //增加\n    public void Attach(Observer observer)\n    {\n        observers.Add(observer);\n    }\n\n    //减少\n    public void Detach(Observer observer)\n    {\n        observers.Remove(observer);\n    }\n\n    //通知\n    public void Notify()\n    {\n        foreach (Observer o in observers)\n            o.Update();\n        …..\n    }\n}`, `41141868484418270000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp"><span class="token comment">//抽象观察者</span>\nabstract <span class="token keyword">class</span> <span class="token class-name">Observer</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">protected</span> string name<span class="token punctuation">;</span>\n    <span class="token keyword">protected</span> Secretary sub<span class="token punctuation">;</span>\n\n    <span class="token keyword">public</span> <span class="token function">Observer</span><span class="token punctuation">(</span>string name<span class="token punctuation">,</span> Secretary sub<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>sub <span class="token operator">=</span> sub<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">public</span> abstract <span class="token keyword">void</span> <span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n<span class="token comment">//看股票的同事</span>\n<span class="token keyword">class</span> <span class="token class-name">StockObserver</span> <span class="token operator">:</span> Observer\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> <span class="token function">StockObserver</span><span class="token punctuation">(</span>string name<span class="token punctuation">,</span> Secretary sub<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">base</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> sub<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> override <span class="token keyword">void</span> <span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"{0} {1} 关闭股票行情，继续工作！"</span><span class="token punctuation">,</span> sub<span class="token punctuation">.</span>SecretaryAction<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">//看NBA的同事</span>\n<span class="token keyword">class</span> <span class="token class-name">NBAObserver</span> <span class="token operator">:</span> Observer\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> <span class="token function">NBAObserver</span><span class="token punctuation">(</span>string name<span class="token punctuation">,</span> Secretary sub<span class="token punctuation">)</span>  <span class="token operator">:</span> <span class="token function">base</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> sub<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> override <span class="token keyword">void</span> <span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"{0} {1} 关闭NBA直播，继续工作！"</span><span class="token punctuation">,</span> sub<span class="token punctuation">.</span>SecretaryAction<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">class</span> <span class="token class-name">Secretary</span>    <span class="token comment">//前台秘书类</span>\n<span class="token punctuation">{</span>\n    <span class="token comment">//同事列表</span>\n    <span class="token keyword">private</span> IList<span class="token operator">&lt;</span>Observer<span class="token operator">></span> observers <span class="token operator">=</span> <span class="token keyword">new</span> List<span class="token operator">&lt;</span>Observer<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">private</span> string action<span class="token punctuation">;</span>\n\n    <span class="token comment">//增加</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Attach</span><span class="token punctuation">(</span>Observer observer<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        observers<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>observer<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token comment">//减少</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Detach</span><span class="token punctuation">(</span>Observer observer<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        observers<span class="token punctuation">.</span><span class="token function">Remove</span><span class="token punctuation">(</span>observer<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token comment">//通知</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        foreach <span class="token punctuation">(</span>Observer o in observers<span class="token punctuation">)</span>\n            o<span class="token punctuation">.</span><span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        …<span class="token punctuation">.</span><span class="token punctuation">.</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>其实作为通知者，老板、秘书、所有人都可以成为通知者，应该抽象出来</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="20086803691904430000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`//通知者接口\ninterface Subject\n{\n    void Attach(Observer observer);\n    void Detach(Observer observer);\n    void Notify();\n    string SubjectState\n    {\n        get;\n        set;\n    }\n}\nclass Secretary : Subject\n{\n    //同事列表\n    private IList<Observer> observers = new List<Observer>();\n    private string action;\n    //增加\n    public void Attach(Observer observer)\n    {\n        observers.Add(observer);\n    }\n    //减少\n    public void Detach(Observer observer)\n    {\n        observers.Remove(observer);\n    }\n    //通知\n    public void Notify()\n    {\n        foreach (Observer o in observers)\n            o.Update();\n    }\n    //前台状态\n    public string SubjectState\n    {\n        get { return action; }\n        set { action = value; }\n    }\n}\nclass Boss : Subject\n{\n    //同事列表\n    private IList<Observer> observers = new List<Observer>();\n    private string action;\n    //增加\n    public void Attach(Observer observer)\n    {\n        observers.Add(observer);\n    }\n    //减少\n    public void Detach(Observer observer)\n    {\n        observers.Remove(observer);\n    }\n    //通知\n    public void Notify()\n    {\n        foreach (Observer o in observers)\n            o.Update();\n    }\n    //老板状态\n    public string SubjectState\n    {\n        get { return action; }\n        set { action = value; }\n    }\n}\nstatic void Main(string[] args)\n{\n    //老板胡汉三\n    Boss huhansan = new Boss();\n\n    //看股票的同事\n    StockObserver tongshi1 = new StockObserver(&quot;魏关姹&quot;, huhansan);\n    //看NBA的同事\n    NBAObserver tongshi2 = new NBAObserver(&quot;易管查&quot;, huhansan);\n\n    huhansan.Attach(tongshi1);\n    huhansan.Attach(tongshi2);\n\n    huhansan.Detach(tongshi1);\n\n    //老板回来\n    huhansan.SubjectState = &quot;我胡汉三回来了！&quot;;\n    //发出通知\n    huhansan.Notify();\n\n    Console.Read();\n}`, `20086803691904430000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp"><span class="token comment">//通知者接口</span>\ninterface Subject\n<span class="token punctuation">{</span>\n    <span class="token keyword">void</span> <span class="token function">Attach</span><span class="token punctuation">(</span>Observer observer<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">void</span> <span class="token function">Detach</span><span class="token punctuation">(</span>Observer observer<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">void</span> <span class="token function">Notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    string SubjectState\n    <span class="token punctuation">{</span>\n        get<span class="token punctuation">;</span>\n        set<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">class</span> <span class="token class-name">Secretary</span> <span class="token operator">:</span> Subject\n<span class="token punctuation">{</span>\n    <span class="token comment">//同事列表</span>\n    <span class="token keyword">private</span> IList<span class="token operator">&lt;</span>Observer<span class="token operator">></span> observers <span class="token operator">=</span> <span class="token keyword">new</span> List<span class="token operator">&lt;</span>Observer<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">private</span> string action<span class="token punctuation">;</span>\n    <span class="token comment">//增加</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Attach</span><span class="token punctuation">(</span>Observer observer<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        observers<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>observer<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token comment">//减少</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Detach</span><span class="token punctuation">(</span>Observer observer<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        observers<span class="token punctuation">.</span><span class="token function">Remove</span><span class="token punctuation">(</span>observer<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token comment">//通知</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        foreach <span class="token punctuation">(</span>Observer o in observers<span class="token punctuation">)</span>\n            o<span class="token punctuation">.</span><span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token comment">//前台状态</span>\n    <span class="token keyword">public</span> string SubjectState\n    <span class="token punctuation">{</span>\n        get <span class="token punctuation">{</span> <span class="token keyword">return</span> action<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n        set <span class="token punctuation">{</span> action <span class="token operator">=</span> value<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">class</span> <span class="token class-name">Boss</span> <span class="token operator">:</span> Subject\n<span class="token punctuation">{</span>\n    <span class="token comment">//同事列表</span>\n    <span class="token keyword">private</span> IList<span class="token operator">&lt;</span>Observer<span class="token operator">></span> observers <span class="token operator">=</span> <span class="token keyword">new</span> List<span class="token operator">&lt;</span>Observer<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">private</span> string action<span class="token punctuation">;</span>\n    <span class="token comment">//增加</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Attach</span><span class="token punctuation">(</span>Observer observer<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        observers<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>observer<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token comment">//减少</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Detach</span><span class="token punctuation">(</span>Observer observer<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        observers<span class="token punctuation">.</span><span class="token function">Remove</span><span class="token punctuation">(</span>observer<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token comment">//通知</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        foreach <span class="token punctuation">(</span>Observer o in observers<span class="token punctuation">)</span>\n            o<span class="token punctuation">.</span><span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token comment">//老板状态</span>\n    <span class="token keyword">public</span> string SubjectState\n    <span class="token punctuation">{</span>\n        get <span class="token punctuation">{</span> <span class="token keyword">return</span> action<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n        set <span class="token punctuation">{</span> action <span class="token operator">=</span> value<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">Main</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    <span class="token comment">//老板胡汉三</span>\n    Boss huhansan <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Boss</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">//看股票的同事</span>\n    StockObserver tongshi1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">StockObserver</span><span class="token punctuation">(</span><span class="token string">"魏关姹"</span><span class="token punctuation">,</span> huhansan<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token comment">//看NBA的同事</span>\n    NBAObserver tongshi2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">NBAObserver</span><span class="token punctuation">(</span><span class="token string">"易管查"</span><span class="token punctuation">,</span> huhansan<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    huhansan<span class="token punctuation">.</span><span class="token function">Attach</span><span class="token punctuation">(</span>tongshi1<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    huhansan<span class="token punctuation">.</span><span class="token function">Attach</span><span class="token punctuation">(</span>tongshi2<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    huhansan<span class="token punctuation">.</span><span class="token function">Detach</span><span class="token punctuation">(</span>tongshi1<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">//老板回来</span>\n    huhansan<span class="token punctuation">.</span>SubjectState <span class="token operator">=</span> <span class="token string">"我胡汉三回来了！"</span><span class="token punctuation">;</span>\n    <span class="token comment">//发出通知</span>\n    huhansan<span class="token punctuation">.</span><span class="token function">Notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Console<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/微信截图_20180417181530-35ae6c87e5d3ea96792a9f7a1cb46c36-2b001.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 38.95169578622816%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABvklEQVQoz41SPUjCURB/pRaEWxEE4dBiiOXQVoODoUFITo0ugbQ5Nbo1NloUNDm5RIMNagkigojgN36h+K35LWmSabx+7/EfaokOHnfv7t7vfnf3SLVaFRFIpVIxdjqdz2Aw2E2lUsPBYPAKvc1ilNIFQTNF6vX6OmIGn89nyGazR+12m2Pk83lC0uk0vyQSifPRaERnsxllMplMKB7ssZhWq12GEptMpiUh96RcLtNisUhBZFwqlaTMDx8huVxOwi7RaPQ0mUy+dbvdDMDKvV6v5HK5lCym0+lWoCRqtZrnOp3OTa/Xewamx4FAwAhSYjAVhUIh8kv0ev2qYIrlcrn0Z8xsNi+S/wiQFWC2Y7fbVbVaTRGLxTbQggw+pc1mU6GtXbS+xXL9fr8sHo9fud3um0gkctlsNjVgZfV4PNeZTOaCzxjO9/F4TEGfz65QKNzD9jIb8/kS9JMAuI+R8DwUnwPcMp1O+R3zq3OGcA4Z4EzYRqPRuA2Hw8/z+ZzifDBfq9V6ZLlWq3UN7DQoqsXvOHA4HDL8Cg1IHaIAXyAB1SEeUFTigP1+/w5bfGEbnwrlYT+wXIvF8uccWcvfG09de25RYCwAAAAASUVORK5CYII=\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;"\n        alt="     20180417181530"\n        title=""\n        src="/static/微信截图_20180417181530-35ae6c87e5d3ea96792a9f7a1cb46c36-fee1c.png"\n        srcset="/static/微信截图_20180417181530-35ae6c87e5d3ea96792a9f7a1cb46c36-a67b7.png 200w,\n/static/微信截图_20180417181530-35ae6c87e5d3ea96792a9f7a1cb46c36-0b187.png 400w,\n/static/微信截图_20180417181530-35ae6c87e5d3ea96792a9f7a1cb46c36-fee1c.png 800w,\n/static/微信截图_20180417181530-35ae6c87e5d3ea96792a9f7a1cb46c36-2b001.png 973w"\n        sizes="(max-width: 800px) 100vw, 800px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<h3 id="模式动机-1"><a href="#%E6%A8%A1%E5%BC%8F%E5%8A%A8%E6%9C%BA-1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式动机</h3>\n<p>建立一种对象与对象之间的依赖关系，一个对象发生改变时将自动通知其他对象，其他对象将相应做出反应。在此，发生改变的对象称为观察目标，而被通知的对象称为观察者，一个观察目标可以对应多个观察者，而且这些观察者之间没有相互联系，可以根据需要增加和删除观察者，使得系统更易于扩展，这就是观察者模式的模式动机。</p>\n<h3 id="模式定义-1"><a href="#%E6%A8%A1%E5%BC%8F%E5%AE%9A%E4%B9%89-1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式定义</h3>\n<ul>\n<li>观察者模式(Observer Pattern)：定义对象间的一种一对多依赖关系，使得每当一个对象状态发生改变时，其相关依赖对象皆得到通知并被自动更新。</li>\n<li>观察者模式又叫做发布-订阅（Publish/Subscribe）模式、模型-视图（Model/View）模式、源-监听器（Source/Listener）模式或从属者（Dependents）模式。观察者模式是一种对象行为型模式。</li>\n</ul>\n<h3 id="模式结构-1"><a href="#%E6%A8%A1%E5%BC%8F%E7%BB%93%E6%9E%84-1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式结构</h3>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/微信截图_20180417235401-b46b63c5eb92857dd412115bafda9746-6b9f0.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 56.75074183976261%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABnWAAAZ1gEY0crtAAACIklEQVQoz31TOYhaURT96ozjZEwfBiYEglVAnMAEbCQhoAYEK7t0tpZikdaZImBlilSCaCEB0UIRRKKooIjgLiKC4664Rf24oN95uVfGj2OWC5d3//vnnbu886hyufyl2+3eZbNZYzqdNrbb7dt6vW6Mx+MvKTBCCHVscIYfjUaFyWTyIp/PCxOJhIDFAsEWArJarchiscCQMAxDgPADgnQ63SksXHSDwYAxVSqVbhuNxiSTydyD/arVaj9Ywmq1Ouj1eoSmaWa9Xm+A+GE2mzHhcPg9gqRS6TksZ+gqleoZ7hUKBcc+MVq/38+whJDtHjLQ0+mU3mw2CwBNlsvlpFKpvHsEcfat7tuPxWJyaPMulUrZWq3WV8B+Zv87HI4rv99/abVab+x2+yev1/vC6XS+MpvNWBWl0WiezC8YDHIOPp8fJzu2QzBls9nYWKvVsoewariYE5FIJICYC85jSWH4PNzQ6/V8uVx+gQDYOwkEArvDoVBot0IXVLFY3N8yx+128yQSiXA+n3MjkQjnf1WyZjKZ/tizWCx/xbJkoKM3uVxODLO5hqw38C2GIYtBi+f/SgQdXALurcvlQvw1XNJrlhT0NBsOh6TZbBKISafTIaPRiPh8vo8IUiqVeDmov1O1Wi14JPw+GAwIjICg5EAp0UMd9sfjMWqJAeItaHAL4AePx7MjlMlkWCkfXaFQ7KqGF/UNCeFRLPExQBE/94S/AURMi9jQ8g7/AAAAAElFTkSuQmCC\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;"\n        alt="     20180417235401"\n        title=""\n        src="/static/微信截图_20180417235401-b46b63c5eb92857dd412115bafda9746-fee1c.png"\n        srcset="/static/微信截图_20180417235401-b46b63c5eb92857dd412115bafda9746-a67b7.png 200w,\n/static/微信截图_20180417235401-b46b63c5eb92857dd412115bafda9746-0b187.png 400w,\n/static/微信截图_20180417235401-b46b63c5eb92857dd412115bafda9746-fee1c.png 800w,\n/static/微信截图_20180417235401-b46b63c5eb92857dd412115bafda9746-b1a91.png 1200w,\n/static/微信截图_20180417235401-b46b63c5eb92857dd412115bafda9746-6b9f0.png 1348w"\n        sizes="(max-width: 800px) 100vw, 800px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<ul>\n<li>Subject：目标（被观察对象）</li>\n<li>ConcreteSubject：具体目标</li>\n<li>Observer：观察者</li>\n<li>ConcreteObserver：具体观察者</li>\n</ul>\n<p>注册的投资者在股票市场发生变化时，可以自动得到通知</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="85092738797532800000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`abstract class Stock\n{\n    // Fields\n    protected string symbol;\n    protected double price;\n    private ArrayList investors = new ArrayList();\n\n    // Constructor\n    public Stock( string symbol, double price )\n    {\n        this.symbol = symbol;\n        this.price = price;\n    }\n\n    // Properties\n    public double Price\n    {\n        get{ return price; }\n        set\n        {\n            price = value;\n            Notify();\n        }\n    }\n\n    public string Symbol\n    {\n        get{ return symbol; }\n        set{ symbol = value; }\n    }\n\n    // Methods\n    public void Attach( Investor investor )\n    {\n        investors.Add( investor );\n    }\n\n    public void Detach( Investor investor )\n    {\n        investors.Remove( investor );\n    }\n\n    public void Notify()\n    {\n        foreach( Investor i in investors )\n        i.Update( this );\n    }\n\n}\n\n\n// &quot;ConcreteSubject&quot;\nclass IBM : Stock\n{\n    // Constructor\n    public IBM( string symbol, double price )\n        : base( symbol, price ) {}\n}\n\n// &quot;Observer&quot;\ninterface IInvestor\n{\n    // Methods\n    void Update( Stock stock );\n}\n\n// &quot;ConcreteObserver&quot;\nclass Investor : IInvestor\n{\n    // Fields\n    private string name;\n    private string observerState;\n    private Stock stock;\n\n    // Constructors\n    public Investor( string name )\n    {\n        this.name = name;\n    }\n\n    // Methods\n    public void Update( Stock stock )\n    {\n        Console.WriteLine( &quot;Notified investor {0} of {1}\'s change to {2:C}&quot;,\n        name, stock.Symbol, stock.Price );\n    }\n\n    // Properties\n    public Stock Stock\n    {\n        get{ return stock; }\n        set{ stock = value; }\n    }\n}\n\npublic static void Main( string[] args )\n{\n    // Create investors\n    Investor s = new Investor( &quot;Sorros&quot; );\n    Investor b = new Investor( &quot;Berkshire&quot; );\n\n    // Create IBM stock and attach investors\n    IBM ibm = new IBM( &quot;IBM&quot;, 120.00 );\n    ibm.Attach( s );\n    ibm.Attach( b );\n\n    // Change price, which notifies investors\n    ibm.Price = 120.10;\n    ibm.Price = 121.00;\n    ibm.Price = 120.50;\n    ibm.Price = 120.75;\n}`, `85092738797532800000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp">abstract <span class="token keyword">class</span> <span class="token class-name">Stock</span>\n<span class="token punctuation">{</span>\n    <span class="token comment">// Fields</span>\n    <span class="token keyword">protected</span> string symbol<span class="token punctuation">;</span>\n    <span class="token keyword">protected</span> <span class="token keyword">double</span> price<span class="token punctuation">;</span>\n    <span class="token keyword">private</span> ArrayList investors <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">ArrayList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// Constructor</span>\n    <span class="token keyword">public</span> <span class="token function">Stock</span><span class="token punctuation">(</span> string symbol<span class="token punctuation">,</span> <span class="token keyword">double</span> price <span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>symbol <span class="token operator">=</span> symbol<span class="token punctuation">;</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>price <span class="token operator">=</span> price<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token comment">// Properties</span>\n    <span class="token keyword">public</span> <span class="token keyword">double</span> Price\n    <span class="token punctuation">{</span>\n        get<span class="token punctuation">{</span> <span class="token keyword">return</span> price<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n        set\n        <span class="token punctuation">{</span>\n            price <span class="token operator">=</span> value<span class="token punctuation">;</span>\n            <span class="token function">Notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">public</span> string Symbol\n    <span class="token punctuation">{</span>\n        get<span class="token punctuation">{</span> <span class="token keyword">return</span> symbol<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n        set<span class="token punctuation">{</span> symbol <span class="token operator">=</span> value<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token comment">// Methods</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Attach</span><span class="token punctuation">(</span> Investor investor <span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        investors<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span> investor <span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Detach</span><span class="token punctuation">(</span> Investor investor <span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        investors<span class="token punctuation">.</span><span class="token function">Remove</span><span class="token punctuation">(</span> investor <span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token function">foreach</span><span class="token punctuation">(</span> Investor i in investors <span class="token punctuation">)</span>\n        i<span class="token punctuation">.</span><span class="token function">Update</span><span class="token punctuation">(</span> <span class="token keyword">this</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n<span class="token punctuation">}</span>\n\n\n<span class="token comment">// "ConcreteSubject"</span>\n<span class="token keyword">class</span> <span class="token class-name">IBM</span> <span class="token operator">:</span> Stock\n<span class="token punctuation">{</span>\n    <span class="token comment">// Constructor</span>\n    <span class="token keyword">public</span> <span class="token function">IBM</span><span class="token punctuation">(</span> string symbol<span class="token punctuation">,</span> <span class="token keyword">double</span> price <span class="token punctuation">)</span>\n        <span class="token operator">:</span> <span class="token function">base</span><span class="token punctuation">(</span> symbol<span class="token punctuation">,</span> price <span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// "Observer"</span>\ninterface IInvestor\n<span class="token punctuation">{</span>\n    <span class="token comment">// Methods</span>\n    <span class="token keyword">void</span> <span class="token function">Update</span><span class="token punctuation">(</span> Stock stock <span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// "ConcreteObserver"</span>\n<span class="token keyword">class</span> <span class="token class-name">Investor</span> <span class="token operator">:</span> IInvestor\n<span class="token punctuation">{</span>\n    <span class="token comment">// Fields</span>\n    <span class="token keyword">private</span> string name<span class="token punctuation">;</span>\n    <span class="token keyword">private</span> string observerState<span class="token punctuation">;</span>\n    <span class="token keyword">private</span> Stock stock<span class="token punctuation">;</span>\n\n    <span class="token comment">// Constructors</span>\n    <span class="token keyword">public</span> <span class="token function">Investor</span><span class="token punctuation">(</span> string name <span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token comment">// Methods</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Update</span><span class="token punctuation">(</span> Stock stock <span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span> <span class="token string">"Notified investor {0} of {1}\'s change to {2:C}"</span><span class="token punctuation">,</span>\n        name<span class="token punctuation">,</span> stock<span class="token punctuation">.</span>Symbol<span class="token punctuation">,</span> stock<span class="token punctuation">.</span>Price <span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token comment">// Properties</span>\n    <span class="token keyword">public</span> Stock Stock\n    <span class="token punctuation">{</span>\n        get<span class="token punctuation">{</span> <span class="token keyword">return</span> stock<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n        set<span class="token punctuation">{</span> stock <span class="token operator">=</span> value<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">Main</span><span class="token punctuation">(</span> string<span class="token punctuation">[</span><span class="token punctuation">]</span> args <span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    <span class="token comment">// Create investors</span>\n    Investor s <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Investor</span><span class="token punctuation">(</span> <span class="token string">"Sorros"</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>\n    Investor b <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Investor</span><span class="token punctuation">(</span> <span class="token string">"Berkshire"</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// Create IBM stock and attach investors</span>\n    IBM ibm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">IBM</span><span class="token punctuation">(</span> <span class="token string">"IBM"</span><span class="token punctuation">,</span> <span class="token number">120.00</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>\n    ibm<span class="token punctuation">.</span><span class="token function">Attach</span><span class="token punctuation">(</span> s <span class="token punctuation">)</span><span class="token punctuation">;</span>\n    ibm<span class="token punctuation">.</span><span class="token function">Attach</span><span class="token punctuation">(</span> b <span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// Change price, which notifies investors</span>\n    ibm<span class="token punctuation">.</span>Price <span class="token operator">=</span> <span class="token number">120.10</span><span class="token punctuation">;</span>\n    ibm<span class="token punctuation">.</span>Price <span class="token operator">=</span> <span class="token number">121.00</span><span class="token punctuation">;</span>\n    ibm<span class="token punctuation">.</span>Price <span class="token operator">=</span> <span class="token number">120.50</span><span class="token punctuation">;</span>\n    ibm<span class="token punctuation">.</span>Price <span class="token operator">=</span> <span class="token number">120.75</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="模式分析"><a href="#%E6%A8%A1%E5%BC%8F%E5%88%86%E6%9E%90" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式分析</h3>\n<ul>\n<li>观察者模式描述了如何建立对象与对象之间的依赖关系，如何构造满足这种需求的系统。</li>\n<li>这一模式中的关键对象是观察目标和观察者，一个目标可以有任意数目的与之相依赖的观察者，一旦目标的状态发生改变，所有的观察者都将得到通知。</li>\n<li>作为对这个通知的响应，每个观察者都将即时更新自己的状态，以与目标状态同步，这种交互也称为发布-订阅(publish-subscribe)。目标是通知的发布者，它发出通知时并不需要知道谁是它的观察者，可以有任意数目的观察者订阅它并接收通知。</li>\n</ul>\n<h3 id="优缺点-1"><a href="#%E4%BC%98%E7%BC%BA%E7%82%B9-1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>优缺点</h3>\n<ul>\n<li>优点</li>\n<li>观察者模式可以实现表示层和数据逻辑层的分离，并定义了稳定的消息更新传递机制，抽象了更新接口，使得可以有各种各样不同的表示层作为具体观察者角色。</li>\n<li>观察者模式在观察目标和观察者之间建立一个抽象的耦合。</li>\n<li>观察者模式支持广播通信。</li>\n<li>观察者模式符合“开闭原则”的要求。</li>\n<li>缺点</li>\n<li>如果一个观察目标对象有很多直接和间接的观察者的话，将所有的观察者都通知到会花费很多时间。</li>\n<li>如果在观察者和观察目标之间有循环依赖的话，观察目标会触发它们之间进行循环调用，可能导致系统崩溃。</li>\n<li>观察者模式没有相应的机制让观察者知道所观察的目标对象是怎么发生变化的，而仅仅只是知道观察目标发生了变化。</li>\n</ul>\n<h3 id="模式使用-1"><a href="#%E6%A8%A1%E5%BC%8F%E4%BD%BF%E7%94%A8-1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式使用</h3>\n<ul>\n<li>一个抽象模型有两个方面，其中一个方面依赖于另一个方面。将这些方面封装在独立的对象中使它们可以各自独立地改变和复用。</li>\n<li>一个对象的改变将导致其他一个或多个对象也发生改变，而不知道具体有多少对象将发生改变，可以降低对象之间的耦合度。</li>\n<li>一个对象必须通知其他对象，而并不知道这些对象是谁。</li>\n<li>需要在系统中创建一个触发链，A 对象的行为将影响 B 对象，B 对象的行为将影响 C 对象……，可以使用观察者模式创建一种链式触发机制。</li>\n</ul>\n<h3 id="模式应用-1"><a href="#%E6%A8%A1%E5%BC%8F%E5%BA%94%E7%94%A8-1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式应用</h3>\n<ul>\n<li>JDK1.1 版本及以后的各个版本中，事件处理模型采用基于观察者模式的委派事件模型(Delegation Event Model, DEM)。</li>\n<li>在 DEM 中，事件的发布者称为事件源(Event Source)，而订阅者叫做事件监听器(Event Listener)，在这个过程中还可以通过事件对象(Event Object)来传递与事件相关的信息，事件源对象、事件监听对象（事件处理对象）和事件对象构成了 Java 事件处理模型的三要素。</li>\n<li>观察者模式在软件开发中应用非常广泛，如某电子商务网站可以在执行发送操作后给用户多个发送商品打折信息，某团队战斗游戏中某队友牺牲将给所有成员提示等等，凡是涉及到一对一或者一对多的对象交互场景都可以使用观察者模式。</li>\n</ul>\n<h2 id="状态模式state"><a href="#%E7%8A%B6%E6%80%81%E6%A8%A1%E5%BC%8Fstate" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>状态模式(State)</h2>\n<p>当一个对象的内在状态改变时允许改变其行为，这个对象看起来像是改变了其类。</p>\n<h3 id="模式背景-2"><a href="#%E6%A8%A1%E5%BC%8F%E8%83%8C%E6%99%AF-2" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式背景</h3>\n<p>又要加班了?(工作状态函数)</p>\n<ul>\n<li>上午工作状态 ( h&#x3C;12 点 )</li>\n<li>中午工作状态 ( 12&#x3C;h&#x3C;13 点 )</li>\n<li>下午工作状态 ( 13&#x3C;h&#x3C;17 点 )</li>\n<li>晚间工作状态 ( 17&#x3C;h&#x3C;21 点 )</li>\n<li>睡眠状态 ( h>21 点 )</li>\n<li>下班状态</li>\n</ul>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="12922507155612672000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`public static void WriteProgram()\n{\n    if (Hour < 12)\n    {\n        Console.WriteLine(&quot;当前时间：{0}点 上午工作，精神百倍&quot;, Hour);\n    }\n    else if (Hour < 13)\n    {\n        Console.WriteLine(&quot;当前时间：{0}点 饿了，午饭；犯困，午休。&quot;, Hour);\n    }\n    else if (Hour < 17)\n    {\n        Console.WriteLine(&quot;当前时间：{0}点 下午状态还不错，继续努力&quot;, Hour);\n    }\n    else\n    {\n        if (WorkFinished)\n        {\n            Console.WriteLine(&quot;当前时间：{0}点 下班回家了&quot;, Hour);\n        }\n        else\n        {\n            if (Hour < 21)\n            {\n                Console.WriteLine(&quot;当前时间：{0}点 加班哦，疲累之极&quot;, Hour);\n            }\n            else\n            {\n                Console.WriteLine(&quot;当前时间：{0}点 不行了，睡着了。&quot;, Hour);\n            }\n        }\n    }\n}\n\nstatic int Hour = 0;\nstatic bool WorkFinished = false;\n\nstatic void Main(string[] args)\n{\n    Hour = 9;\n    WriteProgram();\n    Hour = 10;\n    WriteProgram();\n    Hour = 12;\n    WriteProgram();\n    Hour = 13;\n    WriteProgram();\n    Hour = 14;\n    WriteProgram();\n    Hour = 17;\n\n    WorkFinished = true; // false;\n\n    WriteProgram();\n    Hour = 19;\n    WriteProgram();\n    Hour = 22;\n    WriteProgram();\n\n    Console.Read();\n}`, `12922507155612672000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">WriteProgram</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">if</span> <span class="token punctuation">(</span>Hour <span class="token operator">&lt;</span> <span class="token number">12</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"当前时间：{0}点 上午工作，精神百倍"</span><span class="token punctuation">,</span> Hour<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>Hour <span class="token operator">&lt;</span> <span class="token number">13</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"当前时间：{0}点 饿了，午饭；犯困，午休。"</span><span class="token punctuation">,</span> Hour<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>Hour <span class="token operator">&lt;</span> <span class="token number">17</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"当前时间：{0}点 下午状态还不错，继续努力"</span><span class="token punctuation">,</span> Hour<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">else</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">if</span> <span class="token punctuation">(</span>WorkFinished<span class="token punctuation">)</span>\n        <span class="token punctuation">{</span>\n            Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"当前时间：{0}点 下班回家了"</span><span class="token punctuation">,</span> Hour<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n        <span class="token keyword">else</span>\n        <span class="token punctuation">{</span>\n            <span class="token keyword">if</span> <span class="token punctuation">(</span>Hour <span class="token operator">&lt;</span> <span class="token number">21</span><span class="token punctuation">)</span>\n            <span class="token punctuation">{</span>\n                Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"当前时间：{0}点 加班哦，疲累之极"</span><span class="token punctuation">,</span> Hour<span class="token punctuation">)</span><span class="token punctuation">;</span>\n            <span class="token punctuation">}</span>\n            <span class="token keyword">else</span>\n            <span class="token punctuation">{</span>\n                Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"当前时间：{0}点 不行了，睡着了。"</span><span class="token punctuation">,</span> Hour<span class="token punctuation">)</span><span class="token punctuation">;</span>\n            <span class="token punctuation">}</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">static</span> <span class="token keyword">int</span> Hour <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>\n<span class="token keyword">static</span> <span class="token keyword">bool</span> WorkFinished <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>\n\n<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">Main</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    Hour <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">;</span>\n    <span class="token function">WriteProgram</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    Hour <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>\n    <span class="token function">WriteProgram</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    Hour <span class="token operator">=</span> <span class="token number">12</span><span class="token punctuation">;</span>\n    <span class="token function">WriteProgram</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    Hour <span class="token operator">=</span> <span class="token number">13</span><span class="token punctuation">;</span>\n    <span class="token function">WriteProgram</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    Hour <span class="token operator">=</span> <span class="token number">14</span><span class="token punctuation">;</span>\n    <span class="token function">WriteProgram</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    Hour <span class="token operator">=</span> <span class="token number">17</span><span class="token punctuation">;</span>\n\n    WorkFinished <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">// false;</span>\n\n    <span class="token function">WriteProgram</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    Hour <span class="token operator">=</span> <span class="token number">19</span><span class="token punctuation">;</span>\n    <span class="token function">WriteProgram</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    Hour <span class="token operator">=</span> <span class="token number">22</span><span class="token punctuation">;</span>\n    <span class="token function">WriteProgram</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Console<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>面向过程的思维，通过面向对象完成代码的责任分解</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="45195783435407820000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`public class Work   //工作\n{\n    //钟点\n    private int hour;\n    public int Hour\n    {\n        get { return hour; }\n        set { hour = value; }\n    }\n\n    //任务完成\n    private bool finish = false;\n    public bool TaskFinished\n    {\n        get { return finish; }\n        set { finish = value; }\n    }\n\n\n    public void WriteProgram()\n    {\n        ……\n    }\n}\n\nstatic void Main(string[] args)\n{\n    Work MisProject = new Work();\n    MisProject.Hour = 10;\n    MisProject.WriteProgram();\n\n    Work MisProject = new Work();\n    MisProject.Hour = 13;\n    MisProject.WriteProgram();\n\n    Work MisProject = new Work();\n    MisProject.Hour = 16;\n    MisProject.WriteProgram();\n\n    Console.Read();\n}`, `45195783435407820000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Work</span>   <span class="token comment">//工作</span>\n<span class="token punctuation">{</span>\n    <span class="token comment">//钟点</span>\n    <span class="token keyword">private</span> <span class="token keyword">int</span> hour<span class="token punctuation">;</span>\n    <span class="token keyword">public</span> <span class="token keyword">int</span> Hour\n    <span class="token punctuation">{</span>\n        get <span class="token punctuation">{</span> <span class="token keyword">return</span> hour<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n        set <span class="token punctuation">{</span> hour <span class="token operator">=</span> value<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token comment">//任务完成</span>\n    <span class="token keyword">private</span> <span class="token keyword">bool</span> finish <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>\n    <span class="token keyword">public</span> <span class="token keyword">bool</span> TaskFinished\n    <span class="token punctuation">{</span>\n        get <span class="token punctuation">{</span> <span class="token keyword">return</span> finish<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n        set <span class="token punctuation">{</span> finish <span class="token operator">=</span> value<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n\n\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">WriteProgram</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        ……\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">Main</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    Work MisProject <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Work</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    MisProject<span class="token punctuation">.</span>Hour <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>\n    MisProject<span class="token punctuation">.</span><span class="token function">WriteProgram</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Work MisProject <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Work</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    MisProject<span class="token punctuation">.</span>Hour <span class="token operator">=</span> <span class="token number">13</span><span class="token punctuation">;</span>\n    MisProject<span class="token punctuation">.</span><span class="token function">WriteProgram</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Work MisProject <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Work</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    MisProject<span class="token punctuation">.</span>Hour <span class="token operator">=</span> <span class="token number">16</span><span class="token punctuation">;</span>\n    MisProject<span class="token punctuation">.</span><span class="token function">WriteProgram</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Console<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>过多的判断分支，说明类的责任过大，无论何种状态改变，都需要通过它来改变，违背的原则？</p>\n<h3 id="模式动机-2"><a href="#%E6%A8%A1%E5%BC%8F%E5%8A%A8%E6%9C%BA-2" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式动机</h3>\n<ul>\n<li>在很多情况下，一个对象的行为取决于一个或多个动态变化的属性，这样的属性叫做状态，这样的对象叫做有状态的(stateful)对象。这样的对象状态是从事先定义好的一系列值中取出的。当一个这样的对象与外部事件产生互动时，其内部状态就会改变，从而使得系统的行为也随之发生变化。</li>\n<li>考虑一个银行系统，一个账户对象的状态处于若干个不同状态之一：开户状态、正常状态、透支状态、冻结状态。当顾客在对账户进行存取款操作时，账户类根据自身的当前状态作出不同的反应，同时进行对象状态的切换。例如：如果账户处于冻结状态就没有办法再进行取款操作，一个取款操作需要先了解账户对象的状态。</li>\n<li>状态(State)模式描述了账户如何在每一种状态下表现出不同的行为。而一旦取款操作完成，对象的状态也将动态发生变化，如取款后账户余额低于某一值其状态可能从正常状态转为透支状态。</li>\n<li>状态模式的关键是引入了一个抽象类来专门表示对象的状态，这个类我们叫做状态类，而对象的具体状态都继承了该类，并在不同具体状态类中实现了不同状态的行为，包括各种状态之间的转换。</li>\n</ul>\n<h3 id="模式定义-2"><a href="#%E6%A8%A1%E5%BC%8F%E5%AE%9A%E4%B9%89-2" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式定义</h3>\n<p>允许一个对象在其内部状态改变时改变它的行为，对象看起来似乎修改了它的类。其别名为状态对象(Objects for States)。状态模式是一种对象行为型模式。</p>\n<p>当一个对象的行为取决于它的状态，并且在运行时需要根据状态改变行为的时候，将特定状态的相关行为放到一个对象中，可以通过定义新的子类增加新的状态和转换。</p>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/微信截图_20180418005947-f4c2c5868f9f38a32fbcf5e7f847099e-1b1db.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 48.0911330049261%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABnWAAAZ1gEY0crtAAACC0lEQVQoz4VSS4uSURj+ymaQr7USZCCF0CJwoIXgokWLIQxaCCIlGUFQMUwSJC6FNtFlk/0AazWElPqFixDcKSjexSveBRVvhUwpeDk979c3w0w1dOBwzvuc8z7neZ/3cP1+/02xWHw5GAzeJpPJaxxGJBI5zf1jMMZOcf8bq9WKHYx8Pv+cML1eLzcYDPJGo3Enl8s9KJVKO9Vq9eoBKc/zJxMiic1mM5GwUCg8JkytVvNGo/Fcp9M5fKzdbr+js8VisWE2mzmbzcYpFIq/CUnBZDK5PxqNHqL0y4TpdDpZOBzmM5nMKzzyFecCyG9JCmWYtB5yaDSakxVrtdqzWDaOQBSTp2cwZX9c31QqlccxNOMDPPqIhnxB+TbCstnsNhR9SqfTe9h/hsobhHe73d1ms+mD+j3kvXe73Sp6hHxVqVS/CafTKVsul6JPIBEIK5fLjyiGXyKOhuxIfvsoXq/XbD6fM0EQLh4VFwqFOC4Wi92Fd9Zer7ebSCTuWSwWldfrNUCFHY243Wq17H6//6bJZDofDAat8Xj8Ce5aa7Wa3eVybTkcjkv4ZhecTufxL5VKpa6gjG8o6ScSGMp7RjgIn2LP6vX6D1TwHfGWZJWPfgiIl9i3AoGAXCSCqk1ao9HodShdI2mfLKhUKq8lP1/QA8PhcB+JDPe3pd8RRgVsPB4vsbY9Ho9I+AunwHHTBYoBpQAAAABJRU5ErkJggg==\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;"\n        alt="     20180418005947"\n        title=""\n        src="/static/微信截图_20180418005947-f4c2c5868f9f38a32fbcf5e7f847099e-fee1c.png"\n        srcset="/static/微信截图_20180418005947-f4c2c5868f9f38a32fbcf5e7f847099e-a67b7.png 200w,\n/static/微信截图_20180418005947-f4c2c5868f9f38a32fbcf5e7f847099e-0b187.png 400w,\n/static/微信截图_20180418005947-f4c2c5868f9f38a32fbcf5e7f847099e-fee1c.png 800w,\n/static/微信截图_20180418005947-f4c2c5868f9f38a32fbcf5e7f847099e-b1a91.png 1200w,\n/static/微信截图_20180418005947-f4c2c5868f9f38a32fbcf5e7f847099e-95179.png 1600w,\n/static/微信截图_20180418005947-f4c2c5868f9f38a32fbcf5e7f847099e-1b1db.png 1624w"\n        sizes="(max-width: 800px) 100vw, 800px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="15701029168157720000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`public class Work    //工作\n{\n    private State current;\n    public Work()\n    {\n        current = new ForenoonState();\n    }\n\n    private double hour;\n    public double Hour\n    {\n        get { return hour; }\n        set { hour = value; }\n    }\n\n    private bool finish = false;\n    public bool TaskFinished\n    {\n        get { return finish; }\n        set { finish = value; }\n    }\n\n    public void SetState(State s)\n    {\n        current = s;\n    }\n\n    public void WordHard()\n    {\n        current.WriteProgram(this);\n    }\n}\n\npublic abstract class State     //抽象状态\n{\n    public abstract void WriteProgram(Work w);\n}\npublic class ForenoonState : State     //上午工作状态\n{\n    public override void WriteProgram(Work w)\n    {\n        if (w.Hour < 12)\n        {\n            Console.WriteLine(&quot;当前时间：{0}点 上午工作，精神百倍&quot;, w.Hour);\n        }\n        else\n        {\n            w.SetState(new NoonState());\n            w.WorkHard();\n        }\n    }\n}\npublic class NoonState : State     //中午工作状态\n{\n    public override void WriteProgram(Work w)\n    {\n        if (w.Hour < 13)\n        {\n            Console.WriteLine(&quot;当前时间：{0}点 饿了，午饭；犯困，午休。&quot;, w.Hour);\n        }\n        else\n        {\n            w.SetState(new AfternoonState());\n            w.WorkHard();\n        }\n    }\n}\n\nstatic void Main(string[] args)\n{\n    //紧急项目\n    Work EmProject = new Work();\n    EmProject.Hour = 9;\n    EmProject.WorkHard();\n    EmProject.Hour = 10;\n    EmProject.WorkHard();\n    EmProject.Hour = 12;\n    EmProject.WorkHard();\n    EmProject.Hour = 13;\n    EmProject.WorkHard();\n    EmProject.Hour = 14;\n    EmProject.WorkHard();\n    EmProject.Hour = 17;\n\n    EmProject.TaskFinished = true;\n    // EmProject.TaskFinished = false;\n\n    EmProject.WriteProgram();\n    EmProject.Hour = 19;\n    EmProject.WriteProgram();\n    EmProject.Hour = 22;\n    EmProject.WriteProgram();\n\n    Console.Read();\n}`, `15701029168157720000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Work</span>    <span class="token comment">//工作</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">private</span> State current<span class="token punctuation">;</span>\n    <span class="token keyword">public</span> <span class="token function">Work</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        current <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">ForenoonState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">private</span> <span class="token keyword">double</span> hour<span class="token punctuation">;</span>\n    <span class="token keyword">public</span> <span class="token keyword">double</span> Hour\n    <span class="token punctuation">{</span>\n        get <span class="token punctuation">{</span> <span class="token keyword">return</span> hour<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n        set <span class="token punctuation">{</span> hour <span class="token operator">=</span> value<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">private</span> <span class="token keyword">bool</span> finish <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>\n    <span class="token keyword">public</span> <span class="token keyword">bool</span> TaskFinished\n    <span class="token punctuation">{</span>\n        get <span class="token punctuation">{</span> <span class="token keyword">return</span> finish<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n        set <span class="token punctuation">{</span> finish <span class="token operator">=</span> value<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">SetState</span><span class="token punctuation">(</span>State s<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        current <span class="token operator">=</span> s<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">WordHard</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        current<span class="token punctuation">.</span><span class="token function">WriteProgram</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">public</span> abstract <span class="token keyword">class</span> <span class="token class-name">State</span>     <span class="token comment">//抽象状态</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> abstract <span class="token keyword">void</span> <span class="token function">WriteProgram</span><span class="token punctuation">(</span>Work w<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ForenoonState</span> <span class="token operator">:</span> State     <span class="token comment">//上午工作状态</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> override <span class="token keyword">void</span> <span class="token function">WriteProgram</span><span class="token punctuation">(</span>Work w<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">if</span> <span class="token punctuation">(</span>w<span class="token punctuation">.</span>Hour <span class="token operator">&lt;</span> <span class="token number">12</span><span class="token punctuation">)</span>\n        <span class="token punctuation">{</span>\n            Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"当前时间：{0}点 上午工作，精神百倍"</span><span class="token punctuation">,</span> w<span class="token punctuation">.</span>Hour<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n        <span class="token keyword">else</span>\n        <span class="token punctuation">{</span>\n            w<span class="token punctuation">.</span><span class="token function">SetState</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">NoonState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n            w<span class="token punctuation">.</span><span class="token function">WorkHard</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">NoonState</span> <span class="token operator">:</span> State     <span class="token comment">//中午工作状态</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> override <span class="token keyword">void</span> <span class="token function">WriteProgram</span><span class="token punctuation">(</span>Work w<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">if</span> <span class="token punctuation">(</span>w<span class="token punctuation">.</span>Hour <span class="token operator">&lt;</span> <span class="token number">13</span><span class="token punctuation">)</span>\n        <span class="token punctuation">{</span>\n            Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"当前时间：{0}点 饿了，午饭；犯困，午休。"</span><span class="token punctuation">,</span> w<span class="token punctuation">.</span>Hour<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n        <span class="token keyword">else</span>\n        <span class="token punctuation">{</span>\n            w<span class="token punctuation">.</span><span class="token function">SetState</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">AfternoonState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n            w<span class="token punctuation">.</span><span class="token function">WorkHard</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">Main</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    <span class="token comment">//紧急项目</span>\n    Work EmProject <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Work</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    EmProject<span class="token punctuation">.</span>Hour <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">;</span>\n    EmProject<span class="token punctuation">.</span><span class="token function">WorkHard</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    EmProject<span class="token punctuation">.</span>Hour <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>\n    EmProject<span class="token punctuation">.</span><span class="token function">WorkHard</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    EmProject<span class="token punctuation">.</span>Hour <span class="token operator">=</span> <span class="token number">12</span><span class="token punctuation">;</span>\n    EmProject<span class="token punctuation">.</span><span class="token function">WorkHard</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    EmProject<span class="token punctuation">.</span>Hour <span class="token operator">=</span> <span class="token number">13</span><span class="token punctuation">;</span>\n    EmProject<span class="token punctuation">.</span><span class="token function">WorkHard</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    EmProject<span class="token punctuation">.</span>Hour <span class="token operator">=</span> <span class="token number">14</span><span class="token punctuation">;</span>\n    EmProject<span class="token punctuation">.</span><span class="token function">WorkHard</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    EmProject<span class="token punctuation">.</span>Hour <span class="token operator">=</span> <span class="token number">17</span><span class="token punctuation">;</span>\n\n    EmProject<span class="token punctuation">.</span>TaskFinished <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>\n    <span class="token comment">// EmProject.TaskFinished = false;</span>\n\n    EmProject<span class="token punctuation">.</span><span class="token function">WriteProgram</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    EmProject<span class="token punctuation">.</span>Hour <span class="token operator">=</span> <span class="token number">19</span><span class="token punctuation">;</span>\n    EmProject<span class="token punctuation">.</span><span class="token function">WriteProgram</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    EmProject<span class="token punctuation">.</span>Hour <span class="token operator">=</span> <span class="token number">22</span><span class="token punctuation">;</span>\n    EmProject<span class="token punctuation">.</span><span class="token function">WriteProgram</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Console<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="模式结构-2"><a href="#%E6%A8%A1%E5%BC%8F%E7%BB%93%E6%9E%84-2" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式结构</h3>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/微信截图_20180418010557-88e4305f385fb56b94aec29229f83098-e38b7.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 37.688734030197445%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABnWAAAZ1gEY0crtAAABqklEQVQoz41STUsCURQddbKaVYtyEUEt2lVQrQpc5S9x6y4XhrRx0YhluRUMEy2khUgIbkRNXKijOYr4MSoKfqKIhiaChU33TTqLkOrA8A7vDOfcd+/Fms2mPZFI3JfL5YdWq/VIUdQeNoXP51tpNBq3xWLRXigU7MDv/H7/BtLC4bAAmwf2B4LBoGqmqdXq3X6/z2uTyYQFo32kQbBwrmEul/NVq1VPu9321Gq150gkIp1pNpttLR6POzOZDFWpVF7q9fpTIBDYmhaC/QUBQRBChUIhMhqNYqVSictkMhESNBrNJkmS24hLpVJcLpfjer1+0WQyifP5PJ5Op3Gn0/nt0uv1fgsR/vOOA2/q9XoX4GmnNE1fwZMvIPEmmUyeuN1uSTab1YGmjcViWjgv4Z91OI9SqdR1NBolgeuAq8CM4J2tVusy9LGFGj8cDrkBlEolvcvlOkB8PB5zHwIEHcPEzxAfjUbcHWzKm8PhkPCGBoNhCZJpMHkHsTcYDFjozbnZbN5hGOYDVmrQ6XT6sDafUNFhKBRSwCqxUMRrt9sdwzAZi8Wyiry+AMzBM2zXAhZgAAAAAElFTkSuQmCC\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;"\n        alt="     20180418010557"\n        title=""\n        src="/static/微信截图_20180418010557-88e4305f385fb56b94aec29229f83098-fee1c.png"\n        srcset="/static/微信截图_20180418010557-88e4305f385fb56b94aec29229f83098-a67b7.png 200w,\n/static/微信截图_20180418010557-88e4305f385fb56b94aec29229f83098-0b187.png 400w,\n/static/微信截图_20180418010557-88e4305f385fb56b94aec29229f83098-fee1c.png 800w,\n/static/微信截图_20180418010557-88e4305f385fb56b94aec29229f83098-b1a91.png 1200w,\n/static/微信截图_20180418010557-88e4305f385fb56b94aec29229f83098-95179.png 1600w,\n/static/微信截图_20180418010557-88e4305f385fb56b94aec29229f83098-e38b7.png 1722w"\n        sizes="(max-width: 800px) 100vw, 800px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<ul>\n<li>Context：环境类</li>\n<li>State：抽象状态类</li>\n<li>ConcreteState：具体状态类</li>\n</ul>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="248899092139409630"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`public class Context\n{\n    private State state;\n\n    public Context(State state)\n    {\n        this.state = state;\n    }\n\n    public State State\n    {\n        get { return state; }\n        set { state = value; }\n    }\n\n    public void Request()\n    {\n        state.Handle(this);\n    }\n}\npublic abstract class State\n{\n    public abstract void Handle(Context context);\n}\npublic class ConcreteStateA : State\n{\n    public override void Handle(Context context)\n    {\n        Console.WriteLine(&quot;当前状态是 A.&quot;);\n        context.State = new ConcreteStateB();\n    }\n}\n\npublic class ConcreteStateB : State\n{\n    public override void Handle(Context context)\n    {\n        Console.WriteLine(&quot;当前状态是 B.&quot;);\n        context.State = new ConcreteStateA();\n    }\n}\n\nclass Program\n{\n    static void Main(string[] args)\n    {\n        // 设置Context的初始状态为ConcreteStateA\n        Context context = new Context(new ConcreteStateA());\n\n        // 不断地进行请求，同时更改状态\n        context.Request();\n        context.Request();\n        context.Request();\n        context.Request();\n\n        Console.Read();\n    }\n}`, `248899092139409630`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Context</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">private</span> State state<span class="token punctuation">;</span>\n\n    <span class="token keyword">public</span> <span class="token function">Context</span><span class="token punctuation">(</span>State state<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> state<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">public</span> State State\n    <span class="token punctuation">{</span>\n        get <span class="token punctuation">{</span> <span class="token keyword">return</span> state<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n        set <span class="token punctuation">{</span> state <span class="token operator">=</span> value<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Request</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        state<span class="token punctuation">.</span><span class="token function">Handle</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">public</span> abstract <span class="token keyword">class</span> <span class="token class-name">State</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> abstract <span class="token keyword">void</span> <span class="token function">Handle</span><span class="token punctuation">(</span>Context context<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ConcreteStateA</span> <span class="token operator">:</span> State\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> override <span class="token keyword">void</span> <span class="token function">Handle</span><span class="token punctuation">(</span>Context context<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"当前状态是 A."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        context<span class="token punctuation">.</span>State <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">ConcreteStateB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ConcreteStateB</span> <span class="token operator">:</span> State\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> override <span class="token keyword">void</span> <span class="token function">Handle</span><span class="token punctuation">(</span>Context context<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"当前状态是 B."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        context<span class="token punctuation">.</span>State <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">ConcreteStateA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">class</span> <span class="token class-name">Program</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">Main</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token comment">// 设置Context的初始状态为ConcreteStateA</span>\n        Context context <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Context</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">ConcreteStateA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n        <span class="token comment">// 不断地进行请求，同时更改状态</span>\n        context<span class="token punctuation">.</span><span class="token function">Request</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        context<span class="token punctuation">.</span><span class="token function">Request</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        context<span class="token punctuation">.</span><span class="token function">Request</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        context<span class="token punctuation">.</span><span class="token function">Request</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n        Console<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="模式应用-2"><a href="#%E6%A8%A1%E5%BC%8F%E5%BA%94%E7%94%A8-2" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式应用</h3>\n<ul>\n<li>灯泡的开与关</li>\n<li>qq 在线状态</li>\n<li>文档编辑器状态切换</li>\n<li>工作流系统</li>\n<li>游戏开发</li>\n</ul>\n<h3 id="优缺点-2"><a href="#%E4%BC%98%E7%BC%BA%E7%82%B9-2" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>优缺点</h3>\n<ul>\n<li>\n<p>优点</p>\n<ul>\n<li>封装转换过程，也就是转换规则。</li>\n<li>枚举可能的状态，因此，需要事先确定状态种类。</li>\n<li>将所有与某个状态有关的行为放到一个对象里。</li>\n<li>允许状态转换逻辑与状态对象合成一体，而不是某一个巨大的条件语句块或 switch 语句。</li>\n<li>避免了状态的不一致性，因为状态的改变只使用一个状态对象而不是几个对象或属性。</li>\n</ul>\n</li>\n<li>\n<p>缺点</p>\n<ul>\n<li>状态模式的使用必然会增加系统类和对象的个数。</li>\n</ul>\n</li>\n</ul>\n<h3 id="模式使用-2"><a href="#%E6%A8%A1%E5%BC%8F%E4%BD%BF%E7%94%A8-2" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式使用</h3>\n<ul>\n<li>对象的行为依赖于它的状态（属性）并且它必须可以根据它的状态改变而改变它的相关行为。</li>\n<li>操作的很多部分都带有与对象状态有关的大量条件语句，大量条件语句的出现，会导致代码的可维护性和灵活性变差，不能方便地增加删除状态，使客户类与类库之间的耦合增强。</li>\n</ul>\n<h2 id="策略模式strategy"><a href="#%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8Fstrategy" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>策略模式(Strategy)</h2>\n<p>定义一系列的算法,把它们一个个封装起来,并且使它们可相互替换。</p>\n<h3 id="模式背景-3"><a href="#%E6%A8%A1%E5%BC%8F%E8%83%8C%E6%99%AF-3" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式背景</h3>\n<p>周郎妙计安天下，赔了夫人又折兵</p>\n<ul>\n<li>第一个锦囊：找乔国老帮忙，让吴国太给孙权施加压力</li>\n<li>第二个锦囊：刘备乐不思蜀，谎报曹操要报赤壁大败之仇</li>\n<li>第三个锦囊：追兵来了，孙尚香断后</li>\n</ul>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/微信截图_20180418110919-6502f4e152484a15b22f69bc8b62c76a-2a633.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 36.16625310173698%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABnWAAAZ1gEY0crtAAABkklEQVQoz21RzUoCURQerbSEoCdoUQuDkhY+QWD7Wgo1IfkELYR0VdBScFGrnqAgoVwIBqKgTqPjD5q/5Cg4qAtTB6fRkbHbuXYTqc7mO+fc73z3/FAUsVQqpcGYTqe38vn8OaCjVCo5OI5bx3mEEEVwyqtWqwflcvkhHo/f1ev1y3kORYQWMVYqFTs8IFVVMSCv13uM8xaLxQCmN5vNyzjOZDL3iFiz2eRngpFIZGE8HmshmArmcrnddrt9W6vVnlqt1nU4HDbivM/n03k8niW3263HMcuyp9lslhUE4QW4N386JKad81cJan6T/itMJBLfDsMwh8Fg8AjQFggENqCTtWKxSIdCIRrGsjqdTl0sFtuBjmzQ7Ukymdwjq9kuFAo0TETDDvdnH0FSgRGRoigIRrBHo1GjJEmo0+mgRqOBXC6XAY5zMRqNUL/fR+AzuJjn+avJZDKtA97rTBDE3obD4Xuv1/uEy1n9fv8m+KIsy2K32xVMJtMKdHAmiqIKuQ/Y2SO5sgM+UAaDgQSCzz+CX83mJWzzwqd9AAAAAElFTkSuQmCC\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;"\n        alt="     20180418110919"\n        title=""\n        src="/static/微信截图_20180418110919-6502f4e152484a15b22f69bc8b62c76a-fee1c.png"\n        srcset="/static/微信截图_20180418110919-6502f4e152484a15b22f69bc8b62c76a-a67b7.png 200w,\n/static/微信截图_20180418110919-6502f4e152484a15b22f69bc8b62c76a-0b187.png 400w,\n/static/微信截图_20180418110919-6502f4e152484a15b22f69bc8b62c76a-fee1c.png 800w,\n/static/微信截图_20180418110919-6502f4e152484a15b22f69bc8b62c76a-b1a91.png 1200w,\n/static/微信截图_20180418110919-6502f4e152484a15b22f69bc8b62c76a-95179.png 1600w,\n/static/微信截图_20180418110919-6502f4e152484a15b22f69bc8b62c76a-2a633.png 1612w"\n        sizes="(max-width: 800px) 100vw, 800px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="26204664775879262000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`public interface IStrategy\n{\n    void operate();\n}\n\npublic class OpenBackDoor : IStrategy\n{\n    public void operate()\n    {\n        Console.WriteLine(&quot;找乔国老帮忙，让吴国太给孙权施加压力&quot;);\n    }\n}\n\npublic class HappyForgetShu : IStrategy\n{\n    public void operate()\n    {\n        Console.WriteLine(&quot;刘备乐不思蜀，谎报曹操要报赤壁大败之仇&quot;);\n    }\n}\n\npublic class BlockEnemy : IStrategy\n{\n    public void operate()\n    {\n        Console.WriteLine(&quot;追兵来了，孙夫人断后&quot;);\n    }\n}\npublic class Context\n{\n    private IStrategy strategy;\n    public Context(IStrategy strategy)\n    {\n        this.strategy = strategy;\n    }\n\n    public void operation()\n    {\n        this.strategy.operate();\n    }\n}\nstatic void Main(string[] args)\n{\n    Context context;\n    context = new Context(new OpenBackDoor());\n    context.operation();\n\n    context = new Context(new HappyForgetShu());\n    context.operation();\n\n    context = new Context(new BlockEnemy());\n    context.operation();\n\n    Console.Read();\n}`, `26204664775879262000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp"><span class="token keyword">public</span> interface IStrategy\n<span class="token punctuation">{</span>\n    <span class="token keyword">void</span> <span class="token function">operate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OpenBackDoor</span> <span class="token operator">:</span> IStrategy\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">operate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"找乔国老帮忙，让吴国太给孙权施加压力"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HappyForgetShu</span> <span class="token operator">:</span> IStrategy\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">operate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"刘备乐不思蜀，谎报曹操要报赤壁大败之仇"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BlockEnemy</span> <span class="token operator">:</span> IStrategy\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">operate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"追兵来了，孙夫人断后"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Context</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">private</span> IStrategy strategy<span class="token punctuation">;</span>\n    <span class="token keyword">public</span> <span class="token function">Context</span><span class="token punctuation">(</span>IStrategy strategy<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>strategy <span class="token operator">=</span> strategy<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">operation</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>strategy<span class="token punctuation">.</span><span class="token function">operate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">Main</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    Context context<span class="token punctuation">;</span>\n    context <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Context</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">OpenBackDoor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    context<span class="token punctuation">.</span><span class="token function">operation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    context <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Context</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">HappyForgetShu</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    context<span class="token punctuation">.</span><span class="token function">operation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    context <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Context</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">BlockEnemy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    context<span class="token punctuation">.</span><span class="token function">operation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Console<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="模式动机-3"><a href="#%E6%A8%A1%E5%BC%8F%E5%8A%A8%E6%9C%BA-3" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式动机</h3>\n<ul>\n<li>完成一项任务，往往可以有多种不同的方式，每一种方式称为一个策略，我们可以根据环境或者条件的不同选择不同的策略来完成该项任务。</li>\n<li>在软件开发中也常常遇到类似的情况，实现某一个功能有多个途径，此时可以使用一种设计模式来使得系统可以灵活地选择解决途径，也能够方便地增加新的解决途径。</li>\n<li>在软件系统中，有许多算法可以实现某一功能，如查找、排序等，一种常用的方法是硬编码(Hard Coding)在一个类中，如需要提供多种查找算法，可以将这些算法写到一个类中，在该类中提供多个方法，每一个方法对应一个具体的查找算法；当然也可以将这些查找算法封装在一个统一的方法中，通过 if…else…等条件判断语句来进行选择。</li>\n<li>为了解决这些问题，可以定义一些独立的类来封装不同的算法，每一个类封装一个具体的算法，在这里，每一个封装算法的类我们都可以称之为策略(Strategy)，为了保证这些策略的一致性，一般会用一个抽象的策略类来做算法的定义，而具体每种算法则对应于一个具体策略类。</li>\n</ul>\n<h3 id="模式定义-3"><a href="#%E6%A8%A1%E5%BC%8F%E5%AE%9A%E4%B9%89-3" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式定义</h3>\n<p>定义一系列算法，将每一个算法封装起来，并让它们可以相互替换。策略模式让算法独立于使用它的客户而变化。策略模式是一种对象行为型模式。</p>\n<h3 id="模式结构-3"><a href="#%E6%A8%A1%E5%BC%8F%E7%BB%93%E6%9E%84-3" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式结构</h3>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/微信截图_20180418111636-589c2c99fdd8927df893520708015a6c-1eb4d.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 33.97014925373134%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABnWAAAZ1gEY0crtAAABaklEQVQoz5VRPUvDUBRN+lINKor+BumqSxfzXxwdgrgJovgBdQ0u2TKEEEEU13Zou7RDG2jpV9IEmraUhA5CoAUNLrXPe2MqFUTwwONx7z3v3vPOZWzbfhgMBo+dTmefAVBKWWYJuVyOtyxLhPo5cK9brVYa8+Px+AfvGzRGqVQ6xVgQBJ4QspJKpXiMRVHcDYJgQaPD4fAW85AjvzYcjUZPrus+1+v1aLKmaau6ricLhUKyXC4TWZY3PM877vf7977v3zmOk46FcHAIxFy1Wk1gDtQz/8H6X8VKpcIuvswufFNVlQevTmDqZaPRuOh2u5lisbi3pCgBiteazaYInCvkgK838JMD5NRqNTaS2W63o4b5fH4HPHqfzWZ0MplEnkHtKF5CEm9FUbbAppf5fE6n02nEAREZrMFyv3w1DCNqmM1mt03T9Hu93gd49hqGITY8xBoM4vCWJGkTtm7DYwrev+FgUHkWDyWfxvD5lzrUuF8AAAAASUVORK5CYII=\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;"\n        alt="     20180418111636"\n        title=""\n        src="/static/微信截图_20180418111636-589c2c99fdd8927df893520708015a6c-fee1c.png"\n        srcset="/static/微信截图_20180418111636-589c2c99fdd8927df893520708015a6c-a67b7.png 200w,\n/static/微信截图_20180418111636-589c2c99fdd8927df893520708015a6c-0b187.png 400w,\n/static/微信截图_20180418111636-589c2c99fdd8927df893520708015a6c-fee1c.png 800w,\n/static/微信截图_20180418111636-589c2c99fdd8927df893520708015a6c-b1a91.png 1200w,\n/static/微信截图_20180418111636-589c2c99fdd8927df893520708015a6c-95179.png 1600w,\n/static/微信截图_20180418111636-589c2c99fdd8927df893520708015a6c-1eb4d.png 1675w"\n        sizes="(max-width: 800px) 100vw, 800px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<ul>\n<li>Context: 环境类</li>\n<li>Strategy: 抽象策略类</li>\n<li>ConcreteStrategy: 具体策略类</li>\n</ul>\n<h3 id="模式应用-3"><a href="#%E6%A8%A1%E5%BC%8F%E5%BA%94%E7%94%A8-3" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式应用</h3>\n<ul>\n<li>直接插入排序、希尔排序、冒泡排序、快速排序、直接选择排序、堆排序、归并排序、基数排序的选择。</li>\n<li>交通工具的选择。</li>\n</ul>\n<h3 id="优缺点-3"><a href="#%E4%BC%98%E7%BC%BA%E7%82%B9-3" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>优缺点</h3>\n<ul>\n<li>\n<p>优点</p>\n<ul>\n<li>提供了对“开闭原则”的完美支持，用户可以在不修改原有系统的基础上选择算法或行为，也可以灵活地增加新的算法或行为。</li>\n<li>提供了管理相关的算法族的办法。</li>\n<li>提供了可以替换继承关系的办法。</li>\n<li>可以避免使用多重条件转移语句。</li>\n</ul>\n</li>\n<li>\n<p>缺点</p>\n<ul>\n<li>客户端必须知道所有的策略类，并自行决定使用哪一个策略类。</li>\n<li>策略模式将造成产生很多策略类，可以通过使用享元模式在一定程度上减少对象的数量。</li>\n</ul>\n</li>\n</ul>\n<h3 id="模式使用-3"><a href="#%E6%A8%A1%E5%BC%8F%E4%BD%BF%E7%94%A8-3" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式使用</h3>\n<ul>\n<li>如果在一个系统里面有许多类，它们之间的区别仅在于它们的行为，那么使用策略模式可以动态地让一个对象在许多行为中选择一种行为。</li>\n<li>如果一个对象有很多的行为，如果不用恰当的模式，这些行为就只好使用多重的条件选择语句来实现。</li>\n<li>一个系统需要动态地在几种算法中选择一种。</li>\n<li>不希望客户端知道复杂的、与算法相关的数据结构，在具体策略类中封装算法和相关的数据结构，提高算法的保密性与安全性。</li>\n</ul>\n<h3 id="模式应用-4"><a href="#%E6%A8%A1%E5%BC%8F%E5%BA%94%E7%94%A8-4" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式应用</h3>\n<ul>\n<li>在微软公司提供的演示项目 PetShop 4.0 中使用策略模式来处理同步订单和异步订单的问题。</li>\n<li>在 BLL 中的 Order 类里通过反射机制从配置文件中读取策略配置的信息以决定到底是使用哪种订单处理方式。只需要修改配置文件即可更改订单处理方式，提高了系统的灵活性。</li>\n</ul>\n<h3 id="策略模式与状态模式"><a href="#%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F%E4%B8%8E%E7%8A%B6%E6%80%81%E6%A8%A1%E5%BC%8F" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>策略模式与状态模式</h3>\n<ul>\n<li>可以通过环境类状态的个数来决定是使用策略模式还是状态模式。</li>\n<li>策略模式的环境类自己选择一个具体策略类，具体策略类无须关心环境类；而状态模式的环境类由于外在因素需要放进一个具体状态中，以便通过其方法实现状态的切换，因此环境类和状态类之间存在一种双向的关联关系。</li>\n<li>使用策略模式时，客户端需要知道所选的具体策略是哪一个，而使用状态模式时，客户端无须关心具体状态，环境类的状态会根据用户的操作自动转换。</li>\n<li>如果系统中某个类的对象存在多种状态，不同状态下行为有差异，而且这些状态之间可以发生转换时使用状态模式；如果系统中某个类的某一行为存在多种实现方式，而且这些实现方式可以互换时使用策略模式。</li>\n</ul>',
id:"/github/workspace/blog/设计模式之行为型模式（二）/index.md absPath of file >>> MarkdownRemark",timeToRead:14,frontmatter:{date:"2018-04-19 00:04:42",path:"/design-pattern-behavior-2/",tags:"面试, 设计模式",title:"设计模式之行为型模式（二）",draft:null}},{excerpt:"职责链模式(Chain of Responsibility) 使多个对象都有机会处理请求，从而避免请求的发送者和接收者之间的耦合关系。将这些对象连成一条链,  并沿着这条链传递该请求，直到有一个对象处理它为止。 模式背景 加薪、请假非要老总批? 每级领导都有一定限度的权利，对待申请，需判断是否有权来决策 经理可以批 2 天以下请假，如果没权利，向总监上报 总监可以批…",html:'<h2 id="职责链模式chain-of-responsibility"><a href="#%E8%81%8C%E8%B4%A3%E9%93%BE%E6%A8%A1%E5%BC%8Fchain-of-responsibility" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>职责链模式(Chain of Responsibility)</h2>\n<p>使多个对象都有机会处理请求，从而避免请求的发送者和接收者之间的耦合关系。将这些对象连成一条链,  并沿着这条链传递该请求，直到有一个对象处理它为止。</p>\n<h3 id="模式背景"><a href="#%E6%A8%A1%E5%BC%8F%E8%83%8C%E6%99%AF" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式背景</h3>\n<p>加薪、请假非要老总批?</p>\n<ul>\n<li>每级领导都有一定限度的权利，对待申请，需判断是否有权来决策</li>\n<li>经理可以批 2 天以下请假，如果没权利，向总监上报</li>\n<li>总监可以批 5 天以下请假，如果没权利，向总经理上报</li>\n</ul>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="12870494460551840000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class Request   //申请\n{\n    //申请类别\n    private string requestType;\n    public string RequestType\n    {\n        get { return requestType; }\n        set { requestType = value; }\n    }\n\n    //申请内容\n    private string requestContent;\n    public string RequestContent\n    {\n        get { return requestContent; }\n        set { requestContent = value; }\n    }\n\n    //数量\n    private int number;\n    public int Number\n    {\n        get { return number; }\n        set { number = value; }\n    }\n}\nclass Manager\n{\n    protected string name;\n    public Manager(string name)\n    {\n        this.name = name;\n    }\n    public void GetResult(ManagerLevel managerLevel, Request request)\n    {\n        if (managerLevel == ManagerLevel.经理)\n        {\n            if (request.RequestType == &quot;请假&quot; && request.Number <= 2)\n            {\n                Console.WriteLine(&quot;{0}:{1} 数量{2} 被批准&quot;, name, request.RequestContent, request.Number);\n            }\n            else\n            {\n                Console.WriteLine(&quot;{0}:{1} 数量{2} 我无权处理&quot;, name, request.RequestContent, request.Number);\n            }\n        }\n        else if (managerLevel == ManagerLevel.总监)\n        {\n            if (request.RequestType == &quot;请假&quot; && request.Number <= 5)\n            {\n                Console.WriteLine(&quot;{0}:{1} 数量{2} 被批准&quot;, name, request.RequestContent, request.Number);\n            }\n            else\n            {\n                Console.WriteLine(&quot;{0}:{1} 数量{2} 我无权处理&quot;, name, request.RequestContent, request.Number);\n            }\n        }\n        else if (managerLevel == ManagerLevel.总经理)\n        {\n            if (request.RequestType == &quot;请假&quot;)\n            {\n                Console.WriteLine(&quot;{0}:{1} 数量{2} 被批准&quot;, name, request.RequestContent, request.Number);\n            }\n            else if (request.RequestType == &quot;加薪&quot; && request.Number <= 500)\n            {\n                Console.WriteLine(&quot;{0}:{1} 数量{2} 被批准&quot;, name, request.RequestContent, request.Number);\n            }\n            else if (request.RequestType == &quot;加薪&quot; && request.Number > 500)\n            {\n                Console.WriteLine(&quot;{0}:{1} 数量{2} 再说吧&quot;, name, request.RequestContent, request.Number);\n            }\n        }\n    }\n}\nstatic void Main(string[] args)\n{\n    Manager jinli = new Manager(&quot;金利&quot;);\n    Manager zongjian = new Manager(&quot;宗剑&quot;);\n    Manager zhongjingli = new Manager(&quot;钟精励&quot;);\n\n    Request request = new Request();\n    request.RequestType = &quot;加薪&quot;;\n    request.RequestContent = &quot;张三请求加薪&quot;;\n    request.Number = 1000;\n\n    jinli.GetResult(ManagerLevel.经理, request);\n    zongjian.GetResult(ManagerLevel.总监, request);\n    zhongjingli.GetResult(ManagerLevel.总经理, request);\n\n    Request request2 = new Request();\n    request2.RequestType = &quot;请假&quot;;\n    request2.RequestContent = &quot;张三请假&quot;;\n    request2.Number = 3;\n\n    jinli.GetResult(ManagerLevel.经理, request2);\n    zongjian.GetResult(ManagerLevel.总监, request2);\n    zhongjingli.GetResult(ManagerLevel.总经理, request2);\n\n    Console.Read();\n}`, `12870494460551840000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">Request</span>   <span class="token comment">//申请</span>\n<span class="token punctuation">{</span>\n    <span class="token comment">//申请类别</span>\n    <span class="token keyword">private</span> string requestType<span class="token punctuation">;</span>\n    <span class="token keyword">public</span> string RequestType\n    <span class="token punctuation">{</span>\n        get <span class="token punctuation">{</span> <span class="token keyword">return</span> requestType<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n        set <span class="token punctuation">{</span> requestType <span class="token operator">=</span> value<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token comment">//申请内容</span>\n    <span class="token keyword">private</span> string requestContent<span class="token punctuation">;</span>\n    <span class="token keyword">public</span> string RequestContent\n    <span class="token punctuation">{</span>\n        get <span class="token punctuation">{</span> <span class="token keyword">return</span> requestContent<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n        set <span class="token punctuation">{</span> requestContent <span class="token operator">=</span> value<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token comment">//数量</span>\n    <span class="token keyword">private</span> <span class="token keyword">int</span> number<span class="token punctuation">;</span>\n    <span class="token keyword">public</span> <span class="token keyword">int</span> Number\n    <span class="token punctuation">{</span>\n        get <span class="token punctuation">{</span> <span class="token keyword">return</span> number<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n        set <span class="token punctuation">{</span> number <span class="token operator">=</span> value<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">class</span> <span class="token class-name">Manager</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">protected</span> string name<span class="token punctuation">;</span>\n    <span class="token keyword">public</span> <span class="token function">Manager</span><span class="token punctuation">(</span>string name<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">GetResult</span><span class="token punctuation">(</span>ManagerLevel managerLevel<span class="token punctuation">,</span> Request request<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">if</span> <span class="token punctuation">(</span>managerLevel <span class="token operator">==</span> ManagerLevel<span class="token punctuation">.</span>经理<span class="token punctuation">)</span>\n        <span class="token punctuation">{</span>\n            <span class="token keyword">if</span> <span class="token punctuation">(</span>request<span class="token punctuation">.</span>RequestType <span class="token operator">==</span> <span class="token string">"请假"</span> <span class="token operator">&amp;&amp;</span> request<span class="token punctuation">.</span>Number <span class="token operator">&lt;=</span> <span class="token number">2</span><span class="token punctuation">)</span>\n            <span class="token punctuation">{</span>\n                Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"{0}:{1} 数量{2} 被批准"</span><span class="token punctuation">,</span> name<span class="token punctuation">,</span> request<span class="token punctuation">.</span>RequestContent<span class="token punctuation">,</span> request<span class="token punctuation">.</span>Number<span class="token punctuation">)</span><span class="token punctuation">;</span>\n            <span class="token punctuation">}</span>\n            <span class="token keyword">else</span>\n            <span class="token punctuation">{</span>\n                Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"{0}:{1} 数量{2} 我无权处理"</span><span class="token punctuation">,</span> name<span class="token punctuation">,</span> request<span class="token punctuation">.</span>RequestContent<span class="token punctuation">,</span> request<span class="token punctuation">.</span>Number<span class="token punctuation">)</span><span class="token punctuation">;</span>\n            <span class="token punctuation">}</span>\n        <span class="token punctuation">}</span>\n        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>managerLevel <span class="token operator">==</span> ManagerLevel<span class="token punctuation">.</span>总监<span class="token punctuation">)</span>\n        <span class="token punctuation">{</span>\n            <span class="token keyword">if</span> <span class="token punctuation">(</span>request<span class="token punctuation">.</span>RequestType <span class="token operator">==</span> <span class="token string">"请假"</span> <span class="token operator">&amp;&amp;</span> request<span class="token punctuation">.</span>Number <span class="token operator">&lt;=</span> <span class="token number">5</span><span class="token punctuation">)</span>\n            <span class="token punctuation">{</span>\n                Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"{0}:{1} 数量{2} 被批准"</span><span class="token punctuation">,</span> name<span class="token punctuation">,</span> request<span class="token punctuation">.</span>RequestContent<span class="token punctuation">,</span> request<span class="token punctuation">.</span>Number<span class="token punctuation">)</span><span class="token punctuation">;</span>\n            <span class="token punctuation">}</span>\n            <span class="token keyword">else</span>\n            <span class="token punctuation">{</span>\n                Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"{0}:{1} 数量{2} 我无权处理"</span><span class="token punctuation">,</span> name<span class="token punctuation">,</span> request<span class="token punctuation">.</span>RequestContent<span class="token punctuation">,</span> request<span class="token punctuation">.</span>Number<span class="token punctuation">)</span><span class="token punctuation">;</span>\n            <span class="token punctuation">}</span>\n        <span class="token punctuation">}</span>\n        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>managerLevel <span class="token operator">==</span> ManagerLevel<span class="token punctuation">.</span>总经理<span class="token punctuation">)</span>\n        <span class="token punctuation">{</span>\n            <span class="token keyword">if</span> <span class="token punctuation">(</span>request<span class="token punctuation">.</span>RequestType <span class="token operator">==</span> <span class="token string">"请假"</span><span class="token punctuation">)</span>\n            <span class="token punctuation">{</span>\n                Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"{0}:{1} 数量{2} 被批准"</span><span class="token punctuation">,</span> name<span class="token punctuation">,</span> request<span class="token punctuation">.</span>RequestContent<span class="token punctuation">,</span> request<span class="token punctuation">.</span>Number<span class="token punctuation">)</span><span class="token punctuation">;</span>\n            <span class="token punctuation">}</span>\n            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>request<span class="token punctuation">.</span>RequestType <span class="token operator">==</span> <span class="token string">"加薪"</span> <span class="token operator">&amp;&amp;</span> request<span class="token punctuation">.</span>Number <span class="token operator">&lt;=</span> <span class="token number">500</span><span class="token punctuation">)</span>\n            <span class="token punctuation">{</span>\n                Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"{0}:{1} 数量{2} 被批准"</span><span class="token punctuation">,</span> name<span class="token punctuation">,</span> request<span class="token punctuation">.</span>RequestContent<span class="token punctuation">,</span> request<span class="token punctuation">.</span>Number<span class="token punctuation">)</span><span class="token punctuation">;</span>\n            <span class="token punctuation">}</span>\n            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>request<span class="token punctuation">.</span>RequestType <span class="token operator">==</span> <span class="token string">"加薪"</span> <span class="token operator">&amp;&amp;</span> request<span class="token punctuation">.</span>Number <span class="token operator">></span> <span class="token number">500</span><span class="token punctuation">)</span>\n            <span class="token punctuation">{</span>\n                Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"{0}:{1} 数量{2} 再说吧"</span><span class="token punctuation">,</span> name<span class="token punctuation">,</span> request<span class="token punctuation">.</span>RequestContent<span class="token punctuation">,</span> request<span class="token punctuation">.</span>Number<span class="token punctuation">)</span><span class="token punctuation">;</span>\n            <span class="token punctuation">}</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">Main</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    Manager jinli <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Manager</span><span class="token punctuation">(</span><span class="token string">"金利"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    Manager zongjian <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Manager</span><span class="token punctuation">(</span><span class="token string">"宗剑"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    Manager zhongjingli <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Manager</span><span class="token punctuation">(</span><span class="token string">"钟精励"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Request request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Request</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    request<span class="token punctuation">.</span>RequestType <span class="token operator">=</span> <span class="token string">"加薪"</span><span class="token punctuation">;</span>\n    request<span class="token punctuation">.</span>RequestContent <span class="token operator">=</span> <span class="token string">"张三请求加薪"</span><span class="token punctuation">;</span>\n    request<span class="token punctuation">.</span>Number <span class="token operator">=</span> <span class="token number">1000</span><span class="token punctuation">;</span>\n\n    jinli<span class="token punctuation">.</span><span class="token function">GetResult</span><span class="token punctuation">(</span>ManagerLevel<span class="token punctuation">.</span>经理<span class="token punctuation">,</span> request<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    zongjian<span class="token punctuation">.</span><span class="token function">GetResult</span><span class="token punctuation">(</span>ManagerLevel<span class="token punctuation">.</span>总监<span class="token punctuation">,</span> request<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    zhongjingli<span class="token punctuation">.</span><span class="token function">GetResult</span><span class="token punctuation">(</span>ManagerLevel<span class="token punctuation">.</span>总经理<span class="token punctuation">,</span> request<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Request request2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Request</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    request2<span class="token punctuation">.</span>RequestType <span class="token operator">=</span> <span class="token string">"请假"</span><span class="token punctuation">;</span>\n    request2<span class="token punctuation">.</span>RequestContent <span class="token operator">=</span> <span class="token string">"张三请假"</span><span class="token punctuation">;</span>\n    request2<span class="token punctuation">.</span>Number <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>\n\n    jinli<span class="token punctuation">.</span><span class="token function">GetResult</span><span class="token punctuation">(</span>ManagerLevel<span class="token punctuation">.</span>经理<span class="token punctuation">,</span> request2<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    zongjian<span class="token punctuation">.</span><span class="token function">GetResult</span><span class="token punctuation">(</span>ManagerLevel<span class="token punctuation">.</span>总监<span class="token punctuation">,</span> request2<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    zhongjingli<span class="token punctuation">.</span><span class="token function">GetResult</span><span class="token punctuation">(</span>ManagerLevel<span class="token punctuation">.</span>总经理<span class="token punctuation">,</span> request2<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Console<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="模式动机"><a href="#%E6%A8%A1%E5%BC%8F%E5%8A%A8%E6%9C%BA" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式动机</h3>\n<ul>\n<li>职责链可以是一条直线、一个环或者一个树形结构，最常见的职责链是直线型，即沿着一条单向的链来传递请求。</li>\n<li>链上的每一个对象都是请求处理者，职责链模式可以将请求的处理者组织成一条链，并使请求沿着链传递，由链上的处理者对请求进行相应的处理。</li>\n<li>客户端无须关心请求的处理细节以及请求的传递，只需将请求发送到链上即可，将请求的发送者和请求的处理者解耦。这就是职责链模式的模式动机。</li>\n</ul>\n<h3 id="模式定义"><a href="#%E6%A8%A1%E5%BC%8F%E5%AE%9A%E4%B9%89" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式定义</h3>\n<p>避免请求发送者与接收者耦合在一起，让多个对象都有可能接收请求，将这些对象连接成一条链，并且沿着这条链传递请求，直到有对象处理它为止。职责链模式又称为责任链模式，它是一种对象行为型模式。</p>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/微信截图_20180417152941-0d3c1ea2f90a5f29ba69c4481b7410d8-6eb27.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 757px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 73.05151915455747%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAA7EAAAOxAGVKw4bAAACbElEQVQ4y5VUS4hSYRS+D5WIQje2CYxm0yZ3QbgcaBUD4WK2mgtpJYj7cMaxiAhhgiAQdCGILqSFiAaa0wj5Dh8oKIovfOL4RJBAb+fcuVecGYbsg8t/7n9e33ncSxBbYBhmc/IySZICmUwmkkqlInjlHwGxK/hAHNDxLieTCoWCwpMLSv8zWK1WQwcikUg8m8/n56VSKRyJRM7G43G02Wy+20oo2ClgPp9njeLx+EtwZGazGTMajVBkyuVyCVT3JBKJUCwW3+GY3oTNZtvuHcswGo3uF4vFRaFQGA8GgzGw/QPnN9RlMhkaErP2Pp+PcLvdbAyE3W6/LMFoNFIqlYrW6XTIkDSZTPdDodBjl8ulcDgcr6AFe06n8yE6qdVqWq/X00qlkuaHtz1MHkKuLxQnU1tFbEqTy+X8MPjB3BzmdDr9mUqlwv1+/2w4HH6HMh5ks1k5lBnrdrvhdDr9A2yS9Xr9E9rDcIyLxSIG96FcLheeTCa/wH4fddBnimCuwev17kGJL1Ber9ebewj0G52q1WoQ31er1UYH/X6NukqlQuNEjyHTcbvdNsHavPV4POJAIPAIWH8A3QncnYDuIzip0SkWix3C/XtgeNRqtY4gkRkIPOUGRhL/Ayibuk0HwS+FXq9HaTQaEfQQp8buYTKZfAL796XRaJzCCn2+uLj4CuW8Qd1yuUQ7UqvViiwWixBXDRiyzMD+6pRhbfAkgsHgATSbgaGwy40ABueoM5vNIm4LRNe24QowA2UwGNiAfr//AJhvgiE6nU4YdVarlV8rapcfA8l9es8hYBZYxqHcKJRfhP6dbn9Nt+EvB8G5Yn1FDs8AAAAASUVORK5CYII=\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;"\n        alt="     20180417152941"\n        title=""\n        src="/static/微信截图_20180417152941-0d3c1ea2f90a5f29ba69c4481b7410d8-6eb27.png"\n        srcset="/static/微信截图_20180417152941-0d3c1ea2f90a5f29ba69c4481b7410d8-a550b.png 200w,\n/static/微信截图_20180417152941-0d3c1ea2f90a5f29ba69c4481b7410d8-80d9e.png 400w,\n/static/微信截图_20180417152941-0d3c1ea2f90a5f29ba69c4481b7410d8-6eb27.png 757w"\n        sizes="(max-width: 757px) 100vw, 757px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="9064341708477808000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`//管理者\nabstract class Manager\n{\n    protected string name;\n    //管理者的上级\n    protected Manager superior;\n\n    public Manager(string name)\n    {\n        this.name = name;\n    }\n\n    //设置管理者的上级\n    public void SetSuperior(Manager superior)\n    {\n        this.superior = superior;\n    }\n\n    //申请请求\n    abstract public void RequestApplications(Request request);\n}\nclass CommonManager : Manager    //经理\n{\n    public CommonManager(string name) : base(name)\n    { }\n    public override void RequestApplications(Request request)\n    {\n        if (request.RequestType == &quot;请假&quot; && request.Number <= 2)\n        {\n        Console.WriteLine(&quot;{0}:{1} 数量{2} 被批准&quot;, name, request.RequestContent, request.Number);\n        }\n        else\n        {\n            if (superior != null)\n                superior.RequestApplications(request);\n        }\n    }\n}\nclass Majordomo : Manager  //总监\n{\n    public Majordomo(string name) : base(name)\n    { }\n    public override void RequestApplications(Request request)\n    {\n        if (request.RequestType == &quot;请假&quot; && request.Number <= 5)\n        {\n        Console.WriteLine(&quot;{0}:{1} 数量{2} 被批准&quot;, name, request.RequestContent, request.Number);\n        }\n        else\n        {\n            if (superior != null)\n                superior.RequestApplications(request);\n        }\n    }\n}\nclass GeneralManager : Manager    //总经理\n{\n    public GeneralManager(string name) : base(name)\n    { }\n    public override void RequestApplications(Request request)\n    {\n        if (request.RequestType == &quot;请假&quot;)\n        {\n        Console.WriteLine(&quot;{0}:{1} 数量{2} 被批准&quot;, name, request.RequestContent, request.Number);\n        }\n        else if (request.RequestType == &quot;加薪&quot; && request.Number <= 500)\n        {\n        Console.WriteLine(&quot;{0}:{1} 数量{2} 被批准&quot;, name, request.RequestContent, request.Number);\n        }\n        else if (request.RequestType == &quot;加薪&quot; && request.Number > 500)\n        {\n        Console.WriteLine(&quot;{0}:{1} 数量{2} 再说吧&quot;, name, request.RequestContent, request.Number);\n        }\n    }\n}\nstatic void Main(string[] args)\n{\n    CommonManager jinli = new CommonManager(&quot;金利&quot;);\n    Majordomo zongjian = new Majordomo(&quot;宗剑&quot;);\n    GeneralManager zhongjingli = new GeneralManager(&quot;钟精励&quot;);\n    jinli.SetSuperior(zongjian);\n    zongjian.SetSuperior(zhongjingli);\n\n    Request request = new Request();\n    request.RequestType = &quot;请假&quot;;\n    request.RequestContent = &quot;张三请假&quot;;\n    request.Number = 1;\n    jinli.RequestApplications(request);\n\n    Request request3 = new Request();\n    request3.RequestType = &quot;加薪&quot;;\n    request3.RequestContent = &quot;张三请求加薪&quot;;\n    request3.Number = 500;\n    jinli.RequestApplications(request3);\n\n    Console.Read();\n}`, `9064341708477808000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp"><span class="token comment">//管理者</span>\nabstract <span class="token keyword">class</span> <span class="token class-name">Manager</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">protected</span> string name<span class="token punctuation">;</span>\n    <span class="token comment">//管理者的上级</span>\n    <span class="token keyword">protected</span> Manager superior<span class="token punctuation">;</span>\n\n    <span class="token keyword">public</span> <span class="token function">Manager</span><span class="token punctuation">(</span>string name<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token comment">//设置管理者的上级</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">SetSuperior</span><span class="token punctuation">(</span>Manager superior<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>superior <span class="token operator">=</span> superior<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token comment">//申请请求</span>\n    abstract <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">RequestApplications</span><span class="token punctuation">(</span>Request request<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">class</span> <span class="token class-name">CommonManager</span> <span class="token operator">:</span> Manager    <span class="token comment">//经理</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> <span class="token function">CommonManager</span><span class="token punctuation">(</span>string name<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">base</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span> <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> override <span class="token keyword">void</span> <span class="token function">RequestApplications</span><span class="token punctuation">(</span>Request request<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">if</span> <span class="token punctuation">(</span>request<span class="token punctuation">.</span>RequestType <span class="token operator">==</span> <span class="token string">"请假"</span> <span class="token operator">&amp;&amp;</span> request<span class="token punctuation">.</span>Number <span class="token operator">&lt;=</span> <span class="token number">2</span><span class="token punctuation">)</span>\n        <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"{0}:{1} 数量{2} 被批准"</span><span class="token punctuation">,</span> name<span class="token punctuation">,</span> request<span class="token punctuation">.</span>RequestContent<span class="token punctuation">,</span> request<span class="token punctuation">.</span>Number<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n        <span class="token keyword">else</span>\n        <span class="token punctuation">{</span>\n            <span class="token keyword">if</span> <span class="token punctuation">(</span>superior <span class="token operator">!=</span> null<span class="token punctuation">)</span>\n                superior<span class="token punctuation">.</span><span class="token function">RequestApplications</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">class</span> <span class="token class-name">Majordomo</span> <span class="token operator">:</span> Manager  <span class="token comment">//总监</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> <span class="token function">Majordomo</span><span class="token punctuation">(</span>string name<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">base</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span> <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> override <span class="token keyword">void</span> <span class="token function">RequestApplications</span><span class="token punctuation">(</span>Request request<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">if</span> <span class="token punctuation">(</span>request<span class="token punctuation">.</span>RequestType <span class="token operator">==</span> <span class="token string">"请假"</span> <span class="token operator">&amp;&amp;</span> request<span class="token punctuation">.</span>Number <span class="token operator">&lt;=</span> <span class="token number">5</span><span class="token punctuation">)</span>\n        <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"{0}:{1} 数量{2} 被批准"</span><span class="token punctuation">,</span> name<span class="token punctuation">,</span> request<span class="token punctuation">.</span>RequestContent<span class="token punctuation">,</span> request<span class="token punctuation">.</span>Number<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n        <span class="token keyword">else</span>\n        <span class="token punctuation">{</span>\n            <span class="token keyword">if</span> <span class="token punctuation">(</span>superior <span class="token operator">!=</span> null<span class="token punctuation">)</span>\n                superior<span class="token punctuation">.</span><span class="token function">RequestApplications</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">class</span> <span class="token class-name">GeneralManager</span> <span class="token operator">:</span> Manager    <span class="token comment">//总经理</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> <span class="token function">GeneralManager</span><span class="token punctuation">(</span>string name<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">base</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span> <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> override <span class="token keyword">void</span> <span class="token function">RequestApplications</span><span class="token punctuation">(</span>Request request<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">if</span> <span class="token punctuation">(</span>request<span class="token punctuation">.</span>RequestType <span class="token operator">==</span> <span class="token string">"请假"</span><span class="token punctuation">)</span>\n        <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"{0}:{1} 数量{2} 被批准"</span><span class="token punctuation">,</span> name<span class="token punctuation">,</span> request<span class="token punctuation">.</span>RequestContent<span class="token punctuation">,</span> request<span class="token punctuation">.</span>Number<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>request<span class="token punctuation">.</span>RequestType <span class="token operator">==</span> <span class="token string">"加薪"</span> <span class="token operator">&amp;&amp;</span> request<span class="token punctuation">.</span>Number <span class="token operator">&lt;=</span> <span class="token number">500</span><span class="token punctuation">)</span>\n        <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"{0}:{1} 数量{2} 被批准"</span><span class="token punctuation">,</span> name<span class="token punctuation">,</span> request<span class="token punctuation">.</span>RequestContent<span class="token punctuation">,</span> request<span class="token punctuation">.</span>Number<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>request<span class="token punctuation">.</span>RequestType <span class="token operator">==</span> <span class="token string">"加薪"</span> <span class="token operator">&amp;&amp;</span> request<span class="token punctuation">.</span>Number <span class="token operator">></span> <span class="token number">500</span><span class="token punctuation">)</span>\n        <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"{0}:{1} 数量{2} 再说吧"</span><span class="token punctuation">,</span> name<span class="token punctuation">,</span> request<span class="token punctuation">.</span>RequestContent<span class="token punctuation">,</span> request<span class="token punctuation">.</span>Number<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">Main</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    CommonManager jinli <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">CommonManager</span><span class="token punctuation">(</span><span class="token string">"金利"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    Majordomo zongjian <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Majordomo</span><span class="token punctuation">(</span><span class="token string">"宗剑"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    GeneralManager zhongjingli <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">GeneralManager</span><span class="token punctuation">(</span><span class="token string">"钟精励"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    jinli<span class="token punctuation">.</span><span class="token function">SetSuperior</span><span class="token punctuation">(</span>zongjian<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    zongjian<span class="token punctuation">.</span><span class="token function">SetSuperior</span><span class="token punctuation">(</span>zhongjingli<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Request request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Request</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    request<span class="token punctuation">.</span>RequestType <span class="token operator">=</span> <span class="token string">"请假"</span><span class="token punctuation">;</span>\n    request<span class="token punctuation">.</span>RequestContent <span class="token operator">=</span> <span class="token string">"张三请假"</span><span class="token punctuation">;</span>\n    request<span class="token punctuation">.</span>Number <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>\n    jinli<span class="token punctuation">.</span><span class="token function">RequestApplications</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Request request3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Request</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    request3<span class="token punctuation">.</span>RequestType <span class="token operator">=</span> <span class="token string">"加薪"</span><span class="token punctuation">;</span>\n    request3<span class="token punctuation">.</span>RequestContent <span class="token operator">=</span> <span class="token string">"张三请求加薪"</span><span class="token punctuation">;</span>\n    request3<span class="token punctuation">.</span>Number <span class="token operator">=</span> <span class="token number">500</span><span class="token punctuation">;</span>\n    jinli<span class="token punctuation">.</span><span class="token function">RequestApplications</span><span class="token punctuation">(</span>request3<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Console<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="模式结构"><a href="#%E6%A8%A1%E5%BC%8F%E7%BB%93%E6%9E%84" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式结构</h3>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/微信截图_20180417153731-1f09738da3c32974ee0505ce18d18d8d-38a1d.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 779px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 51.732991014120664%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAB50lEQVQoz41SPYsaURSdnbcu2YQ0YTvXLkVIm8Uwiez2ixYhhEiSLk1qyV9IaxGtBEVEEVZQUbBYxUIsoviN+BEFP1AMfhQzbmMwvpw7TILTyD4YzuPec8+ce+8Tut0uazQaTMMjAadarRIImUxGGA6HbDKZsHA4zJxOp8HtdhssFouI9BFjTEXh0Mnn8yrB6/UeoolGo/EESN8DXQbO3lQqFXun0/nUarXOKcY5V0ULhcIjuHs3Ho/toVDoCzj2xWLxoVarPdF4BAad4GAwuJtOp1yWZY5WP1LM4XA8JAwEAs8hxufzOW+323y1WnE6qVTqM+XNZvMp2tY7HI1Gv9br9ZYE8ee3FIvH49SKEI1Gn5ZKpTs4/9Pr9X7jxxtFUXg6nX5Peb/fz0wmk34YIF9AVOr3+69QfKa5ZtQOWj6FMwmLeZlMJr+Wy+VLiL4G7zHxEBeLxaKIsYl7I7j3OT6U/C9Wr9fFZrPJ6J7L5Z4lEglbMBi8drlc1kgkYsXWryRJElGgushmsxexWMzm8/msHo/nGhwb6l7oRGH9WGv1Ow19uVzy2WzGN5sN4U+NLGrc5G6349i2ytlutxyLu91/HQKWoQpiNt/wTDhmKgMVKsLMfuwL4iUEafMQVsCRaZm43/wT/At29VI+uqeDHgAAAABJRU5ErkJggg==\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;"\n        alt="     20180417153731"\n        title=""\n        src="/static/微信截图_20180417153731-1f09738da3c32974ee0505ce18d18d8d-38a1d.png"\n        srcset="/static/微信截图_20180417153731-1f09738da3c32974ee0505ce18d18d8d-ac764.png 200w,\n/static/微信截图_20180417153731-1f09738da3c32974ee0505ce18d18d8d-d0cc7.png 400w,\n/static/微信截图_20180417153731-1f09738da3c32974ee0505ce18d18d8d-38a1d.png 779w"\n        sizes="(max-width: 779px) 100vw, 779px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<ul>\n<li>Handler: 抽象处理者</li>\n<li>ConcreteHandler: 具体处理者</li>\n<li>Client: 客户类</li>\n</ul>\n<h3 id="职责链模式和状态模式比较"><a href="#%E8%81%8C%E8%B4%A3%E9%93%BE%E6%A8%A1%E5%BC%8F%E5%92%8C%E7%8A%B6%E6%80%81%E6%A8%A1%E5%BC%8F%E6%AF%94%E8%BE%83" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>职责链模式和状态模式比较</h3>\n<ul>\n<li>当客户提交一个请求时，请求是沿链传递直至有一个 ConcreteHander 对象负责处理它。链中的对象自己并不知道链的结构，在运行时确定。结果是职责链可简化对象的相互连接，它们仅需保持一个指向其后继者的引用或指针，而不需要保持它所有的候选接受者。这也就大大降低了耦合度了。也就是说，我们可以随时地增加或修改处理一个请求的结构。增强了给对象指派职责的灵活性。</li>\n<li>状态模式主要解决的是当控制一个对象状态转换的条件表达式过于复杂的情况。把状态的判断逻辑转移到表示不同状态的一系列类当中，可以把复杂的判断逻辑简化。定义新的子类可以很容易地增加新的状态和转换。这样做的目的是为了消除庞大的条件分支语句。状态模式通过把各种状态转移逻辑分布到 State 的子类之间，来减少相互间的依赖。</li>\n<li>职责链模式与状态模式的最大的不同是设置自己的下一级的问题上，状态模式是在类的设计阶段就定好的，不能在客户端改变，而职责链的下一级是在客户端自己来确定的。</li>\n<li>职责链模式注重职责的传递，由客户端配置；状态模式注重对象状态的转换，转换过程对客户端是透明的。</li>\n</ul>\n<p>请假例子，找班长请假，班长只能请半天，否则班长向老师申请，如果请假时间超过一周，老师要跟副年级主任请示，如果请假超出一个月，主任要跟年级正主任请示，然后被批准，或不被批准。</p>\n<p>问题：如果班长请假了，用状态模式，其他学生都请不了假了，也就是如果状态模式中任何一环缺失的话，这个事件都无法进行下去</p>\n<p>职责链模式的链式是在客户端连接的，也就是说，如果我们请假，请假制度一旦改变，比如说我们不需要班长，或者是先请求老师后直接请求主任或者中间多了一个环节，都是很容易实现的，所以，职责链模式要比状态模式灵活很多。</p>\n<h3 id="优缺点"><a href="#%E4%BC%98%E7%BC%BA%E7%82%B9" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>优缺点</h3>\n<ul>\n<li>\n<p>优点</p>\n<ul>\n<li>降低耦合度</li>\n<li>可简化对象的相互连接</li>\n<li>增强给对象指派职责的灵活性</li>\n<li>增加新的请求处理类很方便</li>\n</ul>\n</li>\n<li>\n<p>缺点</p>\n<ul>\n<li>不能保证请求一定被接收。</li>\n<li>系统性能将受到一定影响，而且在进行代码调试时不太方便；可能会造成循环调用。</li>\n</ul>\n</li>\n</ul>\n<h3 id="模式使用"><a href="#%E6%A8%A1%E5%BC%8F%E4%BD%BF%E7%94%A8" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式使用</h3>\n<ul>\n<li>有多个对象可以处理同一个请求，具体哪个对象处理该请求由运行时刻自动确定。</li>\n<li>在不明确指定接收者的情况下，向多个对象中的一个提交一个请求。</li>\n<li>可动态指定一组对象处理请求</li>\n</ul>\n<h3 id="模式应用"><a href="#%E6%A8%A1%E5%BC%8F%E5%BA%94%E7%94%A8" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式应用</h3>\n<p><strong>异常处理机制</strong></p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="32360460816777925000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`try\n{\n    ……\n}\ncatch(ArrayIndexOutOfBoundsException e1)\n{\n    ……\n}\ncatch(ArithmeticException e2)\n{\n    ……\n}\ncatch(IOException e3)\n{\n    ……\n}\nfinally\n{\n    ……\n}`, `32360460816777925000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="java"><pre style="counter-reset: linenumber NaN" class="language-java line-numbers"><code class="language-java"><span class="token keyword">try</span>\n<span class="token punctuation">{</span>\n    ……\n<span class="token punctuation">}</span>\n<span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">ArrayIndexOutOfBoundsException</span> e1<span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    ……\n<span class="token punctuation">}</span>\n<span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">ArithmeticException</span> e2<span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    ……\n<span class="token punctuation">}</span>\n<span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">IOException</span> e3<span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    ……\n<span class="token punctuation">}</span>\n<span class="token keyword">finally</span>\n<span class="token punctuation">{</span>\n    ……\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="纯与不纯的职责链模式"><a href="#%E7%BA%AF%E4%B8%8E%E4%B8%8D%E7%BA%AF%E7%9A%84%E8%81%8C%E8%B4%A3%E9%93%BE%E6%A8%A1%E5%BC%8F" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>纯与不纯的职责链模式</h3>\n<ul>\n<li>一个纯的职责链模式要求一个具体处理者对象只能在两个行为中选择一个：一个是承担责任，另一个是把责任推给下家。不允许出现某一个具体处理者对象在承担了一部分责任后又将责任向下传的情况。</li>\n<li>在一个纯的职责链模式里面，一个请求必须被某一个处理者对象所接收；在一个不纯的职责链模式里面，一个请求可以最终不被任何接收端对象所接收。</li>\n</ul>\n<h2 id="命令模式command"><a href="#%E5%91%BD%E4%BB%A4%E6%A8%A1%E5%BC%8Fcommand" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>命令模式(Command)</h2>\n<p>将一个请求封装为一个对象，从而使你可用不同的请求对客户进行参数化；对请求排队或记录请求日志,以及支持可撤消的操作。</p>\n<h3 id="模式背景-1"><a href="#%E6%A8%A1%E5%BC%8F%E8%83%8C%E6%99%AF-1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式背景</h3>\n<p>去烧烤店吃烧烤, 如果客人直接和烧烤的伙计打交道, 则烧烤的伙计将直接面对各种各样的客户各种各样的需求,各种各样的口味, 而且有的客人会因为等不及而走掉,但是伙计却不知道…最后烧烤伙计手忙脚乱.</p>\n<p>那么，我们增加一个服务员，负责接待客户，那么客人将向服务员点菜；服务员手中拿着烧烤订单纸，客人只要把自己想要的东西写上，并注明需要的口味，服务员需按客人点餐的顺序把订单放在烧烤伙计的窗台上；如果有客人退单了，那么她只需要把订单抽掉就行了；烧烤伙计则只需要看订单安心做烧烤就行了.</p>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/微信截图_20180417155546-0ccf6ffe115b9cf8890b9bb465db6ad7-28530.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 39.52333664349553%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA7klEQVQoz02RhwqAMAxE+/+fKIIoQt24t0ZeINLAGXtZ19SN4yht24r3XqZpkm3b5H1feZ5H5nnWWJZlMgyDxrFlWTTWNI3G6UEN5sqylLquBQ8ovO9bzvP8OYZVVaWemOXDGY8Amrp932VdV52KOgrM+IeznDAGbwL4N3N86BwmX9eliVyHRkzHjuOQrutUkTWyxkVRaK4zJajAA4rSNJUoivRK7I6h8Hmeawye3QF2nCSJ7vRXiCr2hhqCcRzrGfAAmD0M6PteeWtqnLPXCY1C1ODZrV0bMBiEBm8r+xWGCBdvj2LgzC7tRng7Yx8xhmsVokOwUAAAAABJRU5ErkJggg==\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;"\n        alt="     20180417155546"\n        title=""\n        src="/static/微信截图_20180417155546-0ccf6ffe115b9cf8890b9bb465db6ad7-fee1c.png"\n        srcset="/static/微信截图_20180417155546-0ccf6ffe115b9cf8890b9bb465db6ad7-a67b7.png 200w,\n/static/微信截图_20180417155546-0ccf6ffe115b9cf8890b9bb465db6ad7-0b187.png 400w,\n/static/微信截图_20180417155546-0ccf6ffe115b9cf8890b9bb465db6ad7-fee1c.png 800w,\n/static/微信截图_20180417155546-0ccf6ffe115b9cf8890b9bb465db6ad7-28530.png 1007w"\n        sizes="(max-width: 800px) 100vw, 800px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<h3 id="模式动机-1"><a href="#%E6%A8%A1%E5%BC%8F%E5%8A%A8%E6%9C%BA-1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式动机</h3>\n<p>在软件设计中，我们经常需要向某些对象发送请求，但是并不知道请求的接收者是谁，也不知道被请求的操作是哪个，我们只需在程序运行时指定具体的请求接收者即可，此时，可以使用命令模式来进行设计，使得请求发送者与请求接收者消除彼此之间的耦合，让对象之间的调用关系更加灵活。</p>\n<h3 id="模式定义-1"><a href="#%E6%A8%A1%E5%BC%8F%E5%AE%9A%E4%B9%89-1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式定义</h3>\n<p>将一个请求封装为一个对象，从而使我们可用不同的请求对客户进行参数化；对请求排队或者记录请求日志，以及支持可撤销的操作。命令模式是一种对象行为型模式，其别名为动作(Action)模式或事务(Transaction)模式。</p>\n<h3 id="模式结构-1"><a href="#%E6%A8%A1%E5%BC%8F%E7%BB%93%E6%9E%84-1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式结构</h3>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/微信截图_20180417160505-be8943856a828ec8858e335f866da625-50b07.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 37.5886524822695%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABn0lEQVQoz51ROWgCURBdD4KChYWkSxFiytiFQJrtUqWUnBjIdkLSWaYTAqktrYQNCMsmmw0issUieIAX4okHggfiCYJgoejPzLILBkyTgf/n/3kz789/Q/X7/e9arcbPZjO53W5fU6qVy+XT6XTKgX9vNBpBOAdCodAhYoIg7E8mk0C9Xg+mUikWMLHZbJ4phQRsuVyiI61W600jLBaLd2TL1us14TjuAjGfz+eYz+dkuxYefVAKoavHbrfrghfclUrFoRFmMhk7xJ8Hg4EbF+QxkiRZEIvFYhbojMnn8y/VavW11+s9FQoFO/Uf8/v9ur8w+JWe8nq9ezzPGz0ejxmDyWTSBpo64/G4M5fL3cD5Kp1O21R5FDKImaFDzLmNRCLXiUTClc1mDzRiA240TSuEsixfoiao0Wq1IpvNhsBXacQYhlFy4H40Go3IYrEg4/FY0bDT6dz/IhRFUacmn4AuX6DfB0xPAH34aDR6jBjLskpuOBy2wfSDMERxOBx+gsZSqVQ61wiNKqnBarWi36WRXsUMJpMJvX6XhtAo9QNZIBrpgsS3AAAAAABJRU5ErkJggg==\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;"\n        alt="     20180417160505"\n        title=""\n        src="/static/微信截图_20180417160505-be8943856a828ec8858e335f866da625-fee1c.png"\n        srcset="/static/微信截图_20180417160505-be8943856a828ec8858e335f866da625-a67b7.png 200w,\n/static/微信截图_20180417160505-be8943856a828ec8858e335f866da625-0b187.png 400w,\n/static/微信截图_20180417160505-be8943856a828ec8858e335f866da625-fee1c.png 800w,\n/static/微信截图_20180417160505-be8943856a828ec8858e335f866da625-50b07.png 987w"\n        sizes="(max-width: 800px) 100vw, 800px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<ul>\n<li>Command: 抽象命令类</li>\n<li>ConcreteCommand: 具体命令类</li>\n<li>Invoker: 调用者</li>\n<li>Receiver: 接收者</li>\n<li>Client:客户类</li>\n</ul>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="13751410968545796000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`//烤肉串者\npublic class Barbecuer\n{\n    public void BakeMutton()\n    {\n        Console.WriteLine(&quot;烤羊肉串!&quot;);\n    }\n\n    public void BakeChickenWing()\n    {\n        Console.WriteLine(&quot;烤鸡翅!&quot;);\n    }\n}\n//抽象命令\npublic abstract class Command\n{\n    protected Barbecuer receiver;\n\n    public Command(Barbecuer receiver)\n    {\n        this.receiver = receiver;\n    }\n\n    //执行命令\n    abstract public void ExcuteCommand();\n}\n\n//烤羊肉串命令\nclass BakeMuttonCommand : Command\n{\n    public BakeMuttonCommand(Barbecuer receiver) : base(receiver)\n    { }\n\n    public override void ExcuteCommand()\n    {\n        receiver.BakeMutton();\n    }\n}\n\n//服务员\npublic class Waiter\n{\n    private Command command;\n\n    //设置订单\n    public void SetOrder(Command command)\n    {\n        this.command = command;\n    }\n    //通知执行\n    public void Notify()\n    {\n        command.ExcuteCommand();\n    }\n}\n\nstatic void Main(string[] args)\n{\n    //开店前的准备\n    Barbecuer boy = new Barbecuer();\n    Command bakeMuttonCommand1 = new BakeMuttonCommand(boy);\n    Command bakeMuttonCommand2 = new BakeMuttonCommand(boy);\n    Command bakeChickenWingCommand1 = new BakeChickenWingCommand(boy);\n    Waiter girl = new Waiter();\n\n    //开门营业\n    girl.SetOrder(bakeMuttonCommand1);\n    girl.Notify();\n    girl.SetOrder(bakeMuttonCommand2);\n    girl.Notify();\n    girl.SetOrder(bakeChickenWingCommand1);\n    girl.Notify();\n\n    Console.Read();\n\n}`, `13751410968545796000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp"><span class="token comment">//烤肉串者</span>\n<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Barbecuer</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">BakeMutton</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"烤羊肉串!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">BakeChickenWing</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"烤鸡翅!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token comment">//抽象命令</span>\n<span class="token keyword">public</span> abstract <span class="token keyword">class</span> <span class="token class-name">Command</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">protected</span> Barbecuer receiver<span class="token punctuation">;</span>\n\n    <span class="token keyword">public</span> <span class="token function">Command</span><span class="token punctuation">(</span>Barbecuer receiver<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>receiver <span class="token operator">=</span> receiver<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token comment">//执行命令</span>\n    abstract <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">ExcuteCommand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">//烤羊肉串命令</span>\n<span class="token keyword">class</span> <span class="token class-name">BakeMuttonCommand</span> <span class="token operator">:</span> Command\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> <span class="token function">BakeMuttonCommand</span><span class="token punctuation">(</span>Barbecuer receiver<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">base</span><span class="token punctuation">(</span>receiver<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span> <span class="token punctuation">}</span>\n\n    <span class="token keyword">public</span> override <span class="token keyword">void</span> <span class="token function">ExcuteCommand</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        receiver<span class="token punctuation">.</span><span class="token function">BakeMutton</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">//服务员</span>\n<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Waiter</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">private</span> Command command<span class="token punctuation">;</span>\n\n    <span class="token comment">//设置订单</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">SetOrder</span><span class="token punctuation">(</span>Command command<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>command <span class="token operator">=</span> command<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token comment">//通知执行</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        command<span class="token punctuation">.</span><span class="token function">ExcuteCommand</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">Main</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    <span class="token comment">//开店前的准备</span>\n    Barbecuer boy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Barbecuer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    Command bakeMuttonCommand1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">BakeMuttonCommand</span><span class="token punctuation">(</span>boy<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    Command bakeMuttonCommand2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">BakeMuttonCommand</span><span class="token punctuation">(</span>boy<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    Command bakeChickenWingCommand1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">BakeChickenWingCommand</span><span class="token punctuation">(</span>boy<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    Waiter girl <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Waiter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">//开门营业</span>\n    girl<span class="token punctuation">.</span><span class="token function">SetOrder</span><span class="token punctuation">(</span>bakeMuttonCommand1<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    girl<span class="token punctuation">.</span><span class="token function">Notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    girl<span class="token punctuation">.</span><span class="token function">SetOrder</span><span class="token punctuation">(</span>bakeMuttonCommand2<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    girl<span class="token punctuation">.</span><span class="token function">Notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    girl<span class="token punctuation">.</span><span class="token function">SetOrder</span><span class="token punctuation">(</span>bakeChickenWingCommand1<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    girl<span class="token punctuation">.</span><span class="token function">Notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Console<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="优缺点-1"><a href="#%E4%BC%98%E7%BC%BA%E7%82%B9-1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>优缺点</h3>\n<ul>\n<li>\n<p>优点</p>\n<ul>\n<li>降低系统的耦合度。</li>\n<li>新的命令可以很容易地加入到系统中。</li>\n<li>可以比较容易地设计一个命令队列和宏命令（组合命令）。</li>\n<li>可以方便地实现对请求的 Undo 和 Redo。</li>\n</ul>\n</li>\n<li>\n<p>缺点</p>\n<ul>\n<li>使用命令模式可能会导致某些系统有过多的具体命令类。因为针对每一个命令都需要设计一个具体命令类，因此某些系统可能需要大量具体命令类，这将影响命令模式的使用。</li>\n</ul>\n</li>\n</ul>\n<h3 id="模式使用-1"><a href="#%E6%A8%A1%E5%BC%8F%E4%BD%BF%E7%94%A8-1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式使用</h3>\n<ul>\n<li>系统需要将请求调用者和请求接收者解耦，使得调用者和接收者不直接交互。</li>\n<li>系统需要在不同的时间指定请求、将请求排队和执行请求。</li>\n<li>系统需要支持命令的撤销(Undo)操作和恢复(Redo)操作。</li>\n<li>系统需要将一组操作组合在一起，即支持宏命令。</li>\n</ul>\n<h2 id="迭代器模式iterator"><a href="#%E8%BF%AD%E4%BB%A3%E5%99%A8%E6%A8%A1%E5%BC%8Fiterator" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>迭代器模式(Iterator)</h2>\n<p>提供一种方法顺序访问一个聚合对象中各个元素，而又不暴露该对象的内部表示。</p>\n<h3 id="模式背景-2"><a href="#%E6%A8%A1%E5%BC%8F%E8%83%8C%E6%99%AF-2" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式背景</h3>\n<p>每个人都要买车票</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="14121013060153232"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`static void Main(string[] args)\n{\n    ArrayList a = new ArrayList() ;\n    a.Add(&quot;大鸟&quot;);\n    a.Add(&quot;小菜&quot;);\n    a.Add(&quot;行李&quot;);\n    a.Add(&quot;老外&quot;);\n    a.Add(&quot;公交内部员工&quot;);\n    a.Add(“小朋友&quot;);\n\n    foreach (string item in a)\n    {\n        Console.WriteLine(&quot;{0} 请买车票!&quot;, item);\n    }\n    Console.Read();\n}`, `14121013060153232`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp"><span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">Main</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    ArrayList a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">ArrayList</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>\n    a<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">"大鸟"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    a<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">"小菜"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    a<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">"行李"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    a<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">"老外"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    a<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token string">"公交内部员工"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    a<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>“小朋友"<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    foreach <span class="token punctuation">(</span>string item in a<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"{0} 请买车票!"</span><span class="token punctuation">,</span> item<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    Console<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="模式动机-2"><a href="#%E6%A8%A1%E5%BC%8F%E5%8A%A8%E6%9C%BA-2" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式动机</h3>\n<ul>\n<li>一个聚合对象，如一个列表(List)或者一个集合(Set)，应该提供一种方法来让别人可以访问它的元素，而又不需要暴露它的内部结构。</li>\n<li>针对不同的需要，可能还要以不同的方式遍历整个聚合对象，但是我们并不希望在聚合对象的抽象层接口中充斥着各种不同遍历的操作。</li>\n<li>怎样遍历一个聚合对象，又不需要了解聚合对象的内部结构，还能够提供多种不同的遍历方式，这就是迭代器模式所要解决的问题。</li>\n<li>在迭代器模式中，提供一个外部的迭代器来对聚合对象进行访问和遍历，迭代器定义了一个访问该聚合元素的接口，并且可以跟踪当前遍历的元素，了解哪些元素已经遍历过而哪些没有。</li>\n<li>有了迭代器模式，我们会发现对一个复杂的聚合对象的操作会变得如此简单。</li>\n</ul>\n<h3 id="模式定义-2"><a href="#%E6%A8%A1%E5%BC%8F%E5%AE%9A%E4%B9%89-2" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式定义</h3>\n<p>提供一种方法来访问聚合对象，而不用暴露这个对象的内部表示，其别名为游标(Cursor)。迭代器模式是一种对象行为型模式。</p>\n<h3 id="模式结构-2"><a href="#%E6%A8%A1%E5%BC%8F%E7%BB%93%E6%9E%84-2" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式结构</h3>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/微信截图_20180417162005-506e308004727d40fbeca813261ae94a-8945d.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 43.27354260089686%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABwklEQVQoz4VRS0sCURSeyR60aFe7ILJRobW/oEWLShLc1NqdtHFhQi0ycBMIrloEIUxigRS1DkEEBfGJD3yLKL5hxBc+wds5MopE0oEzczjf/b5z7/ko6o8YjUY0tSQCgcBePp+/CYVCapfLpYb6NplMniBGCKGpRCJhsdvt5ng8/lqpVJ6sVus2gplM5hLyAwRYIFmi0SiD/VgsdgpE0u12SaPRwJIUCoVPXnAVP2QymUyBXq9HjEbjIYKpVMpEFsLpdB5h32aznZVKJdJutzvwkg5i1WrVxAsKqGazyRaLxW+Y9lar1R5Zlt3hBS84jrO2Wi0TEFiv1yvCfiQSkZFfAeJf8xtiKJXK3cU9AbBshZTD4RD6/X6dx+N5cLvdz/V6/R5WI5/vcFmgKB6Y5X8EwFYofskan8+nheVrYdKV2Wzewr5cLqclEgktEolohmFovV4/JQSDQSEYeAepCYfD1+l0WpfNZmXzgegUuEvg6iSXy43BlAMExWLxBvzWZqlQKDaxD8887/f7pFwuT3nj8ZiA4PvcFGhOAByBAQQM4gwGwz6CUqkUhQSzVKlU6/yLjtEIEBoMh8MB1mDmy0zwBzksZ9nP5CTrAAAAAElFTkSuQmCC\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;"\n        alt="     20180417162005"\n        title=""\n        src="/static/微信截图_20180417162005-506e308004727d40fbeca813261ae94a-fee1c.png"\n        srcset="/static/微信截图_20180417162005-506e308004727d40fbeca813261ae94a-a67b7.png 200w,\n/static/微信截图_20180417162005-506e308004727d40fbeca813261ae94a-0b187.png 400w,\n/static/微信截图_20180417162005-506e308004727d40fbeca813261ae94a-fee1c.png 800w,\n/static/微信截图_20180417162005-506e308004727d40fbeca813261ae94a-8945d.png 892w"\n        sizes="(max-width: 800px) 100vw, 800px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<ul>\n<li>Iterator: 抽象迭代器</li>\n<li>ConcreteIterator: 具体迭代器</li>\n<li>Aggregate: 抽象聚合类</li>\n<li>ConcreteAggregate: 具体聚合类</li>\n</ul>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="93181323388528540000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`abstract class Iterator\n{\n    public abstract object First();\n    public abstract object Next();\n    public abstract bool IsDone();\n    public abstract object CurrentItem();\n}\nabstract class Aggregate\n{\n    public abstract Iterator CreateIterator();\n}\nclass ConcreteAggregate : Aggregate\n{\n    private IList<object> items = new List<object>();\n    public override Iterator CreateIterator()\n    {\n        return new ConcreteIterator(this);\n    }\n\n    public int Count\n    {\n        get { return items.Count; }\n    }\n\n    public object this[int index]\n    {\n        get { return items[index]; }\n        set { items.Insert(index, value); }\n    }\n}\nclass ConcreteIterator : Iterator\n{\n    private ConcreteAggregate aggregate;\n    private int current = 0;\n    public ConcreteIterator(ConcreteAggregate aggregate)\n    {\n        this.aggregate = aggregate;\n    }\n    public override object First()\n    {\n        return aggregate[0];\n    }\n    public override object Next()\n    {\n        object ret = null;\n        current++;\n        if (current < aggregate.Count)\n        {\n            ret = aggregate[current];\n        }\n        return ret;\n    }\n    public override object CurrentItem()\n    {\n        return aggregate[current];\n    }\n    public override bool IsDone()\n    {\n        return current >= aggregate.Count ? true : false;\n    }\n}\nstatic void Main(string[] args)\n{\n    ConcreteAggregate a = new ConcreteAggregate();\n    a[0] = &quot;大鸟&quot;;\n    a[1] = &quot;小菜&quot;;\n    a[2] = &quot;行李&quot;;\n    a[3] = &quot;老外&quot;;\n    a[4] = &quot;公交内部员工&quot;;\n    a[5] = &quot;小朋友&quot;;\n    Iterator i = a.CreateIterator();\n    object item = i.First();\n    while (!i.IsDone())\n    {\n        Console.WriteLine(&quot;{0} 请买车票!&quot;, i.CurrentItem());\n        i.Next();\n    }\n    Console.Read();\n}`, `93181323388528540000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp">abstract <span class="token keyword">class</span> <span class="token class-name">Iterator</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> abstract object <span class="token function">First</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">public</span> abstract object <span class="token function">Next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">public</span> abstract <span class="token keyword">bool</span> <span class="token function">IsDone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">public</span> abstract object <span class="token function">CurrentItem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\nabstract <span class="token keyword">class</span> <span class="token class-name">Aggregate</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> abstract Iterator <span class="token function">CreateIterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">class</span> <span class="token class-name">ConcreteAggregate</span> <span class="token operator">:</span> Aggregate\n<span class="token punctuation">{</span>\n    <span class="token keyword">private</span> IList<span class="token operator">&lt;</span>object<span class="token operator">></span> items <span class="token operator">=</span> <span class="token keyword">new</span> List<span class="token operator">&lt;</span>object<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">public</span> override Iterator <span class="token function">CreateIterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token function">ConcreteIterator</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">public</span> <span class="token keyword">int</span> Count\n    <span class="token punctuation">{</span>\n        get <span class="token punctuation">{</span> <span class="token keyword">return</span> items<span class="token punctuation">.</span>Count<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">public</span> object <span class="token keyword">this</span><span class="token punctuation">[</span><span class="token keyword">int</span> index<span class="token punctuation">]</span>\n    <span class="token punctuation">{</span>\n        get <span class="token punctuation">{</span> <span class="token keyword">return</span> items<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>\n        set <span class="token punctuation">{</span> items<span class="token punctuation">.</span><span class="token function">Insert</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">class</span> <span class="token class-name">ConcreteIterator</span> <span class="token operator">:</span> Iterator\n<span class="token punctuation">{</span>\n    <span class="token keyword">private</span> ConcreteAggregate aggregate<span class="token punctuation">;</span>\n    <span class="token keyword">private</span> <span class="token keyword">int</span> current <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>\n    <span class="token keyword">public</span> <span class="token function">ConcreteIterator</span><span class="token punctuation">(</span>ConcreteAggregate aggregate<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>aggregate <span class="token operator">=</span> aggregate<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> override object <span class="token function">First</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> aggregate<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> override object <span class="token function">Next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        object ret <span class="token operator">=</span> null<span class="token punctuation">;</span>\n        current<span class="token operator">++</span><span class="token punctuation">;</span>\n        <span class="token keyword">if</span> <span class="token punctuation">(</span>current <span class="token operator">&lt;</span> aggregate<span class="token punctuation">.</span>Count<span class="token punctuation">)</span>\n        <span class="token punctuation">{</span>\n            ret <span class="token operator">=</span> aggregate<span class="token punctuation">[</span>current<span class="token punctuation">]</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n        <span class="token keyword">return</span> ret<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> override object <span class="token function">CurrentItem</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> aggregate<span class="token punctuation">[</span>current<span class="token punctuation">]</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> override <span class="token keyword">bool</span> <span class="token function">IsDone</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> current <span class="token operator">>=</span> aggregate<span class="token punctuation">.</span>Count <span class="token operator">?</span> <span class="token boolean">true</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">Main</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    ConcreteAggregate a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">ConcreteAggregate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"大鸟"</span><span class="token punctuation">;</span>\n    a<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"小菜"</span><span class="token punctuation">;</span>\n    a<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"行李"</span><span class="token punctuation">;</span>\n    a<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"老外"</span><span class="token punctuation">;</span>\n    a<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"公交内部员工"</span><span class="token punctuation">;</span>\n    a<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"小朋友"</span><span class="token punctuation">;</span>\n    Iterator i <span class="token operator">=</span> a<span class="token punctuation">.</span><span class="token function">CreateIterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    object item <span class="token operator">=</span> i<span class="token punctuation">.</span><span class="token function">First</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span>i<span class="token punctuation">.</span><span class="token function">IsDone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"{0} 请买车票!"</span><span class="token punctuation">,</span> i<span class="token punctuation">.</span><span class="token function">CurrentItem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        i<span class="token punctuation">.</span><span class="token function">Next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    Console<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="索引器"><a href="#%E7%B4%A2%E5%BC%95%E5%99%A8" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>索引器</h3>\n<p>索引器允许类和结构的实例用下标进行访问，这种方式类似于访问数组、集合的元素，但不单单是通过下标，例如通过对象的各属性值也是可以的。索引器写在类或者结构中，其格式类似于：</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="50438565890980660000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`public object this[int index]\n{\n    get { return objects[int]; }\n    set { objects[int] = value; }\n}`, `50438565890980660000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp"><span class="token keyword">public</span> object <span class="token keyword">this</span><span class="token punctuation">[</span><span class="token keyword">int</span> index<span class="token punctuation">]</span>\n<span class="token punctuation">{</span>\n    get <span class="token punctuation">{</span> <span class="token keyword">return</span> objects<span class="token punctuation">[</span><span class="token keyword">int</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>\n    set <span class="token punctuation">{</span> objects<span class="token punctuation">[</span><span class="token keyword">int</span><span class="token punctuation">]</span> <span class="token operator">=</span> value<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>索引器是特殊的属性，可以有 get、set 访问器，可以重载。object 是返回的对象类型，this 代表类或结构自己，int index 表示索引类型。这与索引器的调用格式：对象[索引]，相对应。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="44527460490560640000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`public class Car\n{\n    /// <summary>\n    /// 品牌\n    /// </summary>\n    public string Brand { get; set; }\n\n    /// <summary>\n    /// 颜色\n    /// </summary>\n    public string Color { get; set; }\n\n    /// <summary>\n    /// 覆盖object的ToString()方法\n    /// </summary>\n    /// <returns></returns>\n    public override string ToString()\n    {\n        return string.Format(&quot;A {0} {1}.&quot;, this.Color, this.Brand);\n    }\n}\npublic class Cars\n{\n    public IList<Car> List { get; set; }\n    /// <summary>\n    /// 用下标访问的索引器\n    /// </summary>\n    /// <param name=&quot;index&quot;>下标</param>\n    /// <returns>汽车</returns>\n    public Car this[int index]\n    {\n        get { return this.List[index]; }\n    }\n    /// <summary>\n    /// 用品牌访问的索引器\n    /// </summary>\n    /// <param name=&quot;brand&quot;>品牌</param>\n    /// <returns>汽车</returns>\n    public Car this[string brand]\n    {\n        get\n        {\n            for (int i = 0; i < List.Count; i+\n                if (brand.Equals(this.List[i].Brand))\n                return this.List[i];\n            return null;\n        }\n    }\n}\n\npublic static void Main(string[] args)\n{\n    Cars cars = new Cars\n    {\n        List = new List<Car>\n        {\n            new Car { Brand = &quot;BMW&quot;, Color = &quot;Black&quot; },     // 黑色宝马\n            new Car { Brand = &quot;Benz&quot;, Color = &quot;Red&quot; },      // 红色奔驰\n            new Car { Brand = &quot;Porsche&quot;, Color = &quot;Yellow&quot; } // 黄色保时捷\n        }\n    };\n     \n    Console.Title = &quot;索引器&quot;;\n    Console.WriteLine(cars[0].ToString());\n    Console.WriteLine(cars[&quot;Porsche&quot;].ToString());\n     \n    Console.ReadLine();\n}`, `44527460490560640000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Car</span>\n<span class="token punctuation">{</span>\n    <span class="token comment">/// &lt;summary></span>\n    <span class="token comment">/// 品牌</span>\n    <span class="token comment">/// &lt;/summary></span>\n    <span class="token keyword">public</span> string Brand <span class="token punctuation">{</span> get<span class="token punctuation">;</span> set<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n\n    <span class="token comment">/// &lt;summary></span>\n    <span class="token comment">/// 颜色</span>\n    <span class="token comment">/// &lt;/summary></span>\n    <span class="token keyword">public</span> string Color <span class="token punctuation">{</span> get<span class="token punctuation">;</span> set<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n\n    <span class="token comment">/// &lt;summary></span>\n    <span class="token comment">/// 覆盖object的ToString()方法</span>\n    <span class="token comment">/// &lt;/summary></span>\n    <span class="token comment">/// &lt;returns>&lt;/returns></span>\n    <span class="token keyword">public</span> override string <span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> string<span class="token punctuation">.</span><span class="token function">Format</span><span class="token punctuation">(</span><span class="token string">"A {0} {1}."</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>Color<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>Brand<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Cars</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> IList<span class="token operator">&lt;</span>Car<span class="token operator">></span> List <span class="token punctuation">{</span> get<span class="token punctuation">;</span> set<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n    <span class="token comment">/// &lt;summary></span>\n    <span class="token comment">/// 用下标访问的索引器</span>\n    <span class="token comment">/// &lt;/summary></span>\n    <span class="token comment">/// &lt;param name="index">下标&lt;/param></span>\n    <span class="token comment">/// &lt;returns>汽车&lt;/returns></span>\n    <span class="token keyword">public</span> Car <span class="token keyword">this</span><span class="token punctuation">[</span><span class="token keyword">int</span> index<span class="token punctuation">]</span>\n    <span class="token punctuation">{</span>\n        get <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>List<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n    <span class="token comment">/// &lt;summary></span>\n    <span class="token comment">/// 用品牌访问的索引器</span>\n    <span class="token comment">/// &lt;/summary></span>\n    <span class="token comment">/// &lt;param name="brand">品牌&lt;/param></span>\n    <span class="token comment">/// &lt;returns>汽车&lt;/returns></span>\n    <span class="token keyword">public</span> Car <span class="token keyword">this</span><span class="token punctuation">[</span>string brand<span class="token punctuation">]</span>\n    <span class="token punctuation">{</span>\n        get\n        <span class="token punctuation">{</span>\n            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> List<span class="token punctuation">.</span>Count<span class="token punctuation">;</span> i<span class="token operator">+</span>\n                <span class="token keyword">if</span> <span class="token punctuation">(</span>brand<span class="token punctuation">.</span><span class="token function">Equals</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>List<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>Brand<span class="token punctuation">)</span><span class="token punctuation">)</span>\n                <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>List<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>\n            <span class="token keyword">return</span> null<span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">Main</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    Cars cars <span class="token operator">=</span> <span class="token keyword">new</span> Cars\n    <span class="token punctuation">{</span>\n        List <span class="token operator">=</span> <span class="token keyword">new</span> List<span class="token operator">&lt;</span>Car<span class="token operator">></span>\n        <span class="token punctuation">{</span>\n            <span class="token keyword">new</span> Car <span class="token punctuation">{</span> Brand <span class="token operator">=</span> <span class="token string">"BMW"</span><span class="token punctuation">,</span> Color <span class="token operator">=</span> <span class="token string">"Black"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>     <span class="token comment">// 黑色宝马</span>\n            <span class="token keyword">new</span> Car <span class="token punctuation">{</span> Brand <span class="token operator">=</span> <span class="token string">"Benz"</span><span class="token punctuation">,</span> Color <span class="token operator">=</span> <span class="token string">"Red"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>      <span class="token comment">// 红色奔驰</span>\n            <span class="token keyword">new</span> Car <span class="token punctuation">{</span> Brand <span class="token operator">=</span> <span class="token string">"Porsche"</span><span class="token punctuation">,</span> Color <span class="token operator">=</span> <span class="token string">"Yellow"</span> <span class="token punctuation">}</span> <span class="token comment">// 黄色保时捷</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span><span class="token punctuation">;</span>\n     \n    Console<span class="token punctuation">.</span>Title <span class="token operator">=</span> <span class="token string">"索引器"</span><span class="token punctuation">;</span>\n    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>cars<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>cars<span class="token punctuation">[</span><span class="token string">"Porsche"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">ToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n     \n    Console<span class="token punctuation">.</span><span class="token function">ReadLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="优缺点-2"><a href="#%E4%BC%98%E7%BC%BA%E7%82%B9-2" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>优缺点</h3>\n<ul>\n<li>\n<p>优点</p>\n<ul>\n<li>它支持以不同的方式遍历一个聚合对象。</li>\n<li>迭代器简化了聚合类。</li>\n<li>在同一个聚合上可以有多个遍历。</li>\n<li>在迭代器模式中，增加新的聚合类和迭代器类都很方便，无须修改原有代码，满足“开闭原则”的要求。</li>\n</ul>\n</li>\n<li>\n<p>缺点</p>\n<ul>\n<li>由于迭代器模式将存储数据和遍历数据的职责分离，增加新的聚合类需要对应增加新的迭代器类，类的个数成对增加，这在一定程度上增加了系统的复杂性。</li>\n</ul>\n</li>\n</ul>\n<h3 id="模式使用-2"><a href="#%E6%A8%A1%E5%BC%8F%E4%BD%BF%E7%94%A8-2" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式使用</h3>\n<ul>\n<li>访问一个聚合对象的内容而无须暴露它的内部表示。</li>\n<li>需要为聚合对象提供多种遍历方式。</li>\n<li>为遍历不同的聚合结构提供一个统一的接口。</li>\n</ul>\n<h2 id="中介者模式mediator"><a href="#%E4%B8%AD%E4%BB%8B%E8%80%85%E6%A8%A1%E5%BC%8Fmediator" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>中介者模式(Mediator)</h2>\n<p>用一个中介对象来封装一系列的对象交互。中介者使各对象不需要显式地相互引用，从而使其耦合松散，而且可以独立地改变它们之间的交互。</p>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/微信截图_20180417165036-84dc94ac430eb9aa4ddfcbf42151b40b-f170f.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 55.54347826086957%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAACWklEQVQoz32TS2/TUBBG8xu7Yc8/YIPYsEQsWCCBxIIFK2ADhVIepaVVW1FSQlukhrZpGpI0ceIb24kfefhtHyZukEBIjDS6V7Lume+bGZfyPIdF5oucRxBn3Hz6iaX7z1l68JprTza5/q7Kjb1LbpVb3C63uVvRuLff5VGlwcPKBXf2O5Tmj/NF/hlJmrO8e8Ty1g4vyzXeH5yxWr3g1XGDtR/nbNR6bDdMHq/VaOy+R+2tcPzjlFIwnUAcFxn6PlmWFcBUzrZyaPc8OsqjP5ygWRMGji/3KcNxhOGMOWoN+KaNaZserYFNSfu4CufnUKuhf94iCvyFwpSe6WI6MwwvwJpGjIIUJ8rwRL2bZPhyRnGCH0bEUSz3lFLW06Beh5MTMqVDFBbAeS81w0GN5qoEOhboLBZoItAUVx4HWU4cBpgjD8ebiDsBdl88g04HLIv+hxVGjo01meKJfd1yUcO/gXZ4BfNE4UTOMM0IRGkoGSQCTGwb3ryB7W3Sr1/RhyNODRPluBhSeWBPMV1fiohlPyksj5McX6bYH7kcVmtoUnAg31vS21Jvex3WN2D1Lfq3L2RJdGVZhtJRQ7rKoitKe/YENRbwLMSY+NgJGIMuxzubNMXFUPpriINS+P0AWi0ppxMaqphuXgwlo6kNaF42aWg6TaW4HNqiyuFnXxWKNENj7+g7dX2EGWSoqQC75Z2rxZYG9w/KhNLk32sTpxn/C3fqs1M55LxvFUB9DvxnsRd/SiYF6m2Ns0aHar1N9aItVkM0c0TfsunoA5Q75eSyjyZrpWZJAfwFW0wzT63Y2O4AAAAASUVORK5CYII=\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;"\n        alt="     20180417165036"\n        title=""\n        src="/static/微信截图_20180417165036-84dc94ac430eb9aa4ddfcbf42151b40b-fee1c.png"\n        srcset="/static/微信截图_20180417165036-84dc94ac430eb9aa4ddfcbf42151b40b-a67b7.png 200w,\n/static/微信截图_20180417165036-84dc94ac430eb9aa4ddfcbf42151b40b-0b187.png 400w,\n/static/微信截图_20180417165036-84dc94ac430eb9aa4ddfcbf42151b40b-fee1c.png 800w,\n/static/微信截图_20180417165036-84dc94ac430eb9aa4ddfcbf42151b40b-f170f.png 920w"\n        sizes="(max-width: 800px) 100vw, 800px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>系统将出现如下问题</p>\n<ul>\n<li>系统结构复杂：对象之间存在大量的相互关联和调用，若有一个对象发生变化，则需要跟踪和该对象关联的其他所有对象，并进行适当处理。</li>\n<li>对象可重用性差：由于一个对象和其他对象具有很强的关联，若没有其他对象的支持，一个对象很难被另一个系统或模块重用，这些对象表现出来更像一个不可分割的整体，职责较为混乱。</li>\n<li>系统扩展性低：增加一个新的对象需要在原有相关对象上增加引用，增加新的引用关系也需要调整原有对象，系统耦合度很高，对象操作很不灵活，扩展性差。</li>\n</ul>\n<h3 id="模式动机-3"><a href="#%E6%A8%A1%E5%BC%8F%E5%8A%A8%E6%9C%BA-3" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式动机</h3>\n<ul>\n<li>在面向对象的软件设计与开发过程中，根据“单一职责原则”，我们应该尽量将对象细化，使其只负责或呈现单一的职责。</li>\n<li>对于一个模块，可能由很多对象构成，而且这些对象之间可能存在相互的引用，为了减少对象两两之间复杂的引用关系，使之成为一个松耦合的系统，我们需要使用中介者模式，这就是中介者模式的模式动机。</li>\n</ul>\n<h3 id="模式定义-3"><a href="#%E6%A8%A1%E5%BC%8F%E5%AE%9A%E4%B9%89-3" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式定义</h3>\n<p>用一个中介对象来封装一系列的对象交互，中介者使各对象不需要显式地相互引用，从而使其耦合松散，而且可以独立地改变它们之间的交互。中介者模式又称为调停者模式，它是一种对象行为型模式。</p>\n<h3 id="模式结构-3"><a href="#%E6%A8%A1%E5%BC%8F%E7%BB%93%E6%9E%84-3" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式结构</h3>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/微信截图_20180417165436-7bbfb928740ada381515f95ff20892cf-a7643.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 42.970521541950106%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAB0klEQVQoz31SS0tCURA+Vy9XQwsV8ge0UYLAlpdUyF8g7lu5aeG6RVsJIbJcuZAIXGSJBtHCRQiCiIr4xgc+UNBUrkmKYiKEpzmikpQNHIbzfd/MnDMzqFQqecPhsLvT6Ty3Wq0LhBDFMAylUCh4Op2OB3fkdDpFwN9VKpWnaDT62Gw2X9rt9hnhMMYoFouhlQGAZ7MZcbjRaLwBxPD5fFoulzNKpZIhGpvNtjsajfBPLSSNLOKptYTdbveqVqs9cBxH/ClCa8Xmvl6vC6DYOWhvQHPf6/UuwZ8QDgpRgUBgpf1lpBrLsugfE24i5kntdrvUaDTK3G63JJFIiJdkuVymrFaryGQy7ej1epnD4ZB5PB4xBPFcLpfEYrFIDAaDDPhts9m8tXphsVgcpFKp90Kh8FmtVl9pmuYT3Ov17gPXhfORz+c5OF+ZTOaacLlcLgj6MXBcNpsdQ3yI9HKecDqd4uFwuGx0HCDBYrKH/X4fTyYTPBgMlkO7JRxMPE/uBCdDgu0okO2YJ4xEIhq/36+F6mpYn4Pll0OhkCAej7PJZPIIWsHCK7SA7REOdKp0Oq32+XzHEK8NBoOqjR2nKIoRCoVkXei/eKlUymyK1Wg06BsJfjLBdmFBkwAAAABJRU5ErkJggg==\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;"\n        alt="     20180417165436"\n        title=""\n        src="/static/微信截图_20180417165436-7bbfb928740ada381515f95ff20892cf-fee1c.png"\n        srcset="/static/微信截图_20180417165436-7bbfb928740ada381515f95ff20892cf-a67b7.png 200w,\n/static/微信截图_20180417165436-7bbfb928740ada381515f95ff20892cf-0b187.png 400w,\n/static/微信截图_20180417165436-7bbfb928740ada381515f95ff20892cf-fee1c.png 800w,\n/static/微信截图_20180417165436-7bbfb928740ada381515f95ff20892cf-a7643.png 882w"\n        sizes="(max-width: 800px) 100vw, 800px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<ul>\n<li>Mediator: 抽象中介者</li>\n<li>ConcreteMediator: 具体中介者</li>\n<li>Colleague: 抽象同事类</li>\n<li>ConcreteColleague: 具体同事类</li>\n</ul>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="62574606332753290000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`abstract class Colleague\n{\n    protected Mediator mediator;\n\n    public Colleague(Mediator mediator)\n    {\n        this.mediator = mediator;\n    }\n}\nabstract class Mediator\n{\n    public abstract void Send(string message, Colleague colleague);\n}\nclass ConcreteColleague1 : Colleague\n{\n    public ConcreteColleague1(Mediator mediator) : base(mediator)\n    {\n    }\n    public void Send(string message)\n    {\n        mediator.Send(message, this);\n    }\n    public void Notify(string message)\n    {\n        Console.WriteLine(&quot;同事1得到信息:&quot; + message);\n    }\n}\nclass ConcreteColleague2 : Colleague\n{\n    public ConcreteColleague2(Mediator mediator) : base(mediator)\n    {\n    }\n    public void Send(string message)\n    {\n        mediator.Send(message, this);\n    }\n    public void Notify(string message)\n    {\n        Console.WriteLine(&quot;同事2得到信息:&quot; + message);\n    }\n}\nclass ConcreteMediator : Mediator\n{\n    private ConcreteColleague1 colleague1;\n    private ConcreteColleague2 colleague2;\n\n    public ConcreteColleague1 Colleague1\n    {\n        set { colleague1 = value; }\n    }\n\n    public ConcreteColleague2 Colleague2\n    {\n        set { colleague2 = value; }\n    }\n\n    public override void Send(string message, Colleague colleague)\n    {\n        if (colleague == colleague1)\n        {\n            colleague2.Notify(message);\n        }\n        else\n        {\n            colleague1.Notify(message);\n        }\n    }\n}\nstatic void Main(string[] args)\n{\n    ConcreteMediator m = new ConcreteMediator();\n\n    ConcreteColleague1 c1 = new ConcreteColleague1(m);\n    ConcreteColleague2 c2 = new ConcreteColleague2(m);\n\n    m.Colleague1 = c1;\n    m.Colleague2 = c2;\n\n    c1.Send(&quot;吃过饭了吗?&quot;);\n    c2.Send(&quot;没有呢，你打算请客？&quot;);\n\n    Console.Read();\n}`, `62574606332753290000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp">abstract <span class="token keyword">class</span> <span class="token class-name">Colleague</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">protected</span> Mediator mediator<span class="token punctuation">;</span>\n\n    <span class="token keyword">public</span> <span class="token function">Colleague</span><span class="token punctuation">(</span>Mediator mediator<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>mediator <span class="token operator">=</span> mediator<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\nabstract <span class="token keyword">class</span> <span class="token class-name">Mediator</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> abstract <span class="token keyword">void</span> <span class="token function">Send</span><span class="token punctuation">(</span>string message<span class="token punctuation">,</span> Colleague colleague<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">class</span> <span class="token class-name">ConcreteColleague1</span> <span class="token operator">:</span> Colleague\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> <span class="token function">ConcreteColleague1</span><span class="token punctuation">(</span>Mediator mediator<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">base</span><span class="token punctuation">(</span>mediator<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Send</span><span class="token punctuation">(</span>string message<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        mediator<span class="token punctuation">.</span><span class="token function">Send</span><span class="token punctuation">(</span>message<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Notify</span><span class="token punctuation">(</span>string message<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"同事1得到信息:"</span> <span class="token operator">+</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">class</span> <span class="token class-name">ConcreteColleague2</span> <span class="token operator">:</span> Colleague\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> <span class="token function">ConcreteColleague2</span><span class="token punctuation">(</span>Mediator mediator<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">base</span><span class="token punctuation">(</span>mediator<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Send</span><span class="token punctuation">(</span>string message<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        mediator<span class="token punctuation">.</span><span class="token function">Send</span><span class="token punctuation">(</span>message<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Notify</span><span class="token punctuation">(</span>string message<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"同事2得到信息:"</span> <span class="token operator">+</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">class</span> <span class="token class-name">ConcreteMediator</span> <span class="token operator">:</span> Mediator\n<span class="token punctuation">{</span>\n    <span class="token keyword">private</span> ConcreteColleague1 colleague1<span class="token punctuation">;</span>\n    <span class="token keyword">private</span> ConcreteColleague2 colleague2<span class="token punctuation">;</span>\n\n    <span class="token keyword">public</span> ConcreteColleague1 Colleague1\n    <span class="token punctuation">{</span>\n        set <span class="token punctuation">{</span> colleague1 <span class="token operator">=</span> value<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">public</span> ConcreteColleague2 Colleague2\n    <span class="token punctuation">{</span>\n        set <span class="token punctuation">{</span> colleague2 <span class="token operator">=</span> value<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">public</span> override <span class="token keyword">void</span> <span class="token function">Send</span><span class="token punctuation">(</span>string message<span class="token punctuation">,</span> Colleague colleague<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">if</span> <span class="token punctuation">(</span>colleague <span class="token operator">==</span> colleague1<span class="token punctuation">)</span>\n        <span class="token punctuation">{</span>\n            colleague2<span class="token punctuation">.</span><span class="token function">Notify</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n        <span class="token keyword">else</span>\n        <span class="token punctuation">{</span>\n            colleague1<span class="token punctuation">.</span><span class="token function">Notify</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">Main</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    ConcreteMediator m <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">ConcreteMediator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    ConcreteColleague1 c1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">ConcreteColleague1</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    ConcreteColleague2 c2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">ConcreteColleague2</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    m<span class="token punctuation">.</span>Colleague1 <span class="token operator">=</span> c1<span class="token punctuation">;</span>\n    m<span class="token punctuation">.</span>Colleague2 <span class="token operator">=</span> c2<span class="token punctuation">;</span>\n\n    c1<span class="token punctuation">.</span><span class="token function">Send</span><span class="token punctuation">(</span><span class="token string">"吃过饭了吗?"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    c2<span class="token punctuation">.</span><span class="token function">Send</span><span class="token punctuation">(</span><span class="token string">"没有呢，你打算请客？"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Console<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="优缺点-3"><a href="#%E4%BC%98%E7%BC%BA%E7%82%B9-3" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>优缺点</h3>\n<ul>\n<li>\n<p>优点</p>\n<ul>\n<li>简化了对象之间的交互。</li>\n<li>将各同事解耦。</li>\n<li>减少子类生成。</li>\n<li>可以简化各同事类的设计和实现。</li>\n</ul>\n</li>\n<li>\n<p>缺点</p>\n<ul>\n<li>在具体中介者类中包含了同事之间的交互细节，可能会导致具体中介者类非常复杂，使得系统难以维护。</li>\n</ul>\n</li>\n</ul>\n<h3 id="模式使用-3"><a href="#%E6%A8%A1%E5%BC%8F%E4%BD%BF%E7%94%A8-3" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式使用</h3>\n<ul>\n<li>系统中对象之间存在复杂的引用关系，产生的相互依赖关系结构混乱且难以理解。</li>\n<li>一个对象由于引用了其他很多对象并且直接和这些对象通信，导致难以复用该对象。</li>\n<li>想通过一个中间类来封装多个类中的行为，而又不想生成太多的子类。可以通过引入中介者类来实现，在中介者中定义对象交互的公共行为，如果需要改变行为则可以增加新的中介者类。</li>\n</ul>\n<h3 id="模式应用-1"><a href="#%E6%A8%A1%E5%BC%8F%E5%BA%94%E7%94%A8-1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式应用</h3>\n<ul>\n<li>中介者模式与迪米特法则</li>\n<li>在中介者模式中，通过创造出一个中介者对象，将系统中有关的对象所引用的其他对象数目减少到最少，使得一个对象与其同事之间的相互作用被这个对象与中介者对象之间的相互作用所取代。因此，中介者模式就是迪米特法则的一个典型应用。</li>\n</ul>',
id:"/github/workspace/blog/设计模式之行为型模式（一）/index.md absPath of file >>> MarkdownRemark",timeToRead:12,frontmatter:{date:"2018-04-19 00:04:40",path:"/design-pattern-behavior-1/",tags:"面试, 设计模式",title:"设计模式之行为型模式（一）",draft:null}},{excerpt:"外观模式(Facade) 为子系统中的一组接口提供一个一致的界面，Facade…",html:'<h2 id="外观模式facade"><a href="#%E5%A4%96%E8%A7%82%E6%A8%A1%E5%BC%8Ffacade" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>外观模式(Facade)</h2>\n<p>为子系统中的一组接口提供一个一致的界面，Facade 模式定义了一个高层接口，这个接口使得这一子系统更加容易使用。</p>\n<h3 id="模式背景"><a href="#%E6%A8%A1%E5%BC%8F%E8%83%8C%E6%99%AF" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式背景</h3>\n<p>当客户来进行抵押贷款时，有如下几件事情需要确认：</p>\n<ol>\n<li>到银行子系统查询他是否有足够多的存款</li>\n<li>到信用子系统查询他是否有良好的信用</li>\n<li>到贷款子系统查询他有无贷款劣迹</li>\n</ol>\n<p>只有这三个子系统都通过时才可进行抵押。</p>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/微信截图_20180416214717-1446f7fd8cde14eba3eb9e15d9587d02-69c5a.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 39.30405019965772%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABnWAAAZ1gEY0crtAAABZElEQVQoz41RTWvCQBCNaf0NhV76D9prS2l7EIvYi+f+gv6Sgsci4qEUeu9FpKecSiCHEsSPxM+om2iVRJKKiDkZt2+W9OYhA8POvtl5O29Gkg6YZVkynYPB4MF13fdut/vCGCsjLqmqekY5XddTUlJDcZrO8Xj8zGHr9Zrv93sKeavVuow/kxMTmqaZjouK/4S73U6Q1uv1K8ppmnaYkOTN53PhqE3Ffky5yWRyjfwbiCs4y7gXG43GCeXw5ojeLpdL2XEcud1uJx9BUhsOh6LDO8/zMv1+P1utVgu2bWfgOUi7wLxukcspilJAnF8sFnks49wwjBsoytZqtUKv18sivm82m6eCFZsLoyji2+2W+77PwzAUw59Op58gYBQTvlqtBA55H8A9ioMg4JvNRuAYx5MghHYTXf5go07sDGQ+fnyFf0GGB8wGxtB50Ol0SpjjN+bqos6ZzWZsNBr9outH4vsD7tU6rsO+jlUAAAAASUVORK5CYII=\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;"\n        alt="     20180416214717"\n        title=""\n        src="/static/微信截图_20180416214717-1446f7fd8cde14eba3eb9e15d9587d02-fee1c.png"\n        srcset="/static/微信截图_20180416214717-1446f7fd8cde14eba3eb9e15d9587d02-a67b7.png 200w,\n/static/微信截图_20180416214717-1446f7fd8cde14eba3eb9e15d9587d02-0b187.png 400w,\n/static/微信截图_20180416214717-1446f7fd8cde14eba3eb9e15d9587d02-fee1c.png 800w,\n/static/微信截图_20180416214717-1446f7fd8cde14eba3eb9e15d9587d02-b1a91.png 1200w,\n/static/微信截图_20180416214717-1446f7fd8cde14eba3eb9e15d9587d02-95179.png 1600w,\n/static/微信截图_20180416214717-1446f7fd8cde14eba3eb9e15d9587d02-69c5a.png 1753w"\n        sizes="(max-width: 800px) 100vw, 800px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="83217185687544530000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`//顾客类\npublic class Customer\n{\n    private string _name;\n\n    public Customer(string name)\n    {\n        this._name = name;\n    }\n\n    public string Name\n    {\n        get { return _name; }\n    }\n}\npublic class Bank  //银行子系统\n{\n    public bool HasSufficientSavings(Customer c, int amount)\n    {\n        Console.WriteLine(&quot;查询银行信息，客户名 &quot; + c.Name);\n        return true;\n    }\n}\npublic class Credit   //信用子系统\n{\n    public bool HasGoodCredit(Customer c)\n    {\n        Console.WriteLine(&quot;查询信用信息，客户名 &quot; + c.Name);\n        return true;\n    }\n}\npublic class Loan   //贷款子系统\n{\n    public bool HasNoBadLoans(Customer c)\n    {\n        Console.WriteLine(&quot;查询贷款信息，客户名 &quot; + c.Name);\n        return true;\n    }\n}\nstatic void Main(string[] args)\n{\n    Bank bank = new Bank();\n    Loan loan = new Loan();\n    Credit credit = new Credit();\n    int Money = 12000;\n    Customer customer = new Customer(&quot;张三&quot;);\n    bool eligible = true;\n\n    if (!bank.HasSufficientSavings(customer, Money))\n    {\n        eligible = false;\n    }\n    else if (!loan.HasNoBadLoans(customer))\n    {\n        eligible = false;\n    }\n    else if (!credit.HasGoodCredit(customer))\n    {\n        eligible = false;\n    }\n\n    Console.WriteLine(&quot;客户 &quot; + customer.Name + &quot; 已经被 &quot; + (eligible ? &quot;通过&quot; : &quot;拒绝&quot;));\n    Console.ReadLine();\n}`, `83217185687544530000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp"><span class="token comment">//顾客类</span>\n<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Customer</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">private</span> string _name<span class="token punctuation">;</span>\n\n    <span class="token keyword">public</span> <span class="token function">Customer</span><span class="token punctuation">(</span>string name<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>_name <span class="token operator">=</span> name<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">public</span> string Name\n    <span class="token punctuation">{</span>\n        get <span class="token punctuation">{</span> <span class="token keyword">return</span> _name<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Bank</span>  <span class="token comment">//银行子系统</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> <span class="token keyword">bool</span> <span class="token function">HasSufficientSavings</span><span class="token punctuation">(</span>Customer c<span class="token punctuation">,</span> <span class="token keyword">int</span> amount<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"查询银行信息，客户名 "</span> <span class="token operator">+</span> c<span class="token punctuation">.</span>Name<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Credit</span>   <span class="token comment">//信用子系统</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> <span class="token keyword">bool</span> <span class="token function">HasGoodCredit</span><span class="token punctuation">(</span>Customer c<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"查询信用信息，客户名 "</span> <span class="token operator">+</span> c<span class="token punctuation">.</span>Name<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Loan</span>   <span class="token comment">//贷款子系统</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> <span class="token keyword">bool</span> <span class="token function">HasNoBadLoans</span><span class="token punctuation">(</span>Customer c<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"查询贷款信息，客户名 "</span> <span class="token operator">+</span> c<span class="token punctuation">.</span>Name<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">Main</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    Bank bank <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Bank</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    Loan loan <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Loan</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    Credit credit <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Credit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">int</span> Money <span class="token operator">=</span> <span class="token number">12000</span><span class="token punctuation">;</span>\n    Customer customer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Customer</span><span class="token punctuation">(</span><span class="token string">"张三"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">bool</span> eligible <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>bank<span class="token punctuation">.</span><span class="token function">HasSufficientSavings</span><span class="token punctuation">(</span>customer<span class="token punctuation">,</span> Money<span class="token punctuation">)</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        eligible <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>loan<span class="token punctuation">.</span><span class="token function">HasNoBadLoans</span><span class="token punctuation">(</span>customer<span class="token punctuation">)</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        eligible <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>credit<span class="token punctuation">.</span><span class="token function">HasGoodCredit</span><span class="token punctuation">(</span>customer<span class="token punctuation">)</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        eligible <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"客户 "</span> <span class="token operator">+</span> customer<span class="token punctuation">.</span>Name <span class="token operator">+</span> <span class="token string">" 已经被 "</span> <span class="token operator">+</span> <span class="token punctuation">(</span>eligible <span class="token operator">?</span> <span class="token string">"通过"</span> <span class="token operator">:</span> <span class="token string">"拒绝"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    Console<span class="token punctuation">.</span><span class="token function">ReadLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>可以看到，客户程序与三个子系统都发生了耦合，这种耦合使得客户程序依赖于子系统，当子系统变化时，客户程序也将面临很多变化的挑战。</p>\n<h3 id="模式动机"><a href="#%E6%A8%A1%E5%BC%8F%E5%8A%A8%E6%9C%BA" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式动机</h3>\n<ul>\n<li>将一个系统划分为若干个子系统有利于降低系统的复杂性，一个常见的设计目标是使子系统间的通信和相互依赖关系达到最小，而达到该目标的途径之一就是引入一个外观对象，它为子系统中较一般的设置提供了一个单一而简单的界面。</li>\n<li>外观模式要求一个子系统的外部与其内部的通信必须通过一个统一的外观(Facade)对象进行。就如同医院的接待员一样，外观模式的外观类将客户端与子系统的内部复杂性分隔开，使得客户端只需要与外观对象打交道，而不需要与子系统内部的很多对象打交道。</li>\n<li>在没有外观类(Facade)之前，客户类(Client)需要和子系统类(Subsystem)进行复杂的交互，系统的耦合度很大；而增加一个外观类之后，客户类只需要直接和外观类交互，子系统类之间的复杂关系由外观类来实现，从而降低了系统的耦合度。</li>\n</ul>\n<h3 id="模式定义"><a href="#%E6%A8%A1%E5%BC%8F%E5%AE%9A%E4%B9%89" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式定义</h3>\n<p>外部与一个子系统的通信必须通过一个统一的外观对象进行，为子系统中的一组接口提供一个一致的界面，外观模式定义了一个高层接口，这个接口使得这一子系统更加容易使用。外观模式是对象的结构模式。</p>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/微信截图_20180416220421-53b05e392c63cc76dab18ed22bdc8d94-5fd75.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 59.5467032967033%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABnWAAAZ1gEY0crtAAAB8klEQVQoz61TS2saYRT9Mg10Udpf0GziDwgRY6EU4i5b8Q/0B7Srkn1SsnIluhGFCka6KLViQdxYF4qIguIDxfervlFRdBqNNfP13EFdlCym0AvDXOZ+3znnnnuHsb/CbDYzzrlAeaPReDcajX4Ui8VvnU7H1+/3XVar9SnV4vE4UxQmk4kAn1AOoK/I+WKx4JvNhrfbbe5yuZ5RLRqNKgM0Go0EeEB5pVLRjcfj94VC4WO32/3QarXeWiyWQ6qFw2H2T7Fr+7Fwu93KgfR6/V5htVq9gHc3Pp/vOpfLXUHlpcPheE41v9+vDNBgMOw9rNfrdvJwMBhwSZK4KIoS1L3ctnygCFClUhGg7FOpVJIBJ5PJHtDr9R5RzePxPA6ISQqYnoD2BGp1+8gKU6mUIZPJfE+n018A7sFZcyAQeLHzmM42m00BnQiRSIT99wA5YzD7BMarY7HYmc1m02FV1FCiBeNxIpE47fV6GqfTeY5cCzWvgsHgcT6fP8Eqaex2uw65plarnYZCIXk/2XA4nC6XS9knXKYl/k2+Yec+Yxid9XrNQcixjw/0HWS3s9lsuFqtOKbO5/M5n06nUjabfSMDQuEAHtyD/Q6/2h3eIkg4fHPiUA21B6rhskgA8PUT1P0sl8sbkP4C2ZLuJZPJ14T3B5ePiHmsae9YAAAAAElFTkSuQmCC\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;"\n        alt="     20180416220421"\n        title=""\n        src="/static/微信截图_20180416220421-53b05e392c63cc76dab18ed22bdc8d94-fee1c.png"\n        srcset="/static/微信截图_20180416220421-53b05e392c63cc76dab18ed22bdc8d94-a67b7.png 200w,\n/static/微信截图_20180416220421-53b05e392c63cc76dab18ed22bdc8d94-0b187.png 400w,\n/static/微信截图_20180416220421-53b05e392c63cc76dab18ed22bdc8d94-fee1c.png 800w,\n/static/微信截图_20180416220421-53b05e392c63cc76dab18ed22bdc8d94-b1a91.png 1200w,\n/static/微信截图_20180416220421-53b05e392c63cc76dab18ed22bdc8d94-5fd75.png 1456w"\n        sizes="(max-width: 800px) 100vw, 800px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="48745616290232510000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`public class Mortgage     //外观类\n{\n    private Bank bank = new Bank();\n    private Loan loan = new Loan();\n    private Credit credit = new Credit();\n\n    public bool IsEligible(Customer cust, int amount)\n    {\n        Console.WriteLine(&quot;{0} 申请 {1:C} 贷款 &quot;, cust.Name, amount);\n\n        bool eligible = true;\n\n        if (!bank.HasSufficientSavings(cust, amount))\n        {\n            eligible = false;\n        }\n        else if (!loan.HasNoBadLoans(cust))\n        {\n            eligible = false;\n        }\n        else if (!credit.HasGoodCredit(cust))\n        {\n            eligible = false;\n        }\n\n        return eligible;\n    }\n}\nstatic void Main(string[] args)\n{\n    Mortgage mortgage = new Mortgage();   //外观\n\n    Customer customer = new Customer(&quot;张三&quot;);\n    bool eligable = mortgage.IsEligible(customer, 125000);\n\n    Console.WriteLine(&quot;客户 &quot; +customer.Name+&quot; 已经被 &quot;+(eligable ? &quot;通过&quot; : &quot;拒绝&quot;));\n    Console.ReadLine();\n}`, `48745616290232510000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Mortgage</span>     <span class="token comment">//外观类</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">private</span> Bank bank <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Bank</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">private</span> Loan loan <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Loan</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">private</span> Credit credit <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Credit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">public</span> <span class="token keyword">bool</span> <span class="token function">IsEligible</span><span class="token punctuation">(</span>Customer cust<span class="token punctuation">,</span> <span class="token keyword">int</span> amount<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"{0} 申请 {1:C} 贷款 "</span><span class="token punctuation">,</span> cust<span class="token punctuation">.</span>Name<span class="token punctuation">,</span> amount<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n        <span class="token keyword">bool</span> eligible <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>\n\n        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>bank<span class="token punctuation">.</span><span class="token function">HasSufficientSavings</span><span class="token punctuation">(</span>cust<span class="token punctuation">,</span> amount<span class="token punctuation">)</span><span class="token punctuation">)</span>\n        <span class="token punctuation">{</span>\n            eligible <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>loan<span class="token punctuation">.</span><span class="token function">HasNoBadLoans</span><span class="token punctuation">(</span>cust<span class="token punctuation">)</span><span class="token punctuation">)</span>\n        <span class="token punctuation">{</span>\n            eligible <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>credit<span class="token punctuation">.</span><span class="token function">HasGoodCredit</span><span class="token punctuation">(</span>cust<span class="token punctuation">)</span><span class="token punctuation">)</span>\n        <span class="token punctuation">{</span>\n            eligible <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>\n        <span class="token punctuation">}</span>\n\n        <span class="token keyword">return</span> eligible<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">Main</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    Mortgage mortgage <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Mortgage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//外观</span>\n\n    Customer customer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Customer</span><span class="token punctuation">(</span><span class="token string">"张三"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">bool</span> eligable <span class="token operator">=</span> mortgage<span class="token punctuation">.</span><span class="token function">IsEligible</span><span class="token punctuation">(</span>customer<span class="token punctuation">,</span> <span class="token number">125000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"客户 "</span> <span class="token operator">+</span>customer<span class="token punctuation">.</span>Name<span class="token operator">+</span><span class="token string">" 已经被 "</span><span class="token operator">+</span><span class="token punctuation">(</span>eligable <span class="token operator">?</span> <span class="token string">"通过"</span> <span class="token operator">:</span> <span class="token string">"拒绝"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    Console<span class="token punctuation">.</span><span class="token function">ReadLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>引入 Facade 模式后，客户程序只与 Mortgage 发生依赖，也就是 Mortgage 屏蔽了子系统之间的复杂的操作，达到了解耦内部子系统与客户程序之间的依赖。</p>\n<h3 id="模式结构"><a href="#%E6%A8%A1%E5%BC%8F%E7%BB%93%E6%9E%84" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式结构</h3>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/微信截图_20180416235335-77f7d80ef6e77f466b244daa9c43f21d-17c64.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 37.20219914477703%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAABnWAAAZ1gEY0crtAAABf0lEQVQoz2NggABGJMxUU1PDChK8d+9e4fPnz4/fuHFj+8uXL4/dvHkzFiReUFDAAlKHBYOBOBALALEgEPMBMXtoaCg3SOLRo0fz/gPB+/fv/4Hou3fvNoPEvby8uEDqkDAbEHODDRUREeF5+vQpU2dnJ8uiRYtYgPoYgBhs28GDB2VOnDhhuHXrVsPjx48bAvkgy0HyjFDMBKUZZGRkQAYzg+RZGKgDmDU0NJgZFi9erHLnzh33bdu2eV+8eNH72rVr6rdv3zYEusxnz549vkBvOl2+fFkeGI7uu3fv9gaKg8T0L126pH3+/Hnv7du3+wD5bkuWLJEDGws0pBQUPp8+fQJR/x88eDDr2bNnx0DsX79+/X/z5s1/YGSA1Xz9+hWs5sWLF/uAEbYSxP7y5QtYDGh4MtjADRs2uAADf/aTJ08mAfG806dPh1y9ejUbGK5zgXga0PYuYNg5PHz4cBqQPxmI51+/fj39zJkzMUD2PJC+x48fz1y3bp0VyDwAVI0ARjXFD/0AAAAASUVORK5CYII=\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;"\n        alt="     20180416235335"\n        title=""\n        src="/static/微信截图_20180416235335-77f7d80ef6e77f466b244daa9c43f21d-fee1c.png"\n        srcset="/static/微信截图_20180416235335-77f7d80ef6e77f466b244daa9c43f21d-a67b7.png 200w,\n/static/微信截图_20180416235335-77f7d80ef6e77f466b244daa9c43f21d-0b187.png 400w,\n/static/微信截图_20180416235335-77f7d80ef6e77f466b244daa9c43f21d-fee1c.png 800w,\n/static/微信截图_20180416235335-77f7d80ef6e77f466b244daa9c43f21d-b1a91.png 1200w,\n/static/微信截图_20180416235335-77f7d80ef6e77f466b244daa9c43f21d-95179.png 1600w,\n/static/微信截图_20180416235335-77f7d80ef6e77f466b244daa9c43f21d-17c64.png 1637w"\n        sizes="(max-width: 800px) 100vw, 800px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<ul>\n<li>Facade：外观角色</li>\n<li>SubSystem：子系统角色</li>\n</ul>\n<p><strong>保安系统</strong></p>\n<p>一个保安系统由两个录像机、三个电灯、一个遥感器和一个警报器组成。保安系统的操作人员需要经常将这些仪器启动和关闭。</p>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/微信截图_20180417000758-927b699119f97c8c9372a06dab9e9287-2b2cd.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 513px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 77.19298245614036%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAABnWAAAZ1gEY0crtAAABcUlEQVQoz5WS2Y6CQBBF+f9v8lniCwIBBAUUFPeFbaKyzhk6JsTMTLAeOl3LvXWruqW2Z1+dbbfbKIru9/v1em2apv3bpL4Tx3EQBJvN5ng84u52u6qqBoFpQrf5fD4ajcbj8WQycV23/dfewQBATqdTlKNiqGzqHo/HcrmUZVlVVSKHw2GobCxNU8MwEMx5Op2Y/ANwlmWLxULX9SRJcPf7/QcLy/Pctm0G5sIIvFkf3LzsHSxCPCydg87YHPPz7GVZQlHX9S+d65ehmXemFM3cybF8tgCjiAhDUVEUglHCD8PQ932K1us11ajle6CFbQMjiwQAuGyRL4QLxeVykSjVNI3o8/m0O6OanqQRD6lpmqxA7I8vNJvNaAAXkJ/O/AfLskgw5+12MzqjDyzIIeg4DvfVasXjeZ5HJRqJSFTjkEYPrJwI4RTbhkJRFAooowdgeIkAxpXO5zMcSBKXqDMa4orhqUMhEe6AGYQUc8H7DeslTv29ouShAAAAAElFTkSuQmCC\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;"\n        alt="     20180417000758"\n        title=""\n        src="/static/微信截图_20180417000758-927b699119f97c8c9372a06dab9e9287-2b2cd.png"\n        srcset="/static/微信截图_20180417000758-927b699119f97c8c9372a06dab9e9287-2a6c9.png 200w,\n/static/微信截图_20180417000758-927b699119f97c8c9372a06dab9e9287-aed38.png 400w,\n/static/微信截图_20180417000758-927b699119f97c8c9372a06dab9e9287-2b2cd.png 513w"\n        sizes="(max-width: 513px) 100vw, 513px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>Client 对象需要引用到所有的录像机(Camera)、电灯(Light)、感应器(Sensor)和警报器(Alarm)对象。</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="96046802872234080000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`public class Camera\n{\n    public void TurnOn()\n    {\n        Console.WriteLine(&quot;Turning on the camera.&quot;);\n    }\n    public void TurnOff()\n    {\n        Console.WriteLine(&quot;Turning off the camera.&quot;);\n    }\n    public void Rotate(int degrees){\n        Console.WriteLine(&quot;Rotating the camera by {0} degrees.&quot;, degrees);\n    }\n}\npublic class Light\n{\n    public void TurnOff()\n    {\n        Console.WriteLine(&quot;Turning on the light.&quot;);\n    }\n    public void TurnOn()\n    {\n        Console.WriteLine(&quot;Turning off the light.&quot;);\n    }\n    public void ChangeBulb()\n    {\n        Console.WriteLine(&quot;changing the light-bulb.&quot;);\n    }\n}\npublic class Sensor\n{\n    public void Activate()\n    {\n        Console.WriteLine(&quot;Activating the sensor.&quot;);\n    }\n    public void Deactivate()\n    {\n        Console.WriteLine(&quot;Deactivating the sensor.&quot;);\n    }\n    public void Trigger()\n    {\n        Console.WriteLine(&quot;The sensor has triggered.&quot;);\n    }\n}\npublic static void Main( string[] args ){\n    private static Camera camera1, camera2;\n    private static Light light1, light2, light3;\n    private static Sensor sensor;\n    private static Alarm alarm;\n    camera1 = new Camera();\n    camera2 = new Camera();\n    light1 = new Light();\n    light2 = new Light();\n    light3 = new Light();\n    sensor = new Sensor();\n    alarm = new Alarm();\n    camera1.TurnOn();\n    camera2.TurnOn();\n    light1.TurnOn();\n    light2.TurnOn();\n    light3.TurnOn();\n    sensor.Activate();\n    alarm.Activate();\n}`, `96046802872234080000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Camera</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">TurnOn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"Turning on the camera."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">TurnOff</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"Turning off the camera."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Rotate</span><span class="token punctuation">(</span><span class="token keyword">int</span> degrees<span class="token punctuation">)</span><span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"Rotating the camera by {0} degrees."</span><span class="token punctuation">,</span> degrees<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Light</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">TurnOff</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"Turning on the light."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">TurnOn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"Turning off the light."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">ChangeBulb</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"changing the light-bulb."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Sensor</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Activate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"Activating the sensor."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Deactivate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"Deactivating the sensor."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Trigger</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"The sensor has triggered."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">Main</span><span class="token punctuation">(</span> string<span class="token punctuation">[</span><span class="token punctuation">]</span> args <span class="token punctuation">)</span><span class="token punctuation">{</span>\n    <span class="token keyword">private</span> <span class="token keyword">static</span> Camera camera1<span class="token punctuation">,</span> camera2<span class="token punctuation">;</span>\n    <span class="token keyword">private</span> <span class="token keyword">static</span> Light light1<span class="token punctuation">,</span> light2<span class="token punctuation">,</span> light3<span class="token punctuation">;</span>\n    <span class="token keyword">private</span> <span class="token keyword">static</span> Sensor sensor<span class="token punctuation">;</span>\n    <span class="token keyword">private</span> <span class="token keyword">static</span> Alarm alarm<span class="token punctuation">;</span>\n    camera1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Camera</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    camera2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Camera</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    light1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Light</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    light2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Light</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    light3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Light</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    sensor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Sensor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    alarm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Alarm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    camera1<span class="token punctuation">.</span><span class="token function">TurnOn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    camera2<span class="token punctuation">.</span><span class="token function">TurnOn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    light1<span class="token punctuation">.</span><span class="token function">TurnOn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    light2<span class="token punctuation">.</span><span class="token function">TurnOn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    light3<span class="token punctuation">.</span><span class="token function">TurnOn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    sensor<span class="token punctuation">.</span><span class="token function">Activate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    alarm<span class="token punctuation">.</span><span class="token function">Activate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>一个合情合理的改进方法就是准备一个系统的控制台，作为保安系统的用户界面。</p>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/微信截图_20180417002439-2b9d246521a28f2bf6788519ace50700-f28cf.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 532px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 83.83458646616542%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAIAAABSJhvpAAAACXBIWXMAABnWAAAZ1gEY0crtAAABt0lEQVQ4y5XS14pbQRAE0Pv/X6VHgVAA5ZxzTlaWfXzHFkjsGtwPw/RMV1Wn6Of39nw+p9NpvV7v9/vdbncymRyPx/AeAqLL5XK9Xr1uNpvz+Xw6nbgv8HA4zGQy8Fj2+/1yuXwDex2Px6vVqtls/ogN4HA4YBG93W7z+Xwqlcpms4VCgcAbGDKdTuMeDAZgvV7P5X6/i7jdbkgpA3tcLBafynyUZOUcnrwAuzweD1LJZDKRSIxGIwGf4PV6TY3+Mrb5fE7hVTMMcLVaFaAEibyB0d9ju/21158v1JDlcrnVauH9rPkfo8K42+1UFOaktf8BpgyjnWTVop2faX+nGWauTtk6aZo/cOjlF2CUImBUHvDOU2xht2xUyPwPOCiEZsjNYtiQ0POwc9xJbGFziM9mM3NBF4kLo8IEwO10OpaZOPA4Nq0CE+COpVKpKMTL7/UsFov6GfYUuFQqtdttrg5xzcm03P0OY7NUTiyRZCgDWECXkGStVgt7uo3NtDTc2ks4xGOXYKRINJRd/JFqNBrcEMo6scEICCWgVrPiIwuYy+X4dCgI8mGx/DlDh8LdO0ZrE5A68gvT6rz7mV8XzwAAAABJRU5ErkJggg==\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;"\n        alt="     20180417002439"\n        title=""\n        src="/static/微信截图_20180417002439-2b9d246521a28f2bf6788519ace50700-f28cf.png"\n        srcset="/static/微信截图_20180417002439-2b9d246521a28f2bf6788519ace50700-9f1b4.png 200w,\n/static/微信截图_20180417002439-2b9d246521a28f2bf6788519ace50700-007c2.png 400w,\n/static/微信截图_20180417002439-2b9d246521a28f2bf6788519ace50700-f28cf.png 532w"\n        sizes="(max-width: 532px) 100vw, 532px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="78902480520794670000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`public class SecurityFacade\n{\n    private static Camera camera1, camera2;\n    private static Light light1, light2, light3;\n    private static Sensor sensor;\n    private static Alarm alarm;\n    static SecurityFacade()\n    {\n        camera1 = new Camera();\n        camera2 = new Camera();\n        light1 = new Light();\n        light2 = new Light();\n        light3 = new Light();\n        sensor = new Sensor();\n        alarm = new Alarm();\n    }\n    public void Activate()\n    {\n        camera1.TurnOn();\n        camera2.TurnOn();\n        light1.TurnOn();\n        light2.TurnOn();\n        light3.TurnOn();\n        sensor.Activate();\n        alarm.Activate();\n    }\n    public void Deactivate()\n    {\n        camera1.TurnOff();\n        camera2.TurnOff();\n        light1.TurnOff();\n        light2.TurnOff();\n        light3.TurnOff();\n        sensor.Deactivate();\n        alarm.Deactivate();\n    }\n}\npublic static void Main( string[] args )\n{\n    private static SecurityFacade security;\n    security = new SecurityFacade();\n    security.Activate();\n    Console.WriteLine(&quot;\\n--------------------\\n&quot;);\n    security.Deactivate();\n}`, `78902480520794670000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SecurityFacade</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">private</span> <span class="token keyword">static</span> Camera camera1<span class="token punctuation">,</span> camera2<span class="token punctuation">;</span>\n    <span class="token keyword">private</span> <span class="token keyword">static</span> Light light1<span class="token punctuation">,</span> light2<span class="token punctuation">,</span> light3<span class="token punctuation">;</span>\n    <span class="token keyword">private</span> <span class="token keyword">static</span> Sensor sensor<span class="token punctuation">;</span>\n    <span class="token keyword">private</span> <span class="token keyword">static</span> Alarm alarm<span class="token punctuation">;</span>\n    <span class="token keyword">static</span> <span class="token function">SecurityFacade</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        camera1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Camera</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        camera2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Camera</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        light1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Light</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        light2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Light</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        light3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Light</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        sensor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Sensor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        alarm <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Alarm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Activate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        camera1<span class="token punctuation">.</span><span class="token function">TurnOn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        camera2<span class="token punctuation">.</span><span class="token function">TurnOn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        light1<span class="token punctuation">.</span><span class="token function">TurnOn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        light2<span class="token punctuation">.</span><span class="token function">TurnOn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        light3<span class="token punctuation">.</span><span class="token function">TurnOn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        sensor<span class="token punctuation">.</span><span class="token function">Activate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        alarm<span class="token punctuation">.</span><span class="token function">Activate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Deactivate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        camera1<span class="token punctuation">.</span><span class="token function">TurnOff</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        camera2<span class="token punctuation">.</span><span class="token function">TurnOff</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        light1<span class="token punctuation">.</span><span class="token function">TurnOff</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        light2<span class="token punctuation">.</span><span class="token function">TurnOff</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        light3<span class="token punctuation">.</span><span class="token function">TurnOff</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        sensor<span class="token punctuation">.</span><span class="token function">Deactivate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        alarm<span class="token punctuation">.</span><span class="token function">Deactivate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">Main</span><span class="token punctuation">(</span> string<span class="token punctuation">[</span><span class="token punctuation">]</span> args <span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">private</span> <span class="token keyword">static</span> SecurityFacade security<span class="token punctuation">;</span>\n    security <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">SecurityFacade</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    security<span class="token punctuation">.</span><span class="token function">Activate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"\\n--------------------\\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    security<span class="token punctuation">.</span><span class="token function">Deactivate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="优缺点"><a href="#%E4%BC%98%E7%BC%BA%E7%82%B9" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>优缺点</h3>\n<ul>\n<li>它对客户屏蔽子系统组件，减少了客户处理的对象数目使得子系统使用起来更加容易。</li>\n<li>它实现了子系统与客户之间的松耦合关系。这使得子系统的组件变化不会影响到它的客户。</li>\n<li>提高了安全性，通过外观模式，屏蔽子系统业务逻辑。</li>\n<li>它简化了系统在不同平台之间的移植过程，因为编译一个子系统一般不需要编译所有其它的子系统。</li>\n<li>它并不限制复杂应用使用子系统类。</li>\n<li>外观模式并不增加任何功能性模式，它仅仅是一些简单化接口。</li>\n</ul>\n<h3 id="模式使用"><a href="#%E6%A8%A1%E5%BC%8F%E4%BD%BF%E7%94%A8" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式使用</h3>\n<ul>\n<li>当要为一个复杂子系统提供一个简单接口时。这个接口对大多数用户来说已经足够好；那些需要更多可定制性的用户可以越过 Facade 层。</li>\n<li>子系统相对独立——外界只需黑箱操作即可。例如利息计算。</li>\n<li>预防操作人员带来的风险扩散。</li>\n</ul>\n<h3 id="模式应用"><a href="#%E6%A8%A1%E5%BC%8F%E5%BA%94%E7%94%A8" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式应用</h3>\n<ul>\n<li>子系统可以有多个外观。</li>\n<li>外观不参与子系统的业务逻辑。</li>\n</ul>\n<h2 id="享元模式flyweight"><a href="#%E4%BA%AB%E5%85%83%E6%A8%A1%E5%BC%8Fflyweight" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>享元模式(Flyweight)</h2>\n<p>运用共享技术有效地支持大量细粒度的对象。</p>\n<h3 id="模式背景-1"><a href="#%E6%A8%A1%E5%BC%8F%E8%83%8C%E6%99%AF-1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式背景</h3>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/微信截图_20180417004543-1f0b277785a37343adc0be5464acf32e-cedc2.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 305px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 173.11475409836066%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAjCAIAAAAblL1PAAAACXBIWXMAABnWAAAZ1gEY0crtAAAF0UlEQVRIx31VWXPiRhDmN+c5eUjlJamctbv2Zn1k7ThrO4mdxLGJl/UBBoEkdIAEOtDBIYTAgA4uATrTBmcriVPpmpoahvmmv/66e5TY4RevqNFXN/UXhd7zXPcZcv8sf7+J25uF4UZh+C053aJnT8e31PQL1Em8YucvctYHG8mPDgofHeQ//pH65IT9LKl+fFL+5LTyDHFekvNNYrZJuH8fG4T7YdpMHFTHSGNUcwK6OUDFNoxK26rbnmp7D7O1+M+hmPNsY5Q4EsZk0yrVDbJ+j9d0XDIYzeKMsdCbyuZCGS4fZuthfliYS1irliebywvJTjD9iV5nk8lP93/+/eTXs+Rl6uDw+NnGy8OffnYXiziOwzj2o4cZLIhjL4wXfugH4S9NJ6HYbhQHqlY/v7ziBb5YxEVBwHEMyeV4rprLZfN5RFWUVrPJ81yr1XJsOwj8OI5SXTfBDaczq1/FL2/PD7E88jZ1RVI0y1YxvJgvYARJS5IyGJj9fl/X9eFwOJ5MggAYhNe9RYLrzwaGlMntXCYvT0/f/HJygKI3JHGXzVxSZKYmkpalxfEsiqL4L3tYRyuw6rjwu9MbMugWiu+wpe/46h6BbVHETqt1xFVfK9K+bZ3F8fLv4CgM3nUXDzHHoW8YejF/h6AZJHsh8DhJpCtsnqIyGPYOLaQo8s40h7Is6W1tPB6taMe5wRochXqnU7k5pCi6VOYEQSZJhuOkcpmjKLZUqrCsoKrNUpmVJNCuMTTt+96gO5o+ghuaVk5t8+Usz+MCj2HoW5FHgQJRvC7RGVWhea7AsohUK1YrSKNe4ipI1xwmZHsGUWi6XkruXF98wzKbsrSPFZ6ryl4m/fW71OdF9HkR2xD4rWz6S625VxO3RWG7q+8PnRaAQbBIkZX0wau2KrY7LRRFaJpiWVrXW6LAtZqqbZtRFPjeIgy9MPB83/O9+WSxfKTd0lqNu0OmeM7zfxD4aYn6DSuckMWzauVcFC4F/krX8rZF2CY56BMjh3CnlanvJxRrFodBx9Bd8VRgTlF0F8f2K8xh7m4bye0y5Tc0uZfNbpHEvigeCfwxTX0vy8fD/rupt3yvtj6pHrabNQwnQXOSpHleoEHoKp/Po6nUVa0G4rOdThf2QfPh0BovgzU4MPoDb+7SJbrdbiuKgqIowzDJZDKTyQAsnU7DDkmShUIBDsBfPMeZEzehQIWFgdbRuQbBcRU4wfGQXgp6AA5Vq1VN03q9nmVZNuhmmuPxeDAYWKbpuMuV2lHYNtpXhWOKRNPpDLuyer3eaDTWyDAM439bNPXDNW2/pRvcb7tqtVgkaWhD8A9Ul8vHegYwlGT4DwsmXvDouWkYdxZPMBRTKqsrEwSh2+16nvfYCf+2cOKFj0XS0vTi0QumiN5m7himjOM4MAfOEJ7ruuDoKXjqrWnHUVvT5Z/elND8TTqdy2Zvb28lSaqvDKT6X3Do6x1jlM/yBFFiWJIgwC2oBbQdx1nH/N6e0g6URgvLIiWKBsIX5xc0TYuiCJHPZrP4qdDvPa8EC/TuvXE/gJKCqgCp4QoA12o1uMUwDAgBaqPT6cAzBnl+eAyiaE17HoW+ZnSn7hTDcSgPwKzBUCQEAZXDlctlwIP+sAl18g8wrPoDZ7FcwDnwk8vlAC/LMoZhACivDPah2mB+TF64os3eT3rN6k3q67dX17+fnR0fHyMIAjAgD0h4a+P/tpVnyXLnrlMRix2jDxHCWw9UwRW5MqhwoABsIVq4C9IGmYeCHY9G46W/znPcHzoTR1dVmV4Z8AeSED8kDCKHu9Z9ArRBtmazCVdM/wJHrXazfveDwBCpq2vou2qlAofguwMO10E+td7MS4iWO/N8SWuz179CM9Y7XZqtoiRV5vg/rm7gIc7kUUFRCYYVlLo1mS1XTTL3g1RnkjiSzQ3R3pUne6LzWpq8lqfbgrPF27u18SYz2BFH8BPml5Xhrjj6Tp3n+nP4Sh7KI86c/QmIMxX5QpUvewAAAABJRU5ErkJggg==\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;"\n        alt="     20180417004543"\n        title=""\n        src="/static/微信截图_20180417004543-1f0b277785a37343adc0be5464acf32e-cedc2.png"\n        srcset="/static/微信截图_20180417004543-1f0b277785a37343adc0be5464acf32e-33c45.png 200w,\n/static/微信截图_20180417004543-1f0b277785a37343adc0be5464acf32e-cedc2.png 305w"\n        sizes="(max-width: 305px) 100vw, 305px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<p>如何设计能有效减少系统开销?</p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="34546392939958006000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`class Game  //游戏\n{\n    private string name = &quot;&quot;;\n    public Game(string name)\n    {\n        this.name = name;\n    }\n\n    public void Play()\n    {\n        Console.WriteLine(&quot;运行游戏：&quot; + name);\n    }\n}\nstatic void Main(string[] args)\n{\n    Game zs = new Game(&quot;斗地主&quot;);\n    zs.Play();\n\n    Game ls = new Game(&quot;斗地主&quot;);\n    ls.Play();\n\n    Game ww = new Game(&quot;斗地主&quot;);\n    ww.Play();\n\n    Game zl = new Game(&quot;麻将&quot;);\n    zl.Play();\n\n    Game sq = new Game(&quot;麻将&quot;);\n    sq.Play();\n\n    Game zb = new Game(&quot;麻将&quot;);\n    zb.Play();\n\n    Console.Read();\n}`, `34546392939958006000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp"><span class="token keyword">class</span> <span class="token class-name">Game</span>  <span class="token comment">//游戏</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">private</span> string name <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>\n    <span class="token keyword">public</span> <span class="token function">Game</span><span class="token punctuation">(</span>string name<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">Play</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"运行游戏："</span> <span class="token operator">+</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">Main</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    Game zs <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Game</span><span class="token punctuation">(</span><span class="token string">"斗地主"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    zs<span class="token punctuation">.</span><span class="token function">Play</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Game ls <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Game</span><span class="token punctuation">(</span><span class="token string">"斗地主"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    ls<span class="token punctuation">.</span><span class="token function">Play</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Game ww <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Game</span><span class="token punctuation">(</span><span class="token string">"斗地主"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    ww<span class="token punctuation">.</span><span class="token function">Play</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Game zl <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Game</span><span class="token punctuation">(</span><span class="token string">"麻将"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    zl<span class="token punctuation">.</span><span class="token function">Play</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Game sq <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Game</span><span class="token punctuation">(</span><span class="token string">"麻将"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    sq<span class="token punctuation">.</span><span class="token function">Play</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Game zb <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Game</span><span class="token punctuation">(</span><span class="token string">"麻将"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    zb<span class="token punctuation">.</span><span class="token function">Play</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Console<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>三个斗地主实例，本质都是一样的代码，但是随着用户增多，实例也会增多，对服务器资源造成浪费，希望共享代码</p>\n<h3 id="享元模式"><a href="#%E4%BA%AB%E5%85%83%E6%A8%A1%E5%BC%8F" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>享元模式</h3>\n<ul>\n<li>享元模式对那些通常因为数量太大而难以用对象来表示的概念或实体进行建模。</li>\n<li>如为字母表中的每一个字符创建一个享元，每个享元对象存储一个字符代码。逻辑上，文档中的给定字符每次出现都有一个对象与其对应，然而物理上相同的字符共享一个享元对象，而这个对象可以出现在文档结构的不同地方。</li>\n<li>由于不同的字符对象数远小于文档中的字符数，因此，对象的总数远小于一个初次执行的程序所使用的对象数目。对于一个所有字符都使用同样的字体和颜色的文档而言，不管这个文档有多长，只需要分配 100 个左右的字符对象（大约是 ASCII 字符集的数目）。由于大多数文档使用的字体颜色的组合不超过 10 种，实际应用中这一数目不会明显增加。因此，对单个字符进行对象抽象是具有实际意义的。</li>\n</ul>\n<h3 id="模式定义-1"><a href="#%E6%A8%A1%E5%BC%8F%E5%AE%9A%E4%B9%89-1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式定义</h3>\n<p>运用共享技术有效地支持大量细粒度的对象。 系统只使用少量的对象，而这些对象都很近，状态变化很小，对象使用次数增多。享元模式是一种对象结构型模式。</p>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/微信截图_20180417010630-3ce674eace0a7caddb6f57a0c1123d80-165f5.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 46.303763440860216%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABnWAAAZ1gEY0crtAAABiklEQVQoz41STUsCURR9WoH0EwJ3QVv/yRjq1lURQZtcBSPuRBeBM4Jt7Cf4B9woEogKfqKII+InChXmxwii4Ovchw5DBXnh8M6dd9657943rFAo2Hu9nnswGDir1er1cDh09vt9d7PZvGAIzjnBQjyfz19i/7lYLIZzuVwY+hBytdFoSHuthSHx7nY7vlgsOIzEut1ueTqdviFRJBI58/l8p8Qzmcw9DvHNZsPX67UARbfbfd0bWlmpVPJOp1NO0HWdL5dLYZhMJu9IJEnSucPhsBFPpVIPq9WKz+dzTutsNhOGo9Eobhhms1k7bulqt9se8BBadxE0TTO3TJS0V7Va7aVSqUTr9Xq00+koMI1j9Rgt/wibOYnFYoYAN/4lNseh6L/h9/sNjpnRwZM/YDFM0eojZiCjBblcLgfQ0tN4PA7g+y00Qog/QRjKskyPxBRFMaCqKgsGg2I/kUgwBjMxWBqyedCY4wgaKwlRhB0drVZLm0wmX3jdD7zyJ/AOrqPQ28EQtz/a7xsyq1Ajpj5dTgAAAABJRU5ErkJggg==\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;"\n        alt="     20180417010630"\n        title=""\n        src="/static/微信截图_20180417010630-3ce674eace0a7caddb6f57a0c1123d80-fee1c.png"\n        srcset="/static/微信截图_20180417010630-3ce674eace0a7caddb6f57a0c1123d80-a67b7.png 200w,\n/static/微信截图_20180417010630-3ce674eace0a7caddb6f57a0c1123d80-0b187.png 400w,\n/static/微信截图_20180417010630-3ce674eace0a7caddb6f57a0c1123d80-fee1c.png 800w,\n/static/微信截图_20180417010630-3ce674eace0a7caddb6f57a0c1123d80-b1a91.png 1200w,\n/static/微信截图_20180417010630-3ce674eace0a7caddb6f57a0c1123d80-165f5.png 1488w"\n        sizes="(max-width: 800px) 100vw, 800px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="50569281465175980000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`abstract class Game   //游戏\n{\n    public abstract void Play();\n}\nclass ConcreteGame : Game //具体的游戏\n{\n    private string name = &quot;&quot;;\n    public ConcreteGame(string name)\n    {\n        this.name = name;\n    }\n\n    public override void Play()\n    {\n        Console.WriteLine(&quot;运行游戏：&quot; + name);\n    }\n}\nclass GameFactory   //游戏工厂\n{\n    private Hashtable flyweights = new Hashtable();\n\n    //获得游戏分类\n    public Game GetGameCategory(string key)\n    {\n        if (!flyweights.ContainsKey(key))\n            flyweights.Add(key, new ConcreteGame(key));\n        return ((Game)flyweights[key]);\n    }\n\n    //获得游戏分类总数\n    public int GetGameCount()\n    {\n        return flyweights.Count;\n    }\n}\nstatic void Main(string[] args)\n{\n\n    GameFactory f = new GameFactory();\n\n    Game zs = f.GetGameCategory(&quot;斗地主&quot;);\n    zs.Play();\n    Game ls = f.GetGameCategory(&quot;斗地主&quot;);\n    ls.Play();\n    Game ww = f.GetGameCategory(&quot;斗地主&quot;);\n    ww.Play();\n    Game zl = f.GetGameCategory(&quot;麻将&quot;);\n    zl.Play();\n    Game sq = f.GetGameCategory(&quot;麻将&quot;);\n    sq.Play();\n    Game zb = f.GetGameCategory(&quot;麻将&quot;);\n    zb.Play();\n    Console.WriteLine(&quot;游戏逻辑总数为 {0}&quot;, f.GetGameCount());\n\n    Console.Read();\n}`, `50569281465175980000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp">abstract <span class="token keyword">class</span> <span class="token class-name">Game</span>   <span class="token comment">//游戏</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> abstract <span class="token keyword">void</span> <span class="token function">Play</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">class</span> <span class="token class-name">ConcreteGame</span> <span class="token operator">:</span> Game <span class="token comment">//具体的游戏</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">private</span> string name <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>\n    <span class="token keyword">public</span> <span class="token function">ConcreteGame</span><span class="token punctuation">(</span>string name<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">public</span> override <span class="token keyword">void</span> <span class="token function">Play</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"运行游戏："</span> <span class="token operator">+</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">class</span> <span class="token class-name">GameFactory</span>   <span class="token comment">//游戏工厂</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">private</span> Hashtable flyweights <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Hashtable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">//获得游戏分类</span>\n    <span class="token keyword">public</span> Game <span class="token function">GetGameCategory</span><span class="token punctuation">(</span>string key<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>flyweights<span class="token punctuation">.</span><span class="token function">ContainsKey</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span>\n            flyweights<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token function">ConcreteGame</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>Game<span class="token punctuation">)</span>flyweights<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token comment">//获得游戏分类总数</span>\n    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">GetGameCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">return</span> flyweights<span class="token punctuation">.</span>Count<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">Main</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n\n    GameFactory f <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">GameFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Game zs <span class="token operator">=</span> f<span class="token punctuation">.</span><span class="token function">GetGameCategory</span><span class="token punctuation">(</span><span class="token string">"斗地主"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    zs<span class="token punctuation">.</span><span class="token function">Play</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    Game ls <span class="token operator">=</span> f<span class="token punctuation">.</span><span class="token function">GetGameCategory</span><span class="token punctuation">(</span><span class="token string">"斗地主"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    ls<span class="token punctuation">.</span><span class="token function">Play</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    Game ww <span class="token operator">=</span> f<span class="token punctuation">.</span><span class="token function">GetGameCategory</span><span class="token punctuation">(</span><span class="token string">"斗地主"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    ww<span class="token punctuation">.</span><span class="token function">Play</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    Game zl <span class="token operator">=</span> f<span class="token punctuation">.</span><span class="token function">GetGameCategory</span><span class="token punctuation">(</span><span class="token string">"麻将"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    zl<span class="token punctuation">.</span><span class="token function">Play</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    Game sq <span class="token operator">=</span> f<span class="token punctuation">.</span><span class="token function">GetGameCategory</span><span class="token punctuation">(</span><span class="token string">"麻将"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    sq<span class="token punctuation">.</span><span class="token function">Play</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    Game zb <span class="token operator">=</span> f<span class="token punctuation">.</span><span class="token function">GetGameCategory</span><span class="token punctuation">(</span><span class="token string">"麻将"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    zb<span class="token punctuation">.</span><span class="token function">Play</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"游戏逻辑总数为 {0}"</span><span class="token punctuation">,</span> f<span class="token punctuation">.</span><span class="token function">GetGameCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Console<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<ul>\n<li>实现了享元模式共享的目的，无论几个用户，运行游戏一样，就只保留一个游戏逻辑代码。</li>\n<li>但是，这些用户毕竟不是同一个用户，用户名不同，用户的牌也不同。</li>\n<li>我们称享元对象内部不随环境变化的共享部分称为内部状态。</li>\n<li>而随环境而改变，不可以共享的称为外部状态。</li>\n</ul>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/微信截图_20180417011251-13e98479eeb1f11bc04c012e556c4985-5dcfa.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 31.107099879663057%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAABnWAAAZ1gEY0crtAAABO0lEQVQY03WRvUrDYBSGk1h08gpcFdychKIFwStQvAFdXIR6BcZB6CB4EY1gHBx16dapQ6aQ/6RJmv+UUBIydAiY+H4fju1ZTvKcH973fEwYhs95no9s234py/LN9/0bBjGdTveLongKgmCUJMlrlmUPhAuCsEPyfD6/9TzvW1VVMY7jH8MwLgln0jTtSKzXa5qx8IvwyWRygMaubVvKMbwA5nie3yN1Xdc/CG+ahtYhbEgXOo7Tj6JoAHDmuu6FpmmHhEPxrizL/dlsdi1J0hX4CeGYZUkGPwV/VBTlHqKGlmUdM9uirmt2Ww0OGFEUN9ZxMpYo5GCNg0KaMUBvhP/BarX6xK3G6HnH9xgqjkgN9lmo4+CgZ5pmb7lc9tCzWQQa6EIc+66qqg52fvFoHR6ow8Lz/3Nw2xz8AYJw57ofCdiYAAAAAElFTkSuQmCC\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;"\n        alt="     20180417011251"\n        title=""\n        src="/static/微信截图_20180417011251-13e98479eeb1f11bc04c012e556c4985-fee1c.png"\n        srcset="/static/微信截图_20180417011251-13e98479eeb1f11bc04c012e556c4985-a67b7.png 200w,\n/static/微信截图_20180417011251-13e98479eeb1f11bc04c012e556c4985-0b187.png 400w,\n/static/微信截图_20180417011251-13e98479eeb1f11bc04c012e556c4985-fee1c.png 800w,\n/static/微信截图_20180417011251-13e98479eeb1f11bc04c012e556c4985-b1a91.png 1200w,\n/static/微信截图_20180417011251-13e98479eeb1f11bc04c012e556c4985-95179.png 1600w,\n/static/微信截图_20180417011251-13e98479eeb1f11bc04c012e556c4985-5dcfa.png 1662w"\n        sizes="(max-width: 800px) 100vw, 800px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="78812091115619990000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`public class User //用户\n{\n    private string name;\n\n    public User(string name)\n    {\n        this.name = name;\n    }\n\n    public string Name\n    {\n        get { return name; }\n    }\n}\nabstract class Game   //游戏\n{\n    public abstract void Play(User user);\n}\nclass ConcreteGame : Game //具体的游戏\n{\n    private string name = &quot;&quot;;\n    public ConcreteGame(string name)\n    {\n        this.name = name;\n    }\n\n    public override void Play(User user)\n    {\n        Console.WriteLine(&quot;运行游戏：&quot; + name + &quot; 用户：&quot; + user.Name);\n    }\n}\nstatic void Main(string[] args)\n{\n    GameFactory f = new GameFactory();\n\n    Game zs = f.GetGameCategory(&quot;斗地主&quot;);\n    zs.Play(new User(&quot;张三&quot;));\n    Game ls = f.GetGameCategory(&quot;斗地主&quot;);\n    ls.Play(new User(&quot;李四&quot;));\n    Game ww = f.GetGameCategory(&quot;斗地主&quot;);\n    ww.Play(new User(&quot;王五&quot;));\n    Game zl = f.GetGameCategory(&quot;麻将&quot;);\n    zl.Play(new User(&quot;赵六&quot;));\n    Game sq = f.GetGameCategory(&quot;麻将&quot;);\n    sq.Play(new User(&quot;孙七&quot;));\n    Game zb = f.GetGameCategory(&quot;麻将&quot;);\n    zb.Play(new User(&quot;周八&quot;));\n\n    Console.WriteLine(&quot;游戏逻辑总数为 {0}&quot;, f.GetGameCount());\n\n    Console.Read();\n}`, `78812091115619990000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token comment">//用户</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">private</span> string name<span class="token punctuation">;</span>\n\n    <span class="token keyword">public</span> <span class="token function">User</span><span class="token punctuation">(</span>string name<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">public</span> string Name\n    <span class="token punctuation">{</span>\n        get <span class="token punctuation">{</span> <span class="token keyword">return</span> name<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\nabstract <span class="token keyword">class</span> <span class="token class-name">Game</span>   <span class="token comment">//游戏</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">public</span> abstract <span class="token keyword">void</span> <span class="token function">Play</span><span class="token punctuation">(</span>User user<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">class</span> <span class="token class-name">ConcreteGame</span> <span class="token operator">:</span> Game <span class="token comment">//具体的游戏</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">private</span> string name <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>\n    <span class="token keyword">public</span> <span class="token function">ConcreteGame</span><span class="token punctuation">(</span>string name<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">public</span> override <span class="token keyword">void</span> <span class="token function">Play</span><span class="token punctuation">(</span>User user<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"运行游戏："</span> <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token string">" 用户："</span> <span class="token operator">+</span> user<span class="token punctuation">.</span>Name<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">Main</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    GameFactory f <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">GameFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Game zs <span class="token operator">=</span> f<span class="token punctuation">.</span><span class="token function">GetGameCategory</span><span class="token punctuation">(</span><span class="token string">"斗地主"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    zs<span class="token punctuation">.</span><span class="token function">Play</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">User</span><span class="token punctuation">(</span><span class="token string">"张三"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    Game ls <span class="token operator">=</span> f<span class="token punctuation">.</span><span class="token function">GetGameCategory</span><span class="token punctuation">(</span><span class="token string">"斗地主"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    ls<span class="token punctuation">.</span><span class="token function">Play</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">User</span><span class="token punctuation">(</span><span class="token string">"李四"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    Game ww <span class="token operator">=</span> f<span class="token punctuation">.</span><span class="token function">GetGameCategory</span><span class="token punctuation">(</span><span class="token string">"斗地主"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    ww<span class="token punctuation">.</span><span class="token function">Play</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">User</span><span class="token punctuation">(</span><span class="token string">"王五"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    Game zl <span class="token operator">=</span> f<span class="token punctuation">.</span><span class="token function">GetGameCategory</span><span class="token punctuation">(</span><span class="token string">"麻将"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    zl<span class="token punctuation">.</span><span class="token function">Play</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">User</span><span class="token punctuation">(</span><span class="token string">"赵六"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    Game sq <span class="token operator">=</span> f<span class="token punctuation">.</span><span class="token function">GetGameCategory</span><span class="token punctuation">(</span><span class="token string">"麻将"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    sq<span class="token punctuation">.</span><span class="token function">Play</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">User</span><span class="token punctuation">(</span><span class="token string">"孙七"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    Game zb <span class="token operator">=</span> f<span class="token punctuation">.</span><span class="token function">GetGameCategory</span><span class="token punctuation">(</span><span class="token string">"麻将"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    zb<span class="token punctuation">.</span><span class="token function">Play</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token function">User</span><span class="token punctuation">(</span><span class="token string">"周八"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span><span class="token string">"游戏逻辑总数为 {0}"</span><span class="token punctuation">,</span> f<span class="token punctuation">.</span><span class="token function">GetGameCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Console<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h3 id="模式结构-1"><a href="#%E6%A8%A1%E5%BC%8F%E7%BB%93%E6%9E%84-1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式结构</h3>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/微信截图_20180417013418-a78a87ee22d494916444049f6a6e07ac-998c9.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 38.10921902524956%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABnWAAAZ1gEY0crtAAABoUlEQVQoz4VRS0sCURT2kQli0Oxy5aJNkGSbFlloRn+gZdCqbQtX/oQWsy2oTUnNxsFWgg9sBl2ow2gg4lvB1yiIqPgARRdyO3fytlL64HDuvd853z33u4pKpRLJ5/NfzWbzu1gs3ikAHo9ny2AwKEOhkArv6/U6PRwORcgc1PDdbpfvdDoC9B1jvlwuy3UyBoMBarfbCKNUKj3iM6fTqaUoSuNwOLZXDZHlcon6/T4CYdTr9dBisUCNRuMS89VqVU3T9K+gz+czMQxjjkajJo7jdslFoI9DhTPUGAOBwKHX6z1hWfYqGAwe+P3+I1EUd1Z1apzXApqUG8l/IPfBM+2xWOwCPLSn0+k9QoINt61W6zOXy7nAqw9Jktyj0egB9jfQ4wYv38EKBsIFT2chm4kqms/nsocgcE8EQeQNn8EHoPF4THgpkUg8T6dTNJlM0Gw2++Mymcw1meQFpnuCW15TqZSFCIbD4X2Y2JZMJq3xeNxWKBTOgDcLgmCECc8hTnmex6+yZLNZK/wBtc4GrR6g0+n0sNZssEq5ycNarab4AV2bL81vNTYJAAAAAElFTkSuQmCC\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;"\n        alt="     20180417013418"\n        title=""\n        src="/static/微信截图_20180417013418-a78a87ee22d494916444049f6a6e07ac-fee1c.png"\n        srcset="/static/微信截图_20180417013418-a78a87ee22d494916444049f6a6e07ac-a67b7.png 200w,\n/static/微信截图_20180417013418-a78a87ee22d494916444049f6a6e07ac-0b187.png 400w,\n/static/微信截图_20180417013418-a78a87ee22d494916444049f6a6e07ac-fee1c.png 800w,\n/static/微信截图_20180417013418-a78a87ee22d494916444049f6a6e07ac-b1a91.png 1200w,\n/static/微信截图_20180417013418-a78a87ee22d494916444049f6a6e07ac-95179.png 1600w,\n/static/微信截图_20180417013418-a78a87ee22d494916444049f6a6e07ac-998c9.png 1703w"\n        sizes="(max-width: 800px) 100vw, 800px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<ul>\n<li>Flyweight：抽象享元类</li>\n<li>ConcreteFlyweight：具体享元类</li>\n<li>UnsharedConcreteFlyweight：非共享具体享元类</li>\n<li>FlyweightFactory：享元工厂类</li>\n<li>Client：客户类</li>\n</ul>\n<h3 id="优缺点-1"><a href="#%E4%BC%98%E7%BC%BA%E7%82%B9-1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>优缺点</h3>\n<ul>\n<li>大幅度地降低内存中对象的数量。</li>\n<li>使得系统更加复杂。</li>\n<li>为了使对象可以共享，需要将一些状态外部化，这使得程序的逻辑复杂化。</li>\n<li>享元模式将享元对象的状态外部化，而读取外部状态使得运行时间稍微变长。</li>\n</ul>\n<h3 id="模式使用-1"><a href="#%E6%A8%A1%E5%BC%8F%E4%BD%BF%E7%94%A8-1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式使用</h3>\n<ul>\n<li>一个系统有大量的对象，造成耗费大量的内存。</li>\n<li>这些对象的状态中的大部分都可以外部化。</li>\n<li>这些对象可以按照内部状态分成很多的组，当把外部对象从对象中剔除时，每一个组都可以用相对较少的共享对象代替。</li>\n<li>软件系统不依赖于这些对象的身份，换言之，这些对象可以是不可分辨的。</li>\n</ul>\n<h3 id="模式应用-1"><a href="#%E6%A8%A1%E5%BC%8F%E5%BA%94%E7%94%A8-1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式应用</h3>\n<ul>\n<li>在编辑器软件中大量使用，如在一个文档中多次出现相同的图片，则只需要创建一个图片对象，通过在应用程序中设置该图片出现的位置，可以实现该图片在不同地方多次重复显示。</li>\n<li>Windows DLL(动态链接库)</li>\n<li>String 类型</li>\n</ul>\n<h2 id="代理模式proxy"><a href="#%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8Fproxy" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>代理模式(Proxy)</h2>\n<p>为其他对象提供一种代理以控制对这个对象的访问。</p>\n<h3 id="模式使用-2"><a href="#%E6%A8%A1%E5%BC%8F%E4%BD%BF%E7%94%A8-2" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式使用</h3>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="18852484835349290000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`//快递工作人员\nclass ExpressPerson\n{\n    private string name;\n    public string Name\n    {\n        get { return name; }\n        set { name = value; }\n    }\n}\n//毕业生\nclass Graduate\n{\n    ExpressPerson YDY;\n    public Graduate(ExpressPerson YDY)\n    {\n        this.YDY = YDY;\n    }\n    public void GiveComputer()\n    {\n        Console.WriteLine(YDY.Name + &quot; 请你托运计算机&quot;);\n    }\n    public void GiveBaggage()\n    {\n        Console.WriteLine(YDY.Name + &quot; 请你托运行李&quot;);\n    }\n}\nstatic void Main(string[] args)\n{\n    ExpressPerson YDY = new ExpressPerson();\n    YDY.Name = &quot;宅急送&quot;;\n\n    Graduate zhangsan = new Graduate(YDY);\n\n    zhangsan.GiveComputer();\n    zhangsan.GiveBaggage();\n\n    Console.Read();\n}\n//女同学\nclass Classmate\n{\n    ExpressPerson YDY;\n    public Classmate(ExpressPerson YDY)\n    {\n        this.YDY = YDY;\n    }\n    public void GiveComputer()\n    {\n        Console.WriteLine(YDY.Name + &quot; 请你托运计算机&quot;);\n    }\n    public void GiveBaggage()\n    {\n        Console.WriteLine(YDY.Name + &quot; 请你托运行李&quot;);\n    }\n}\nstatic void Main(string[] args)\n{\n    ExpressPerson YDY = new ExpressPerson();\n    YDY.Name = &quot;宅急送&quot;;\n\n    Classmate Girl = new Classmate(YDY);\n\n    Girl.GiveComputer();\n    Girl.GiveBaggage();\n\n    Console.Read();\n}`, `18852484835349290000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp"><span class="token comment">//快递工作人员</span>\n<span class="token keyword">class</span> <span class="token class-name">ExpressPerson</span>\n<span class="token punctuation">{</span>\n    <span class="token keyword">private</span> string name<span class="token punctuation">;</span>\n    <span class="token keyword">public</span> string Name\n    <span class="token punctuation">{</span>\n        get <span class="token punctuation">{</span> <span class="token keyword">return</span> name<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n        set <span class="token punctuation">{</span> name <span class="token operator">=</span> value<span class="token punctuation">;</span> <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token comment">//毕业生</span>\n<span class="token keyword">class</span> <span class="token class-name">Graduate</span>\n<span class="token punctuation">{</span>\n    ExpressPerson YDY<span class="token punctuation">;</span>\n    <span class="token keyword">public</span> <span class="token function">Graduate</span><span class="token punctuation">(</span>ExpressPerson YDY<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>YDY <span class="token operator">=</span> YDY<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">GiveComputer</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>YDY<span class="token punctuation">.</span>Name <span class="token operator">+</span> <span class="token string">" 请你托运计算机"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">GiveBaggage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>YDY<span class="token punctuation">.</span>Name <span class="token operator">+</span> <span class="token string">" 请你托运行李"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">Main</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    ExpressPerson YDY <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">ExpressPerson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    YDY<span class="token punctuation">.</span>Name <span class="token operator">=</span> <span class="token string">"宅急送"</span><span class="token punctuation">;</span>\n\n    Graduate zhangsan <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Graduate</span><span class="token punctuation">(</span>YDY<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    zhangsan<span class="token punctuation">.</span><span class="token function">GiveComputer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    zhangsan<span class="token punctuation">.</span><span class="token function">GiveBaggage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Console<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n<span class="token comment">//女同学</span>\n<span class="token keyword">class</span> <span class="token class-name">Classmate</span>\n<span class="token punctuation">{</span>\n    ExpressPerson YDY<span class="token punctuation">;</span>\n    <span class="token keyword">public</span> <span class="token function">Classmate</span><span class="token punctuation">(</span>ExpressPerson YDY<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>YDY <span class="token operator">=</span> YDY<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">GiveComputer</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>YDY<span class="token punctuation">.</span>Name <span class="token operator">+</span> <span class="token string">" 请你托运计算机"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">GiveBaggage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>YDY<span class="token punctuation">.</span>Name <span class="token operator">+</span> <span class="token string">" 请你托运行李"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">Main</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    ExpressPerson YDY <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">ExpressPerson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    YDY<span class="token punctuation">.</span>Name <span class="token operator">=</span> <span class="token string">"宅急送"</span><span class="token punctuation">;</span>\n\n    Classmate Girl <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Classmate</span><span class="token punctuation">(</span>YDY<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Girl<span class="token punctuation">.</span><span class="token function">GiveComputer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    Girl<span class="token punctuation">.</span><span class="token function">GiveBaggage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Console<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>以上代码复用性太低，有何解决办法？</p>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/微信截图_20180417130415-93ae8010eddf1e87be62617bb8c7a8c5-f690e.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 487px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 74.74332648870637%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAA7EAAAOxAGVKw4bAAACU0lEQVQ4y5VTS6tSURTeR70kFjlq0G9w0qTfIOK44U2KBg2FBiIhNGgmJonZtZEIgiJdQQitQSoimu83vl/4wDe+6Pro7NY+nCN3UGYLDvtb53znW2vttRZCrFksFg6iSCQirVarz4PB4KXb7X7q8/kuwX8B52PyHWOMjEYjOmkul+uIa7XaD/gJ1+t1nEqlcLPZJC7O5XIfWEGe1Wo9LejxeI641+t9JwI3YHuw7XZ7Q3wIpOME7Xb7aUGHw3HEyWQy2G63cbFYxNPpFC+XS5oIlkolAydos9nOL7lQKHzpdru40+mMQWy82+2mRBBKf8sJOp3O04IymQyZTCYGKxSKBwaD4bVGo3kIrlCr1T6C5xVgijREqVQiiUSC/seov7yjzlbg8XhHKBaLhQSoVCpKr9dTMC6IdFUkEgn/KQQXzYeLF6TTaQHMnUAul9+LxWIX0BQeN3PcvZnN5jtSqfQu8PkQRDCZTARw33yOFwqFTge7JXYWj7F8Pv9mOBy+D4fD77xer6FcLuvAv4rH40+4zNjOP+v3+x/9fj/DCwQCOvBNmUzmJcuj4B1CsA0rMhKj0Qi3Wi28WCyYrQABK0sUkBNW7yu3PYAZLjGY1TAXmCkZZqu9Xq8xPDvYiP1ms/lJiIlEgiw3pVar75MfKpXKNU3TmHwnPLJFh8OBBPByGUJVCEEDukDGkPqv8XhMr1arPRv5E0u8IGc0Gr0mww68/WAwoGHgD2zG37gMGcFsNtuFjSAl0PP5nGTKCEKQq9slg9Dn2WyGG43GHgJjCPxHwd8/UgGva31CPAAAAABJRU5ErkJggg==\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;"\n        alt="     20180417130415"\n        title=""\n        src="/static/微信截图_20180417130415-93ae8010eddf1e87be62617bb8c7a8c5-f690e.png"\n        srcset="/static/微信截图_20180417130415-93ae8010eddf1e87be62617bb8c7a8c5-28e07.png 200w,\n/static/微信截图_20180417130415-93ae8010eddf1e87be62617bb8c7a8c5-e077b.png 400w,\n/static/微信截图_20180417130415-93ae8010eddf1e87be62617bb8c7a8c5-f690e.png 487w"\n        sizes="(max-width: 487px) 100vw, 487px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<div\n              class="gatsby-code-button-container"\n              data-toaster-id="84798534855087010000"\n              data-toaster-class="gatsby-code-button-toaster"\n              data-toaster-text-class="gatsby-code-button-toaster-text"\n              data-toaster-text="复制成功"\n              data-toaster-duration="3500"\n              onClick="copyToClipboard(`//寄东西\ninterface GiveObject\n{\n    void GiveComputer();\n    void GiveBaggage();\n}\n//毕业生\nclass Graduate : GiveObject\n{\n    ExpressPerson YDY;\n    public Graduate(ExpressPerson YDY)\n    {\n        this.YDY = YDY;\n    }\n    public void GiveComputer()\n    {\n        Console.WriteLine(YDY.Name + &quot; 请你托运计算机&quot;);\n    }\n    public void GiveBaggage()\n    {\n        Console.WriteLine(YDY.Name + &quot; 请你托运行李&quot;);\n    }\n}\n//女同学 : GiveGift\nclass Classmate : GiveObject\n{\n    Graduate zhangsan;\n    public Classmate(ExpressPerson YDY)\n    {\n        zhangsan = new Graduate(YDY);\n    }\n    public void GiveComputer()\n    {\n        zhangsan.GiveComputer();\n    }\n    public void GiveBaggage()\n    {\n        zhangsan.GiveBaggage();\n    }\n}\nstatic void Main(string[] args)\n{\n    ExpressPerson YDY = new ExpressPerson();\n    YDY.Name = &quot;宅急送&quot;;\n\n    Classmate Girl = new Classmate(YDY);\n\n    Girl.GiveComputer();\n    Girl.GiveBaggage();\n\n    Console.Read();\n}`, `84798534855087010000`)"\n            >\n              <div\n                class="gatsby-code-button"\n                data-tooltip="复制"\n              >\n                <svg class="gatsby-code-button-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 1H2v16h2V3h12V1zm-1 4l6 6v12H6V5h9zm-1 7h5.5L14 6.5V12z"/></svg>\n              </div>\n            </div>\n<div class="gatsby-highlight" data-language="cpp"><pre style="counter-reset: linenumber NaN" class="language-cpp line-numbers"><code class="language-cpp"><span class="token comment">//寄东西</span>\ninterface GiveObject\n<span class="token punctuation">{</span>\n    <span class="token keyword">void</span> <span class="token function">GiveComputer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">void</span> <span class="token function">GiveBaggage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n<span class="token comment">//毕业生</span>\n<span class="token keyword">class</span> <span class="token class-name">Graduate</span> <span class="token operator">:</span> GiveObject\n<span class="token punctuation">{</span>\n    ExpressPerson YDY<span class="token punctuation">;</span>\n    <span class="token keyword">public</span> <span class="token function">Graduate</span><span class="token punctuation">(</span>ExpressPerson YDY<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>YDY <span class="token operator">=</span> YDY<span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">GiveComputer</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>YDY<span class="token punctuation">.</span>Name <span class="token operator">+</span> <span class="token string">" 请你托运计算机"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">GiveBaggage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>YDY<span class="token punctuation">.</span>Name <span class="token operator">+</span> <span class="token string">" 请你托运行李"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token comment">//女同学 : GiveGift</span>\n<span class="token keyword">class</span> <span class="token class-name">Classmate</span> <span class="token operator">:</span> GiveObject\n<span class="token punctuation">{</span>\n    Graduate zhangsan<span class="token punctuation">;</span>\n    <span class="token keyword">public</span> <span class="token function">Classmate</span><span class="token punctuation">(</span>ExpressPerson YDY<span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        zhangsan <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Graduate</span><span class="token punctuation">(</span>YDY<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">GiveComputer</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        zhangsan<span class="token punctuation">.</span><span class="token function">GiveComputer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">GiveBaggage</span><span class="token punctuation">(</span><span class="token punctuation">)</span>\n    <span class="token punctuation">{</span>\n        zhangsan<span class="token punctuation">.</span><span class="token function">GiveBaggage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">Main</span><span class="token punctuation">(</span>string<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span>\n<span class="token punctuation">{</span>\n    ExpressPerson YDY <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">ExpressPerson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    YDY<span class="token punctuation">.</span>Name <span class="token operator">=</span> <span class="token string">"宅急送"</span><span class="token punctuation">;</span>\n\n    Classmate Girl <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Classmate</span><span class="token punctuation">(</span>YDY<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Girl<span class="token punctuation">.</span><span class="token function">GiveComputer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    Girl<span class="token punctuation">.</span><span class="token function">GiveBaggage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    Console<span class="token punctuation">.</span><span class="token function">Read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>以上代码就是代理模式，复用了中介的功能。</p>\n<h3 id="模式动机-1"><a href="#%E6%A8%A1%E5%BC%8F%E5%8A%A8%E6%9C%BA-1" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式动机</h3>\n<p>一个客户不想或者不能够直接引用一个对象，而代理对象可以在客户端和目标对象之间起到中介的作用，去掉客户不能看到的内容和服务或者增添客户需要的额外服务。如在网页上查看一张图片，由于网速等原因图片不能立即显示，我们可以在图片传输过程中先把一些简单的用于描述图片的文字传输到客户端，此时这些文字就成为了图片的代理。</p>\n<h3 id="模式定义-2"><a href="#%E6%A8%A1%E5%BC%8F%E5%AE%9A%E4%B9%89-2" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式定义</h3>\n<p>给某一个对象提供一个代理，并由代理对象控制对原对象的引用。代理模式的英文叫做 Proxy 或 Surrogate。代理模式是一种对象结构型模式。</p>\n<h3 id="模式结构-2"><a href="#%E6%A8%A1%E5%BC%8F%E7%BB%93%E6%9E%84-2" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式结构</h3>\n<p>\n  <a\n    class="gatsby-resp-image-link"\n    href="/static/微信截图_20180417131314-dc28178c678152710002f5ece2586001-ffdbb.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n  \n  <span\n    class="gatsby-resp-image-wrapper"\n    style="position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;"\n  >\n    <span\n      class="gatsby-resp-image-background-image"\n      style="padding-bottom: 44.430844553243574%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAB3ElEQVQoz5VSS2saURidahftoiXpJtAs0iYkvyCrQn5DugmllIBdtuv+ABGEtAgiaZuJ+OyiiivBjaIIDroSFN+PGVF8P2oYcGzBqrfnC2ZKSLLIB8N3555zz/fkKpXKSblcPovH46e1Ws1WKpU+cjDGGDnO5/Nttlqt75lM5lssFvsqiiLfaDS+GAyGp4Q7nU7umnU6nT94zMbjMTkGskD3Op3uEXmbzfaK7mezGZNlma24M5PJtEm41+t9cE2w2WxezOdzNplMLsn1ej20yuwhebvdvt9ut1mv12Oj0egvcYfDoQzB57cKFgqFQzx4g8yOUNq7XC53QPeKomjI+/3+tWKxeJRKpd5Ho9FzcN8i6Gue5x8THolENMFg8FILGHdfe3IXgErVDLVQ1iKqtt/va8PhsMZqtW64XK4tvV6/Y7FYXrrd7j2Hw7FOfPgNj8ezazQat81m8zYqeAH+M8IEQfgfAeWoZwQIdbtdhun/rlarCvUX0/1AGFpzvlwuGTJS8E0XiwXDdlhWm6FRRQKBgHpGz4TpdMpIdDAYMBpEIpH4RFg6nf5BE6choSJG4vl8nr8hiNTVczKZ/In9HCCyBEERj+VsNnu8wj6jTbIkSSJWTvoFw7/hSvAfS95he7V1CIUAAAAASUVORK5CYII=\'); background-size: cover; display: block;"\n    >\n      <img\n        class="gatsby-resp-image-image"\n        style="width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px #fafafa;"\n        alt="     20180417131314"\n        title=""\n        src="/static/微信截图_20180417131314-dc28178c678152710002f5ece2586001-fee1c.png"\n        srcset="/static/微信截图_20180417131314-dc28178c678152710002f5ece2586001-a67b7.png 200w,\n/static/微信截图_20180417131314-dc28178c678152710002f5ece2586001-0b187.png 400w,\n/static/微信截图_20180417131314-dc28178c678152710002f5ece2586001-fee1c.png 800w,\n/static/微信截图_20180417131314-dc28178c678152710002f5ece2586001-ffdbb.png 817w"\n        sizes="(max-width: 800px) 100vw, 800px"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p>\n<ul>\n<li>Subject：抽象主题角色</li>\n<li>Proxy：代理主题角色</li>\n<li>RealSubject：真实主题角色</li>\n</ul>\n<h3 id="模式使用-3"><a href="#%E6%A8%A1%E5%BC%8F%E4%BD%BF%E7%94%A8-3" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式使用</h3>\n<ul>\n<li>远程（Remote）代理</li>\n<li>虚拟（Virtual）代理</li>\n<li>保护（Protect or Access）代理</li>\n<li>缓冲（Cache）代理</li>\n<li>防火墙（Firewall）代理</li>\n<li>同步化（Synchronization）代理</li>\n<li>智能引用（Smart Reference）代理</li>\n</ul>\n<h3 id="优缺点-2"><a href="#%E4%BC%98%E7%BC%BA%E7%82%B9-2" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>优缺点</h3>\n<ul>\n<li>\n<p>优点</p>\n<ul>\n<li>代理模式能够协调调用者和被调用者，能够在一定程度上降低系统的耦合度。</li>\n<li>当对象在远程机器上，要通过网络来生成时速度可能会很慢，此时应用代理模式可以掩盖对象在网络上生成的过程，系统的速度会加快。</li>\n<li>对于大对象的加载(如大图片)，虚拟代理可以让加载过程在后台执行，前台使用的代理对象会使得整体运行速度得到优化。</li>\n</ul>\n</li>\n<li>\n<p>缺点</p>\n<ul>\n<li>请求的处理速度会变慢，并且实现代理模式需要额外的工作。</li>\n</ul>\n</li>\n</ul>\n<h3 id="模式应用-2"><a href="#%E6%A8%A1%E5%BC%8F%E5%BA%94%E7%94%A8-2" aria-hidden="true" class="anchor"><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>模式应用</h3>\n<ul>\n<li>图片代理</li>\n<li>AOP(Aspect Oriented Programming)</li>\n</ul>',
id:"/github/workspace/blog/设计模式之结构型模式（二）/index.md absPath of file >>> MarkdownRemark",timeToRead:10,frontmatter:{date:"2018-04-19 00:04:26",path:"/design-pattern-structure-2/",tags:"面试, 设计模式",title:"设计模式之结构型模式（二）",draft:null}}],length:8,tag:"设计模式",pagesSum:2,page:1}}}});